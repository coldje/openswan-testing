Starting UML /btmp/antony/ikev2/2008_01_14/UMLPOOL/west/start.sh
spawn /btmp/antony/ikev2/2008_01_14/UMLPOOL/west/start.sh single
Checking that ptrace can change system call numbers...OK
Checking syscall emulation patch for ptrace...OK
Checking advanced syscall emulation patch for ptrace...OK
Checking for tmpfs mount on /dev/shm...OK
Checking PROT_EXEC mmap in /dev/shm/...OK
Checking for the skas3 patch in the host:
  - /proc/mm...not found
  - PTRACE_FAULTINFO...not found
  - PTRACE_LDT...not found
UML running in SKAS0 mode
Checking that ptrace can change system call numbers...OK
Checking syscall emulation patch for ptrace...OK
Checking advanced syscall emulation patch for ptrace...OK
Linux version 2.6.18.6 (antony@cyclops) (gcc version 4.1.2 20061115 (prerelease) (Debian 4.1.1-21)) #1 Mon Jan 14 16:26:00 EST 2008
Built 1 zonelists.  Total pages: 8192
Kernel command line: initrd=/btmp/antony/ikev2/2008_01_14/UMLPOOL/initrd.uml umlroot=/btmp/antony/ikev2/2008_01_14/UMLPOOL/west/root root=/dev/ram0 rw ssl=pty eth0=daemon,10:00:00:ab:cd:ff,unix,/tmp/uml6bcyGN.d/west/ctl,/tmp/uml6bcyGN.d/west/data eth1=daemon,10:00:00:64:64:45,unix,/tmp/uml6bcyGN.d/public/ctl,/tmp/uml6bcyGN.d/public/data eth2=daemon,10:00:00:32:64:45,unix,/tmp/uml6bcyGN.d/admin/ctl,/tmp/uml6bcyGN.d/admin/data init=/linuxrc single
PID hash table entries: 256 (order: 8, 1024 bytes)
Dentry cache hash table entries: 4096 (order: 2, 16384 bytes)
Inode-cache hash table entries: 2048 (order: 1, 8192 bytes)
Memory: 27292k available
Mount-cache hash table entries: 512
Checking for host processor cmov support...Yes
Checking for host processor xmm support...No
Checking that host ptys support output SIGIO...Yes
Checking that host ptys support SIGIO on close...No, enabling workaround
checking if image is initramfs...it isn't (bad gzip magic numbers); looks like an initrd
Freeing initrd memory: 1212k freed
Using 2.6 host AIO
NET: Registered protocol family 16
NET: Registered protocol family 2
IP route cache hash table entries: 256 (order: -2, 1024 bytes)
TCP established hash table entries: 1024 (order: 0, 4096 bytes)
TCP bind hash table entries: 512 (order: -1, 2048 bytes)
TCP: Hash tables configured (established 1024 bind 512)
TCP reno registered
klips_info:ipsec_init: KLIPS startup, Openswan KLIPS IPsec stack version: 2.5.testing-g70d71a2f-dirty
NET: Registered protocol family 15
klips_info:ipsec_alg_init: KLIPS alg v=0.8.1-0 (EALG_MAX=255, AALG_MAX=251)
klips_info:ipsec_alg_init: calling ipsec_alg_static_init()
ipsec_aes_init(alg_type=15 alg_id=12 name=aes): ret=0
ipsec_aes_init(alg_type=14 alg_id=9 name=aes_mac): ret=0
ipsec_3des_init(alg_type=15 alg_id=3 name=3des): ret=0
daemon_setup : Ignoring data socket specification
Netdevice 0 (10:00:00:ab:cd:ff) : daemon backend (uml_switch version 3) - unix:/tmp/uml6bcyGN.d/west/ctl
daemon_setup : Ignoring data socket specification
Netdevice 1 (10:00:00:64:64:45) : daemon backend (uml_switch version 3) - unix:/tmp/uml6bcyGN.d/public/ctl
daemon_setup : Ignoring data socket specification
Netdevice 2 (10:00:00:32:64:45) : daemon backend (uml_switch version 3) - unix:/tmp/uml6bcyGN.d/admin/ctl
Checking host MADV_REMOVE support...OK
mconsole (version 2) initialized on /home/antony/.uml/west/mconsole
Host TLS support detected
Detected host type: i386
VFS: Disk quotas dquot_6.5.1
Dquot-cache hash table entries: 1024 (order 0, 4096 bytes)
Initializing Cryptographic API
io scheduler noop registered
io scheduler anticipatory registered (default)
io scheduler deadline registered
io scheduler cfq registered
RAMDISK driver initialized: 16 RAM disks of 4096K size 1024 blocksize
loop: loaded (max 8 devices)
nbd: registered device at major 43
PPP generic driver version 2.4.2
SLIP: version 0.8.4-NET3.019-NEWTTY (dynamic channels, max=256).
tun: Universal TUN/TAP device driver, 1.6
tun: (C) 1999-2004 Max Krasnyansky <maxk@qualcomm.com>
Netfilter messages via NETLINK v0.30.
IPv4 over IPv4 tunneling driver
GRE over IPv4 tunneling driver
ip_conntrack version 2.4 (213 buckets, 1704 max) - 204 bytes per conntrack
ip_tables: (C) 2000-2006 Netfilter Core Team
arp_tables: (C) 2002 David S. Miller
TCP bic registered
TCP cubic registered
TCP westwood registered
TCP highspeed registered
TCP hybla registered
TCP htcp registered
TCP vegas registered
TCP scalable registered
NET: Registered protocol family 1
NET: Registered protocol family 17
Initialized stdio console driver
Console initialized on /dev/tty0
Initializing software serial port version 1
Failed to open 'root_fs', errno = 2
RAMDISK: cramfs filesystem found at block 0
RAMDISK: Loading 1212KiB [1 disk] into ram disk... |/-\|/-\|/-\|/-\|/-\|/-\|/-\|/-\|/-\|/-\|/-\|/-\|/-\|/-\|/-\|/-\|/-\|/-\|/-\done.
VFS: Mounted root (cramfs filesystem) readonly.
MOUNTING /btmp/antony/ikev2/2008_01_14/UMLPOOL/west/root for UML testing root.
Mounting a tmpfs over /dev...done.
Creating initial device nodes...done.
Invoked with Arguments: single
Creating initial device nodes...done.
crw-r--r--    1 root     root       5,   1 Feb 23 15:01 /dev/console
line_ioctl: tty0: ioctl KDSIGACCEPT called
INIT: version 2.78 booting
/dev/root on / type hostfs (rw)
proc on /proc type proc (rw)
devpts on /dev/pts type devpts (rw,gid=5,mode=620)
/dev/shm on /tmp type tmpfs (rw)
/dev/shm on /var/run type tmpfs (rw)
none on /usr/share type hostfs (ro)
none on /testing type hostfs (ro,/home/antony/ikev2/testing)
none on /usr/src type hostfs (ro,/home/antony/ikev2)
none on /usr/obj type hostfs (ro,/home/antony/ikev2/OBJ.linux.i386)
none on /usr/local type hostfs (rw,/btmp/antony/ikev2/2008_01_14/UMLPOOL/west/root/usr/local)
none on /var/tmp type hostfs (rw,/btmp/antony/ikev2/2008_01_14/UMLPOOL/west/root/var/tmp)
none on /proc type proc (rw)
crw-r--r--    1 root     root       5,   1 Feb 23 15:01 /dev/console
mount: proc already mounted
Activating swap...
Checking all file systems...
Parallelizing fsck version 1.18 (11-Nov-1999)
Setting kernel variables.
Mounting local filesystems...
mount: devpts already mounted on /dev/pts
/dev/shm on /tmp type tmpfs (rw)
/dev/shm on /var/run type tmpfs (rw)
none on /usr/share type hostfs (ro)
none on /testing type hostfs (ro,/home/antony/ikev2/testing)
none on /usr/src type hostfs (ro,/home/antony/ikev2)
none on /usr/obj type hostfs (ro,/home/antony/ikev2/OBJ.linux.i386)
none on /usr/local type hostfs (rw,/btmp/antony/ikev2/2008_01_14/UMLPOOL/west/root/usr/local)
none on /var/tmp type hostfs (rw,/btmp/antony/ikev2/2008_01_14/UMLPOOL/west/root/var/tmp)
Enabling packet forwarding: done.
Configuring network interfaces: done.
Cleaning: /tmp /var/lock /var/run.
Initializing random number generator... done.
Recovering nvi editor sessions... done.
Give root password for maintenance
(or type Control-D for normal startup): 
west:~# echo Starting loading module
Starting loading module
west:~# exec bash --noediting
west:~# ulimit -c unlimited
west:~# echo Finished loading module
Finished loading module
west:~# klogd -c 4 -x -f /tmp/klog.log
west:~# : ==== start ====
west:~# TESTNAME=ikev2-05-basic-psk
west:~# source /testing/pluto/bin/westnlocal.sh
west:~# ping -n -c 1 192.0.2.254
PING 192.0.2.254 (192.0.2.254): 56 data bytes
64 bytes from 192.0.2.254: icmp_seq=0 ttl=64 time=32.7 ms

--- 192.0.2.254 ping statistics ---
1 packets transmitted, 1 packets received, 0% packet loss
round-trip min/avg/max = 32.7/32.7/32.7 ms
west:~# iptables -A INPUT -i eth1 -s 192.0.2.0/24 -j DROP
west:~# ping -n -c 1 192.0.2.254
PING 192.0.2.254 (192.0.2.254): 56 data bytes

--- 192.0.2.254 ping statistics ---
1 packets transmitted, 0 packets received, 100% packet loss
west:~# ipsec setup start
ipsec_setup: Starting Openswan IPsec U2.5.testing-g43bc1d6c-dirty/K2.5.testing-g70d71a2f-dirty...
west:~# ipsec whack --whackrecord /var/tmp/ikev2.record
west:~# ipsec auto --add westnet--eastnet-ikev2
west:~# ipsec auto --status
000 using kernel interface: klips
000 interface ipsec0/eth1 192.1.2.45
000 %myid = (none)
000 debug raw+crypt+parsing+emitting+control+lifecycle+klips+dns+oppo+controlmore+pfkey+nattraversal+x509
000  
000 algorithm ESP encrypt: id=3, name=ESP_3DES, ivlen=64, keysizemin=192, keysizemax=192
000 algorithm ESP encrypt: id=12, name=ESP_AES, ivlen=128, keysizemin=128, keysizemax=256
000 algorithm ESP auth attr: id=1, name=AUTH_ALGORITHM_HMAC_MD5, keysizemin=128, keysizemax=128
000 algorithm ESP auth attr: id=2, name=AUTH_ALGORITHM_HMAC_SHA1, keysizemin=160, keysizemax=160
000 algorithm ESP auth attr: id=9, name=AUTH_ALGORITHM_AES_CBC, keysizemin=128, keysizemax=128
000  
000 algorithm IKE encrypt: id=3, name=OAKLEY_BLOWFISH_CBC, blocksize=8, keydeflen=128
000 algorithm IKE encrypt: id=5, name=OAKLEY_3DES_CBC, blocksize=8, keydeflen=192
000 algorithm IKE encrypt: id=7, name=OAKLEY_AES_CBC, blocksize=16, keydeflen=128
000 algorithm IKE encrypt: id=65004, name=OAKLEY_SERPENT_CBC, blocksize=16, keydeflen=128
000 algorithm IKE encrypt: id=65005, name=OAKLEY_TWOFISH_CBC, blocksize=16, keydeflen=128
000 algorithm IKE encrypt: id=65289, name=OAKLEY_TWOFISH_CBC_SSH, blocksize=16, keydeflen=128
000 algorithm IKE hash: id=1, name=OAKLEY_MD5, hashsize=16
000 algorithm IKE hash: id=2, name=OAKLEY_SHA1, hashsize=20
000 algorithm IKE hash: id=4, name=OAKLEY_SHA2_256, hashsize=32
000 algorithm IKE hash: id=6, name=OAKLEY_SHA2_512, hashsize=64
000 algorithm IKE dh group: id=2, name=OAKLEY_GROUP_MODP1024, bits=1024
000 algorithm IKE dh group: id=5, name=OAKLEY_GROUP_MODP1536, bits=1536
000 algorithm IKE dh group: id=14, name=OAKLEY_GROUP_MODP2048, bits=2048
000 algorithm IKE dh group: id=15, name=OAKLEY_GROUP_MODP3072, bits=3072
000 algorithm IKE dh group: id=16, name=OAKLEY_GROUP_MODP4096, bits=4096
000 algorithm IKE dh group: id=17, name=OAKLEY_GROUP_MODP6144, bits=6144
000 algorithm IKE dh group: id=18, name=OAKLEY_GROUP_MODP8192, bits=8192
000  
000 stats db_ops: {curr_cnt, total_cnt, maxsz} :context={0,0,0} trans={0,0,0} attrs={0,0,0} 
000  
000 "westnet--eastnet-ikev2": 192.0.1.0/24===192.1.2.45<192.1.2.45>[@west,S=C]...192.1.2.23<192.1.2.23>[@east,S=C]===192.0.2.0/24; unrouted; eroute owner: #0
000 "westnet--eastnet-ikev2":     myip=unset; hisip=unset;
000 "westnet--eastnet-ikev2":   ike_life: 3600s; ipsec_life: 28800s; rekey_margin: 540s; rekey_fuzz: 100%; keyingtries: 3
000 "westnet--eastnet-ikev2":   policy: PSK+ENCRYPT+TUNNEL+PFS+!IKEv1+IKEv2ALLOW+IKEv2Init; prio: 24,24; interface: eth1; 
000 "westnet--eastnet-ikev2":   newest ISAKMP SA: #0; newest IPsec SA: #0; 
000  
000  
west:~# /testing/pluto/bin/wait-until-pluto-started
west:~# echo done
done
west:~# : === NETJIG start of WEST westrun.sh 
west:~# ipsec auto --up  westnet--eastnet-ikev2
133 "westnet--eastnet-ikev2" #1: STATE_PARENT_I1: initiate
133 "westnet--eastnet-ikev2" #1: STATE_PARENT_I1: sent v2I1, expected v2R1
134 "westnet--eastnet-ikev2" #2: STATE_PARENT_I2: sent v2I2, expected v2R2 {auth=IKEv2 cipher=aes_128 integ=sha1 prf=oakley_sha group=modp2048}
004 "westnet--eastnet-ikev2" #2: STATE_PARENT_I3: PARENT SA established tunnel mode {ESP=>0x09260ef3 <0xd2efc071 xfrm=AES_128-HMAC_SHA1 NATOA=none NATD=none DPD=none}
west:~# ipsec look
west Sat Feb 23 15:01:34 GMT 2008
192.0.1.0/24       -> 192.0.2.0/24       => tun0x1001@192.1.2.23 esp0x9260ef3@192.1.2.23  (0)
ipsec0->eth1 mtu=16260(1500)->1500
esp0x9260ef3@192.1.2.23 ESP_AES_HMAC_SHA1: dir=out src=192.1.2.45 iv_bits=128bits iv=0xc625c795ab89de1724c854de88ff25ab ooowin=64 alen=160 aklen=160 eklen=128 life(c,s,h)=addtime(0,0,0) natencap=none natsport=0 natdport=0 refcount=4 ref=4
esp0xd2efc071@192.1.2.45 ESP_AES_HMAC_SHA1: dir=in  src=192.1.2.23 iv_bits=128bits iv=0x4e279d3e52f127f8acf3497b7ea52178 ooowin=64 alen=160 aklen=160 eklen=128 life(c,s,h)=addtime(0,0,0) natencap=none natsport=0 natdport=0 refcount=4 ref=6
tun0x1001@192.1.2.23 IPIP: dir=out src=192.1.2.45 life(c,s,h)=addtime(0,0,0) natencap=none natsport=0 natdport=0 refcount=4 ref=3
tun0x1002@192.1.2.45 IPIP: dir=in  src=192.1.2.23 policy=192.0.2.0/24->192.0.1.0/24 flags=0x8<> life(c,s,h)=addtime(0,0,0) natencap=none natsport=0 natdport=0 refcount=4 ref=5
ROUTING TABLE
192.1.2.0/24 dev eth1  proto kernel  scope link  src 192.1.2.45 
192.1.2.0/24 dev ipsec0  proto kernel  scope link  src 192.1.2.45 
192.0.2.0/24 dev ipsec0  scope link 
default via 192.1.2.254 dev eth1 
west:~# echo done
done
west:~# 

west:~# : ==== cut ====
west:~# ipsec auto --status
000 using kernel interface: klips
000 interface ipsec0/eth1 192.1.2.45
000 %myid = (none)
000 debug raw+crypt+parsing+emitting+control+lifecycle+klips+dns+oppo+controlmore+pfkey+nattraversal+x509
000  
000 algorithm ESP encrypt: id=3, name=ESP_3DES, ivlen=64, keysizemin=192, keysizemax=192
000 algorithm ESP encrypt: id=12, name=ESP_AES, ivlen=128, keysizemin=128, keysizemax=256
000 algorithm ESP auth attr: id=1, name=AUTH_ALGORITHM_HMAC_MD5, keysizemin=128, keysizemax=128
000 algorithm ESP auth attr: id=2, name=AUTH_ALGORITHM_HMAC_SHA1, keysizemin=160, keysizemax=160
000 algorithm ESP auth attr: id=9, name=AUTH_ALGORITHM_AES_CBC, keysizemin=128, keysizemax=128
000  
000 algorithm IKE encrypt: id=3, name=OAKLEY_BLOWFISH_CBC, blocksize=8, keydeflen=128
000 algorithm IKE encrypt: id=5, name=OAKLEY_3DES_CBC, blocksize=8, keydeflen=192
000 algorithm IKE encrypt: id=7, name=OAKLEY_AES_CBC, blocksize=16, keydeflen=128
000 algorithm IKE encrypt: id=65004, name=OAKLEY_SERPENT_CBC, blocksize=16, keydeflen=128
000 algorithm IKE encrypt: id=65005, name=OAKLEY_TWOFISH_CBC, blocksize=16, keydeflen=128
000 algorithm IKE encrypt: id=65289, name=OAKLEY_TWOFISH_CBC_SSH, blocksize=16, keydeflen=128
000 algorithm IKE hash: id=1, name=OAKLEY_MD5, hashsize=16
000 algorithm IKE hash: id=2, name=OAKLEY_SHA1, hashsize=20
000 algorithm IKE hash: id=4, name=OAKLEY_SHA2_256, hashsize=32
000 algorithm IKE hash: id=6, name=OAKLEY_SHA2_512, hashsize=64
000 algorithm IKE dh group: id=2, name=OAKLEY_GROUP_MODP1024, bits=1024
000 algorithm IKE dh group: id=5, name=OAKLEY_GROUP_MODP1536, bits=1536
000 algorithm IKE dh group: id=14, name=OAKLEY_GROUP_MODP2048, bits=2048
000 algorithm IKE dh group: id=15, name=OAKLEY_GROUP_MODP3072, bits=3072
000 algorithm IKE dh group: id=16, name=OAKLEY_GROUP_MODP4096, bits=4096
000 algorithm IKE dh group: id=17, name=OAKLEY_GROUP_MODP6144, bits=6144
000 algorithm IKE dh group: id=18, name=OAKLEY_GROUP_MODP8192, bits=8192
000  
000 stats db_ops: {curr_cnt, total_cnt, maxsz} :context={0,0,0} trans={0,0,0} attrs={0,0,0} 
000  
000 "westnet--eastnet-ikev2": 192.0.1.0/24===192.1.2.45<192.1.2.45>[@west,S=C]...192.1.2.23<192.1.2.23>[@east,S=C]===192.0.2.0/24; erouted; eroute owner: #2
000 "westnet--eastnet-ikev2":     myip=unset; hisip=unset;
000 "westnet--eastnet-ikev2":   ike_life: 3600s; ipsec_life: 28800s; rekey_margin: 540s; rekey_fuzz: 100%; keyingtries: 3
000 "westnet--eastnet-ikev2":   policy: PSK+ENCRYPT+TUNNEL+PFS+UP+!IKEv1+IKEv2ALLOW+IKEv2Init; prio: 24,24; interface: eth1; 
000 "westnet--eastnet-ikev2":   newest ISAKMP SA: #1; newest IPsec SA: #2; 
000 "westnet--eastnet-ikev2":   IKE algorithm newest: _128-SHA1-MODP2048
000  
000 #2: "westnet--eastnet-ikev2":500 STATE_PARENT_I3 (PARENT SA established); none in -1s; newest IPSEC; eroute owner; nodpd; idle; import:admin initiate
000 #1: "westnet--eastnet-ikev2":500 STATE_PARENT_I3 (PARENT SA established); EVENT_CRYPTO_FAILED in 286s; newest ISAKMP; nodpd; idle; import:admin initiate
000  
west:~# cat /tmp/pluto.log
Plutorun started on Sat Feb 23 15:01:31 GMT 2008
Starting Pluto (Openswan Version 2.5.testing-g43bc1d6c-dirty; Vendor ID OEqjE\177pQ\134kpL) pid:916
Setting NAT-Traversal port-4500 floating to off
   port floating activation criteria nat_t=0/port_float=1
   including NAT-Traversal patch (Version 0.6c) [disabled]
| opening /dev/urandom
using /dev/urandom as source of random entropy
| inserting event EVENT_REINIT_SECRET, timeout in 3600 seconds
| inserting event EVENT_PENDING_PHASE2, timeout in 120 seconds
ike_alg_register_enc(): Activating OAKLEY_TWOFISH_CBC_SSH: Ok (ret=0)
ike_alg_register_enc(): Activating OAKLEY_TWOFISH_CBC: Ok (ret=0)
ike_alg_register_enc(): Activating OAKLEY_SERPENT_CBC: Ok (ret=0)
ike_alg_register_enc(): Activating OAKLEY_AES_CBC: Ok (ret=0)
ike_alg_register_enc(): Activating OAKLEY_BLOWFISH_CBC: Ok (ret=0)
ike_alg_register_hash(): Activating OAKLEY_SHA2_512: Ok (ret=0)
ike_alg_register_hash(): Activating OAKLEY_SHA2_256: Ok (ret=0)
starting up 1 cryptographic helpers
| opening /dev/urandom
using /dev/urandom as source of random entropy
started helper pid=917 (fd:6)
Using KLIPS IPsec interface code on 2.6.18.6
| process 916 listening for PF_KEY_V2 on file descriptor 7
| finish_pfkey_msg: SADB_REGISTER message 1 for AH 
|   02 07 00 02  02 00 00 00  01 00 00 00  94 03 00 00
| pfkey_get: SADB_REGISTER message 1
| AH registered with kernel.
| finish_pfkey_msg: SADB_REGISTER message 2 for ESP 
|   02 07 00 03  02 00 00 00  02 00 00 00  94 03 00 00
| pfkey_get: SADB_REGISTER message 2
| alg_init():memset(0x813ce80, 0, 2016) memset(0x813d660, 0, 2048) 
| kernel_alg_register_pfkey(): SADB_SATYPE_ESP: sadb_msg_len=10 sadb_supported_len=32
| kernel_alg_add():satype=3, exttype=14, alg_id=9
| kernel_alg_register_pfkey(): SADB_SATYPE_ESP: alg[0], exttype=14, satype=3, alg_id=9, alg_ivlen=0, alg_minbits=128, alg_maxbits=128, res=0, ret=1
| kernel_alg_add():satype=3, exttype=14, alg_id=3
| kernel_alg_register_pfkey(): SADB_SATYPE_ESP: alg[1], exttype=14, satype=3, alg_id=3, alg_ivlen=0, alg_minbits=160, alg_maxbits=160, res=0, ret=1
| kernel_alg_add():satype=3, exttype=14, alg_id=2
| kernel_alg_register_pfkey(): SADB_SATYPE_ESP: alg[2], exttype=14, satype=3, alg_id=2, alg_ivlen=0, alg_minbits=128, alg_maxbits=128, res=0, ret=1
| kernel_alg_register_pfkey(): SADB_SATYPE_ESP: sadb_msg_len=10 sadb_supported_len=32
| kernel_alg_add():satype=3, exttype=15, alg_id=3
| kernel_alg_register_pfkey(): SADB_SATYPE_ESP: alg[3], exttype=15, satype=3, alg_id=3, alg_ivlen=64, alg_minbits=192, alg_maxbits=192, res=0, ret=1
| kernel_alg_add():satype=3, exttype=15, alg_id=12
| kernel_alg_register_pfkey(): SADB_SATYPE_ESP: alg[4], exttype=15, satype=3, alg_id=12, alg_ivlen=128, alg_minbits=128, alg_maxbits=256, res=0, ret=1
| kernel_alg_add():satype=3, exttype=15, alg_id=3
| kernel_alg_add(): discarding already setup satype=3, exttype=15, alg_id=3
| kernel_alg_register_pfkey(): SADB_SATYPE_ESP: alg[5], exttype=15, satype=3, alg_id=3, alg_ivlen=64, alg_minbits=168, alg_maxbits=168, res=0, ret=0
| ESP registered with kernel.
| finish_pfkey_msg: SADB_REGISTER message 3 for IPCOMP 
|   02 07 00 0a  02 00 00 00  03 00 00 00  94 03 00 00
| pfkey_get: SADB_REGISTER message 3
| IPCOMP registered with kernel.
| finish_pfkey_msg: SADB_REGISTER message 4 for IPIP 
|   02 07 00 09  02 00 00 00  04 00 00 00  94 03 00 00
| pfkey_get: SADB_REGISTER message 4
| IPIP registered with kernel.
| inserting event EVENT_SHUNT_SCAN, timeout in 120 seconds
Changed path to directory '/tmp/ikev2-05-basic-psk/ipsec.d/cacerts'
Changed path to directory '/tmp/ikev2-05-basic-psk/ipsec.d/aacerts'
Changed path to directory '/tmp/ikev2-05-basic-psk/ipsec.d/ocspcerts'
Changing to directory '/tmp/ikev2-05-basic-psk/ipsec.d/crls'
  loaded crl file 'nic.crl' (642 bytes)
|   file content is not binary ASN.1
|   -----BEGIN X509 CRL-----
|   -----END X509 CRL-----
|   file coded in PEM format
| L0 - certificateList:
|   30 82 01 b2  30 81 9b 30  0d 06 09 2a  86 48 86 f7
|   0d 01 01 04  05 00 30 6c  31 0b 30 09  06 03 55 04
|   06 13 02 43  41 31 10 30  0e 06 03 55  04 08 13 07
|   4f 6e 74 61  72 69 6f 31  11 30 0f 06  03 55 04 0a
|   13 08 4f 70  65 6e 73 77  61 6e 31 18  30 16 06 03
|   55 04 03 13  0f 63 61 2e  6f 70 65 6e  73 77 61 6e
|   2e 6f 72 67  31 1e 30 1c  06 09 2a 86  48 86 f7 0d
|   01 09 01 16  0f 63 61 40  6f 70 65 6e  73 77 61 6e
|   2e 6f 72 67  17 0d 30 34  30 35 32 38  31 36 32 39
|   32 32 5a 17  0d 31 34 30  35 32 36 31  36 32 39 32
|   32 5a 30 0d  06 09 2a 86  48 86 f7 0d  01 01 04 05
|   00 03 82 01  01 00 97 39  db 11 85 33  8e f5 ee fd
|   13 c4 47 62  ab 15 b0 02  39 6e 18 35  55 4a a6 e7
|   a2 15 b7 c8  1b 1e 72 aa  b8 a8 1b 62  28 c1 05 18
|   f0 ad a0 37  ef 98 47 e5  f3 f4 d0 f7  76 7a 93 3f
|   08 ae 21 4d  38 c3 0c fe  e7 49 aa d6  f7 90 6b df
|   ed 88 0a d1  9c 95 97 35  8c d2 e1 db  61 7f ad 72
|   87 f2 f1 fc  a8 9e 0a b4  64 db 46 fc  a5 f1 3e 99
|   22 ff ea 73  09 b5 00 d2  47 fd 08 3a  75 57 01 f5
|   54 4c 21 9e  a5 2a c4 3e  ac c2 b0 fb  f9 7d 26 43
|   38 f0 6d 78  1d 0a f3 87  d5 20 00 07  e6 e6 ef c9
|   42 2c 92 22  d5 18 95 f4  83 44 d7 ee  1d a6 2b 63
|   04 57 c0 cc  48 a6 c1 ee  90 c9 a4 b9  e4 e4 d6 4a
|   ac 1e 20 75  70 0a 0d fd  c8 39 43 8d  f7 78 49 cb
|   a2 b6 5d 90  44 2f 13 5c  a9 eb 91 ca  cf 14 fb bb
|   e2 87 32 c3  0f 39 89 bb  1f 40 a3 03  11 bc a9 c0
|   0e ec 71 66  79 63 71 3d  8c ce 15 03  9e 1b 07 bc
|   0e a1 b1 a3  7d a3
| L1 - tbsCertList:
|   30 81 9b 30  0d 06 09 2a  86 48 86 f7  0d 01 01 04
|   05 00 30 6c  31 0b 30 09  06 03 55 04  06 13 02 43
|   41 31 10 30  0e 06 03 55  04 08 13 07  4f 6e 74 61
|   72 69 6f 31  11 30 0f 06  03 55 04 0a  13 08 4f 70
|   65 6e 73 77  61 6e 31 18  30 16 06 03  55 04 03 13
|   0f 63 61 2e  6f 70 65 6e  73 77 61 6e  2e 6f 72 67
|   31 1e 30 1c  06 09 2a 86  48 86 f7 0d  01 09 01 16
|   0f 63 61 40  6f 70 65 6e  73 77 61 6e  2e 6f 72 67
|   17 0d 30 34  30 35 32 38  31 36 32 39  32 32 5a 17
|   0d 31 34 30  35 32 36 31  36 32 39 32  32 5a
| L2 - signature:
| L3 - algorithmIdentifier:
| L4 - algorithm:
|   'md5WithRSAEncryption'
| L2 - issuer:
|   30 6c 31 0b  30 09 06 03  55 04 06 13  02 43 41 31
|   10 30 0e 06  03 55 04 08  13 07 4f 6e  74 61 72 69
|   6f 31 11 30  0f 06 03 55  04 0a 13 08  4f 70 65 6e
|   73 77 61 6e  31 18 30 16  06 03 55 04  03 13 0f 63
|   61 2e 6f 70  65 6e 73 77  61 6e 2e 6f  72 67 31 1e
|   30 1c 06 09  2a 86 48 86  f7 0d 01 09  01 16 0f 63
|   61 40 6f 70  65 6e 73 77  61 6e 2e 6f  72 67
|   'C=CA, ST=Ontario, O=Openswan, CN=ca.openswan.org, E=ca@openswan.org'
| L2 - thisUpdate:
| L3 - utcTime:
|   'May 28 16:29:22 UTC 2004'
| L2 - nextUpdate:
| L3 - utcTime:
|   'May 26 16:29:22 UTC 2014'
| L1 - signatureAlgorithm:
| L2 - algorithmIdentifier:
| L3 - algorithm:
|   'md5WithRSAEncryption'
| L1 - signatureValue:
|   00 97 39 db  11 85 33 8e  f5 ee fd 13  c4 47 62 ab
|   15 b0 02 39  6e 18 35 55  4a a6 e7 a2  15 b7 c8 1b
|   1e 72 aa b8  a8 1b 62 28  c1 05 18 f0  ad a0 37 ef
|   98 47 e5 f3  f4 d0 f7 76  7a 93 3f 08  ae 21 4d 38
|   c3 0c fe e7  49 aa d6 f7  90 6b df ed  88 0a d1 9c
|   95 97 35 8c  d2 e1 db 61  7f ad 72 87  f2 f1 fc a8
|   9e 0a b4 64  db 46 fc a5  f1 3e 99 22  ff ea 73 09
|   b5 00 d2 47  fd 08 3a 75  57 01 f5 54  4c 21 9e a5
|   2a c4 3e ac  c2 b0 fb f9  7d 26 43 38  f0 6d 78 1d
|   0a f3 87 d5  20 00 07 e6  e6 ef c9 42  2c 92 22 d5
|   18 95 f4 83  44 d7 ee 1d  a6 2b 63 04  57 c0 cc 48
|   a6 c1 ee 90  c9 a4 b9 e4  e4 d6 4a ac  1e 20 75 70
|   0a 0d fd c8  39 43 8d f7  78 49 cb a2  b6 5d 90 44
|   2f 13 5c a9  eb 91 ca cf  14 fb bb e2  87 32 c3 0f
|   39 89 bb 1f  40 a3 03 11  bc a9 c0 0e  ec 71 66 79
|   63 71 3d 8c  ce 15 03 9e  1b 07 bc 0e  a1 b1 a3 7d
|   a3
crl issuer cacert not found for (file:///tmp/ikev2-05-basic-psk/ipsec.d/crls/nic.crl)
  loaded crl file 'crashcrl-3.pem' (690 bytes)
|   file content is not binary ASN.1
|   -----BEGIN X509 CRL-----
|   -----END X509 CRL-----
|   file coded in PEM format
| L0 - certificateList:
|   30 82 01 d5  30 81 be 30  0d 06 09 2a  86 48 86 f7
|   0d 01 01 04  05 00 30 81  8e 31 0b 30  09 06 03 55
|   04 06 13 02  55 53 31 12  30 10 06 03  55 04 08 13
|   09 4d 69 6e  6e 65 73 6f  74 61 31 15  30 13 06 03
|   55 04 07 13  0c 45 64 65  6e 20 50 72  61 69 72 69
|   65 31 1e 30  1c 06 03 55  04 0a 13 15  52 65 61 6c
|   20 54 69 6d  65 20 45 6e  74 65 72 70  72 69 73 65
|   73 31 0c 30  0a 06 03 55  04 0b 13 03  56 50 4e 31
|   26 30 24 06  03 55 04 03  13 1d 52 54  45 20 56 50
|   4e 20 43 65  72 74 69 66  69 63 61 74  65 20 41 75
|   74 68 6f 72  69 74 79 17  0d 30 33 30  39 32 32 32
|   30 30 31 30  35 5a 17 0d  30 34 30 39  32 31 32 30
|   30 31 30 35  5a 30 0d 06  09 2a 86 48  86 f7 0d 01
|   01 04 05 00  03 82 01 01  00 6b 5b ed  2b 0a f7 5d
|   05 54 cc ed  c1 df 2d aa  f2 6c 42 2f  be 5b d3 c2
|   6a 6d 3c 86  cc ed 12 4f  08 d7 6e b6  68 2e 01 c8
|   64 eb 23 17  db c0 0e bd  b8 13 2a c8  ac 71 a3 f3
|   b0 34 6c 29  91 38 e6 42  6e 32 19 e8  f0 a3 6c a3
|   75 24 b3 32  42 0b d5 3d  6b 8c ff 71  3e 04 59 62
|   a4 01 45 13  65 36 78 c3  38 1a 35 8e  7c 4e c7 a5
|   b3 9b 1f 54  98 bc 16 2c  bc cf 3e 5e  9e 0c d5 7b
|   a3 0c 92 38  5d f7 b8 ba  00 63 69 de  06 b4 a7 98
|   30 8d 14 ea  27 7b 6d 85  22 dd 87 dd  8e 84 bd 30
|   db da 30 7e  ae 5d 6e 5c  e9 45 5c a7  a7 90 cb 0c
|   b0 c2 c2 9f  09 f9 e5 dc  74 7b 72 2c  f9 8d d6 be
|   c0 c4 e7 ae  51 7a 65 3c  74 0a ad f4  e8 43 48 68
|   c2 76 f1 c5  94 37 ec 19  c1 e2 e3 f6  09 34 d2 37
|   7a 5c cc 17  3d 1e 02 50  a1 45 f7 38  42 ee 59 32
|   55 9f f3 bc  bf 00 23 9b  86 71 eb 80  e1 46 13 88
|   29 4c 75 5c  36 00 b2 26  9d
| L1 - tbsCertList:
|   30 81 be 30  0d 06 09 2a  86 48 86 f7  0d 01 01 04
|   05 00 30 81  8e 31 0b 30  09 06 03 55  04 06 13 02
|   55 53 31 12  30 10 06 03  55 04 08 13  09 4d 69 6e
|   6e 65 73 6f  74 61 31 15  30 13 06 03  55 04 07 13
|   0c 45 64 65  6e 20 50 72  61 69 72 69  65 31 1e 30
|   1c 06 03 55  04 0a 13 15  52 65 61 6c  20 54 69 6d
|   65 20 45 6e  74 65 72 70  72 69 73 65  73 31 0c 30
|   0a 06 03 55  04 0b 13 03  56 50 4e 31  26 30 24 06
|   03 55 04 03  13 1d 52 54  45 20 56 50  4e 20 43 65
|   72 74 69 66  69 63 61 74  65 20 41 75  74 68 6f 72
|   69 74 79 17  0d 30 33 30  39 32 32 32  30 30 31 30
|   35 5a 17 0d  30 34 30 39  32 31 32 30  30 31 30 35
|   5a
| L2 - signature:
| L3 - algorithmIdentifier:
| L4 - algorithm:
|   'md5WithRSAEncryption'
| L2 - issuer:
|   30 81 8e 31  0b 30 09 06  03 55 04 06  13 02 55 53
|   31 12 30 10  06 03 55 04  08 13 09 4d  69 6e 6e 65
|   73 6f 74 61  31 15 30 13  06 03 55 04  07 13 0c 45
|   64 65 6e 20  50 72 61 69  72 69 65 31  1e 30 1c 06
|   03 55 04 0a  13 15 52 65  61 6c 20 54  69 6d 65 20
|   45 6e 74 65  72 70 72 69  73 65 73 31  0c 30 0a 06
|   03 55 04 0b  13 03 56 50  4e 31 26 30  24 06 03 55
|   04 03 13 1d  52 54 45 20  56 50 4e 20  43 65 72 74
|   69 66 69 63  61 74 65 20  41 75 74 68  6f 72 69 74
|   79
|   'C=US, ST=Minnesota, L=Eden Prairie, O=Real Time Enterprises, OU=VPN, CN=RTE VPN Certificate Authority'
| L2 - thisUpdate:
| L3 - utcTime:
|   'Sep 22 20:01:05 UTC 2003'
| L2 - nextUpdate:
| L3 - utcTime:
|   'Sep 21 20:01:05 UTC 2004'
| L1 - signatureAlgorithm:
| L2 - algorithmIdentifier:
| L3 - algorithm:
|   'md5WithRSAEncryption'
| L1 - signatureValue:
|   00 6b 5b ed  2b 0a f7 5d  05 54 cc ed  c1 df 2d aa
|   f2 6c 42 2f  be 5b d3 c2  6a 6d 3c 86  cc ed 12 4f
|   08 d7 6e b6  68 2e 01 c8  64 eb 23 17  db c0 0e bd
|   b8 13 2a c8  ac 71 a3 f3  b0 34 6c 29  91 38 e6 42
|   6e 32 19 e8  f0 a3 6c a3  75 24 b3 32  42 0b d5 3d
|   6b 8c ff 71  3e 04 59 62  a4 01 45 13  65 36 78 c3
|   38 1a 35 8e  7c 4e c7 a5  b3 9b 1f 54  98 bc 16 2c
|   bc cf 3e 5e  9e 0c d5 7b  a3 0c 92 38  5d f7 b8 ba
|   00 63 69 de  06 b4 a7 98  30 8d 14 ea  27 7b 6d 85
|   22 dd 87 dd  8e 84 bd 30  db da 30 7e  ae 5d 6e 5c
|   e9 45 5c a7  a7 90 cb 0c  b0 c2 c2 9f  09 f9 e5 dc
|   74 7b 72 2c  f9 8d d6 be  c0 c4 e7 ae  51 7a 65 3c
|   74 0a ad f4  e8 43 48 68  c2 76 f1 c5  94 37 ec 19
|   c1 e2 e3 f6  09 34 d2 37  7a 5c cc 17  3d 1e 02 50
|   a1 45 f7 38  42 ee 59 32  55 9f f3 bc  bf 00 23 9b
|   86 71 eb 80  e1 46 13 88  29 4c 75 5c  36 00 b2 26
|   9d
crl issuer cacert not found for (file:///tmp/ikev2-05-basic-psk/ipsec.d/crls/crashcrl-3.pem)
  loaded crl file 'crashcrl-2.pem' (528 bytes)
|   file content is not binary ASN.1
|   -----BEGIN X509 CRL-----
|   -----END X509 CRL-----
|   file coded in PEM format
| L0 - certificateList:
|   30 82 01 5d  30 81 c7 30  0d 06 09 2a  86 48 86 f7
|   0d 01 01 04  05 00 30 81  81 31 0b 30  09 06 03 55
|   04 06 13 02  64 65 31 0b  30 09 06 03  55 04 08 13
|   02 42 57 31  0b 30 09 06  03 55 04 07  13 02 4b 41
|   31 0f 30 0d  06 03 55 04  0a 13 06 41  73 74 61 72
|   6f 31 14 30  12 06 03 55  04 0b 13 0b  44 65 76 65
|   6c 6f 70 6d  65 6e 74 31  0f 30 0d 06  03 55 04 03
|   13 06 74 65  73 74 63 61  31 20 30 1e  06 09 2a 86
|   48 86 f7 0d  01 09 01 16  11 74 65 73  74 63 61 40
|   61 73 74 61  72 6f 2e 63  6f 6d 17 0d  30 34 30 33
|   30 35 31 30  34 37 31 34  5a 17 0d 30  34 30 35 30
|   34 31 30 34  37 31 34 5a  30 14 30 12  02 01 01 17
|   0d 30 34 30  33 30 35 31  30 34 36 32  31 5a 30 0d
|   06 09 2a 86  48 86 f7 0d  01 01 04 05  00 03 81 81
|   00 67 55 be  f3 fd e9 98  ff eb b6 5e  22 3e ae 14
|   0b 36 c6 88  8a 72 7a f1  9c 3d b9 63  6e 4d 6e d1
|   4b 67 89 40  97 ee b5 49  50 5a ce 15  1a 0b e5 c5
|   bc 6e 82 8e  71 0c a7 55  3b 31 88 05  9b 45 50 b0
|   f2 0e ce 01  e5 f2 6a 8d  e2 5d 9b 77  33 b5 94 3c
|   8e f3 1b bf  86 dd 41 f4  34 54 8c b7  4a 77 0e 0f
|   a3 71 97 37  7f 7e 84 85  ef 7b 97 5b  2c 90 ca 97
|   8a c5 1d bd  60 cc ff ab  72 b8 18 24  48 54 fa ab
|   5e
| L1 - tbsCertList:
|   30 81 c7 30  0d 06 09 2a  86 48 86 f7  0d 01 01 04
|   05 00 30 81  81 31 0b 30  09 06 03 55  04 06 13 02
|   64 65 31 0b  30 09 06 03  55 04 08 13  02 42 57 31
|   0b 30 09 06  03 55 04 07  13 02 4b 41  31 0f 30 0d
|   06 03 55 04  0a 13 06 41  73 74 61 72  6f 31 14 30
|   12 06 03 55  04 0b 13 0b  44 65 76 65  6c 6f 70 6d
|   65 6e 74 31  0f 30 0d 06  03 55 04 03  13 06 74 65
|   73 74 63 61  31 20 30 1e  06 09 2a 86  48 86 f7 0d
|   01 09 01 16  11 74 65 73  74 63 61 40  61 73 74 61
|   72 6f 2e 63  6f 6d 17 0d  30 34 30 33  30 35 31 30
|   34 37 31 34  5a 17 0d 30  34 30 35 30  34 31 30 34
|   37 31 34 5a  30 14 30 12  02 01 01 17  0d 30 34 30
|   33 30 35 31  30 34 36 32  31 5a
| L2 - signature:
| L3 - algorithmIdentifier:
| L4 - algorithm:
|   'md5WithRSAEncryption'
| L2 - issuer:
|   30 81 81 31  0b 30 09 06  03 55 04 06  13 02 64 65
|   31 0b 30 09  06 03 55 04  08 13 02 42  57 31 0b 30
|   09 06 03 55  04 07 13 02  4b 41 31 0f  30 0d 06 03
|   55 04 0a 13  06 41 73 74  61 72 6f 31  14 30 12 06
|   03 55 04 0b  13 0b 44 65  76 65 6c 6f  70 6d 65 6e
|   74 31 0f 30  0d 06 03 55  04 03 13 06  74 65 73 74
|   63 61 31 20  30 1e 06 09  2a 86 48 86  f7 0d 01 09
|   01 16 11 74  65 73 74 63  61 40 61 73  74 61 72 6f
|   2e 63 6f 6d
|   'C=de, ST=BW, L=KA, O=Astaro, OU=Development, CN=testca, E=testca@astaro.com'
| L2 - thisUpdate:
| L3 - utcTime:
|   'Mar 05 10:47:14 UTC 2004'
| L2 - nextUpdate:
| L3 - utcTime:
|   'May 04 10:47:14 UTC 2004'
| L2 - revokedCertificates:
| L3 - certList:
| L4 - userCertificate:
|   01
| L4 - revocationDate:
| L5 - utcTime:
|   'Mar 05 10:46:21 UTC 2004'
| L1 - signatureAlgorithm:
| L2 - algorithmIdentifier:
| L3 - algorithm:
|   'md5WithRSAEncryption'
| L1 - signatureValue:
|   00 67 55 be  f3 fd e9 98  ff eb b6 5e  22 3e ae 14
|   0b 36 c6 88  8a 72 7a f1  9c 3d b9 63  6e 4d 6e d1
|   4b 67 89 40  97 ee b5 49  50 5a ce 15  1a 0b e5 c5
|   bc 6e 82 8e  71 0c a7 55  3b 31 88 05  9b 45 50 b0
|   f2 0e ce 01  e5 f2 6a 8d  e2 5d 9b 77  33 b5 94 3c
|   8e f3 1b bf  86 dd 41 f4  34 54 8c b7  4a 77 0e 0f
|   a3 71 97 37  7f 7e 84 85  ef 7b 97 5b  2c 90 ca 97
|   8a c5 1d bd  60 cc ff ab  72 b8 18 24  48 54 fa ab
|   5e
crl issuer cacert not found for (file:///tmp/ikev2-05-basic-psk/ipsec.d/crls/crashcrl-2.pem)
  loaded crl file 'crashcrl-1.pem' (1053 bytes)
|   file content is not binary ASN.1
|   -----BEGIN X509 CRL-----
|   -----END X509 CRL-----
|   file coded in PEM format
| L0 - certificateList:
|   30 82 02 df  30 81 c8 30  0d 06 09 2a  86 48 86 f7
|   0d 01 01 04  05 00 30 81  98 31 0b 30  09 06 03 55
|   04 06 13 02  41 54 31 13  30 11 06 03  55 04 08 13
|   0a 56 6f 72  61 72 6c 62  65 72 67 31  11 30 0f 06
|   03 55 04 07  13 08 4c 75  73 74 65 6e  61 75 31 21
|   30 1f 06 03  55 04 0a 13  18 4e 65 77  4c 6f 67 69
|   63 20 54 65  63 68 6e 6f  6c 6f 67 69  65 73 20 41
|   47 31 18 30  16 06 03 55  04 03 13 0f  63 61 2e 6e
|   65 77 6c 6f  67 69 63 2e  63 6f 6d 31  24 30 22 06
|   09 2a 86 48  86 f7 0d 01  09 01 16 15  61 64 6d 2d
|   63 65 72 74  40 6e 65 77  6c 6f 67 69  63 2e 63 6f
|   6d 17 0d 30  34 30 33 31  38 30 31 33  36 30 37 5a
|   17 0d 30 34  30 34 31 37  30 31 33 36  30 37 5a 30
|   0d 06 09 2a  86 48 86 f7  0d 01 01 04  05 00 03 82
|   02 01 00 a6  e0 db e2 e7  fe 8d 57 81  04 c1 77 cb
|   bd a8 55 09  74 74 4b ce  66 e6 37 d0  3b a1 39 14
|   4a d2 6c 16  81 8f 55 ba  d5 be bd ed  f0 d7 f4 01
|   b1 13 fd 1b  d0 24 ca d5  9b 0e b2 2f  bd f0 76 d6
|   35 27 82 5f  7f c6 d4 7e  67 eb 09 1d  05 99 d9 b9
|   99 3d eb c7  b5 86 4b 85  1a b4 91 ed  40 31 1b 9c
|   6d 62 0b 5d  40 c2 5c 39  66 eb 75 85  15 8c a5 c5
|   35 f0 dc a6  ed 41 6e c3  30 60 f3 89  49 05 27 06
|   75 6d 67 e0  47 46 0e 73  7e 42 00 13  a8 2d 96 08
|   a4 2a 55 cd  ab 46 f0 38  3f 51 f1 65  9c 0f bc c3
|   fb 8e 4d c6  64 a6 6e 46  53 d3 e6 7a  d3 25 bd 8c
|   83 0d 7a 39  11 74 33 2d  9c b9 15 62  63 9d ae c7
|   4c 48 68 73  6c 81 db 05  31 94 f5 88  e5 6c ff 2c
|   bb 5c ea d2  90 6d 40 b7  3c 8a f0 fb  5e cd 7a 3d
|   66 93 19 2c  81 d7 c3 33  91 92 20 9f  5f 38 58 e0
|   4f e3 5f 2c  f2 ec c9 c0  7a 08 fa 73  94 48 b7 5d
|   5b 46 b1 e9  36 ad 38 d5  d0 b3 b7 3b  43 78 37 ad
|   43 6f 6b 53  91 c4 ff b0  76 d9 96 1d  8a 6a 25 9c
|   23 13 0c dd  6b a1 64 b4  0b 45 62 ba  07 b1 4a c0
|   2a 21 81 2a  d4 3d b8 c7  03 84 33 bf  87 3f de 1a
|   ca 60 b6 2c  ec ff b0 92  bd 2e a0 d5  fd 10 3c bb
|   f1 eb 5e 63  2e 99 42 3a  b4 8f a5 71  e6 08 3d e0
|   13 58 2a 68  1b a9 79 18  b3 1c 8e b4  c2 35 bd f2
|   ad a2 a7 d1  dc 4f 41 a7  a0 54 0a 15  15 97 e5 6a
|   41 95 74 f9  71 1d 63 4a  d0 cd 80 50  b1 6d 08 b7
|   e3 36 91 01  fa e2 4b 62  ea 93 32 47  a6 f3 14 88
|   3c 3f fb 0d  cc 38 1b 19  41 26 a5 0f  d0 00 5c b0
|   8f 04 77 30  c8 ce ea c7  6b e8 a5 bc  25 1d a5 4f
|   d2 3d 4b 04  59 44 ba 01  ad f1 09 df  e4 5d a6 61
|   03 53 a9 29  ba 1f be 18  be c8 73 9f  db 08 1a b4
|   4c 71 3c b7  a0 53 ec 41  87 a3 ac 46  57 3d 54 b2
|   4c a6 97 14  6a 8d 75 fa  70 d7 bf c6  5d 91 e6 66
|   02 df 3d
| L1 - tbsCertList:
|   30 81 c8 30  0d 06 09 2a  86 48 86 f7  0d 01 01 04
|   05 00 30 81  98 31 0b 30  09 06 03 55  04 06 13 02
|   41 54 31 13  30 11 06 03  55 04 08 13  0a 56 6f 72
|   61 72 6c 62  65 72 67 31  11 30 0f 06  03 55 04 07
|   13 08 4c 75  73 74 65 6e  61 75 31 21  30 1f 06 03
|   55 04 0a 13  18 4e 65 77  4c 6f 67 69  63 20 54 65
|   63 68 6e 6f  6c 6f 67 69  65 73 20 41  47 31 18 30
|   16 06 03 55  04 03 13 0f  63 61 2e 6e  65 77 6c 6f
|   67 69 63 2e  63 6f 6d 31  24 30 22 06  09 2a 86 48
|   86 f7 0d 01  09 01 16 15  61 64 6d 2d  63 65 72 74
|   40 6e 65 77  6c 6f 67 69  63 2e 63 6f  6d 17 0d 30
|   34 30 33 31  38 30 31 33  36 30 37 5a  17 0d 30 34
|   30 34 31 37  30 31 33 36  30 37 5a
| L2 - signature:
| L3 - algorithmIdentifier:
| L4 - algorithm:
|   'md5WithRSAEncryption'
| L2 - issuer:
|   30 81 98 31  0b 30 09 06  03 55 04 06  13 02 41 54
|   31 13 30 11  06 03 55 04  08 13 0a 56  6f 72 61 72
|   6c 62 65 72  67 31 11 30  0f 06 03 55  04 07 13 08
|   4c 75 73 74  65 6e 61 75  31 21 30 1f  06 03 55 04
|   0a 13 18 4e  65 77 4c 6f  67 69 63 20  54 65 63 68
|   6e 6f 6c 6f  67 69 65 73  20 41 47 31  18 30 16 06
|   03 55 04 03  13 0f 63 61  2e 6e 65 77  6c 6f 67 69
|   63 2e 63 6f  6d 31 24 30  22 06 09 2a  86 48 86 f7
|   0d 01 09 01  16 15 61 64  6d 2d 63 65  72 74 40 6e
|   65 77 6c 6f  67 69 63 2e  63 6f 6d
|   'C=AT, ST=Vorarlberg, L=Lustenau, O=NewLogic Technologies AG, CN=ca.newlogic.com, E=adm-cert@newlogic.com'
| L2 - thisUpdate:
| L3 - utcTime:
|   'Mar 18 01:36:07 UTC 2004'
| L2 - nextUpdate:
| L3 - utcTime:
|   'Apr 17 01:36:07 UTC 2004'
| L1 - signatureAlgorithm:
| L2 - algorithmIdentifier:
| L3 - algorithm:
|   'md5WithRSAEncryption'
| L1 - signatureValue:
|   00 a6 e0 db  e2 e7 fe 8d  57 81 04 c1  77 cb bd a8
|   55 09 74 74  4b ce 66 e6  37 d0 3b a1  39 14 4a d2
|   6c 16 81 8f  55 ba d5 be  bd ed f0 d7  f4 01 b1 13
|   fd 1b d0 24  ca d5 9b 0e  b2 2f bd f0  76 d6 35 27
|   82 5f 7f c6  d4 7e 67 eb  09 1d 05 99  d9 b9 99 3d
|   eb c7 b5 86  4b 85 1a b4  91 ed 40 31  1b 9c 6d 62
|   0b 5d 40 c2  5c 39 66 eb  75 85 15 8c  a5 c5 35 f0
|   dc a6 ed 41  6e c3 30 60  f3 89 49 05  27 06 75 6d
|   67 e0 47 46  0e 73 7e 42  00 13 a8 2d  96 08 a4 2a
|   55 cd ab 46  f0 38 3f 51  f1 65 9c 0f  bc c3 fb 8e
|   4d c6 64 a6  6e 46 53 d3  e6 7a d3 25  bd 8c 83 0d
|   7a 39 11 74  33 2d 9c b9  15 62 63 9d  ae c7 4c 48
|   68 73 6c 81  db 05 31 94  f5 88 e5 6c  ff 2c bb 5c
|   ea d2 90 6d  40 b7 3c 8a  f0 fb 5e cd  7a 3d 66 93
|   19 2c 81 d7  c3 33 91 92  20 9f 5f 38  58 e0 4f e3
|   5f 2c f2 ec  c9 c0 7a 08  fa 73 94 48  b7 5d 5b 46
|   b1 e9 36 ad  38 d5 d0 b3  b7 3b 43 78  37 ad 43 6f
|   6b 53 91 c4  ff b0 76 d9  96 1d 8a 6a  25 9c 23 13
|   0c dd 6b a1  64 b4 0b 45  62 ba 07 b1  4a c0 2a 21
|   81 2a d4 3d  b8 c7 03 84  33 bf 87 3f  de 1a ca 60
|   b6 2c ec ff  b0 92 bd 2e  a0 d5 fd 10  3c bb f1 eb
|   5e 63 2e 99  42 3a b4 8f  a5 71 e6 08  3d e0 13 58
|   2a 68 1b a9  79 18 b3 1c  8e b4 c2 35  bd f2 ad a2
|   a7 d1 dc 4f  41 a7 a0 54  0a 15 15 97  e5 6a 41 95
|   74 f9 71 1d  63 4a d0 cd  80 50 b1 6d  08 b7 e3 36
|   91 01 fa e2  4b 62 ea 93  32 47 a6 f3  14 88 3c 3f
|   fb 0d cc 38  1b 19 41 26  a5 0f d0 00  5c b0 8f 04
|   77 30 c8 ce  ea c7 6b e8  a5 bc 25 1d  a5 4f d2 3d
|   4b 04 59 44  ba 01 ad f1  09 df e4 5d  a6 61 03 53
|   a9 29 ba 1f  be 18 be c8  73 9f db 08  1a b4 4c 71
|   3c b7 a0 53  ec 41 87 a3  ac 46 57 3d  54 b2 4c a6
|   97 14 6a 8d  75 fa 70 d7  bf c6 5d 91  e6 66 02 df
|   3d
crl issuer cacert not found for (file:///tmp/ikev2-05-basic-psk/ipsec.d/crls/crashcrl-1.pem)
| inserting event EVENT_LOG_DAILY, timeout in 32309 seconds
| next event EVENT_SHUNT_SCAN in 120 seconds
! helper 0 waiting on fd: 7
|  
| *received whack message
| started recording whack messages to /var/tmp/ikev2.record 
| * processed 0 messages from cryptographic helpers 
| next event EVENT_SHUNT_SCAN in 120 seconds
|  
| *received whack message
listening for IKE messages
| found ipsec0 with address 192.1.2.45
| found eth0 with address 192.0.1.254
| found eth1 with address 192.1.2.45
| found eth2 with address 192.9.4.45
| found lo with address 127.0.0.1
| IP interface lo 127.0.0.1 has no matching ipsec* interface -- ignored
| IP interface eth2 192.9.4.45 has no matching ipsec* interface -- ignored
adding interface ipsec0/eth1 192.1.2.45:500
| IP interface eth0 192.0.1.254 has no matching ipsec* interface -- ignored
| could not open /proc/net/if_inet6
loading secrets from "/tmp/ikev2-05-basic-psk/ipsec.secrets"
| id type added to secret(0x813fe68) 1: @west
| id type added to secret(0x813fe68) 1: @east
| Processing PSK at line 1: passed
| * processed 0 messages from cryptographic helpers 
| next event EVENT_SHUNT_SCAN in 120 seconds
|  
| *received whack message
| Added new connection westnet--eastnet-ikev2 with policy PSK+ENCRYPT+TUNNEL+PFS+!IKEv1+IKEv2ALLOW+IKEv2Init
| counting wild cards for @west is 0
| counting wild cards for @east is 0
| connect_to_host_pair: 192.1.2.45:500 192.1.2.23:500 -> hp:none 
added connection description "westnet--eastnet-ikev2"
| 192.0.1.0/24===192.1.2.45<192.1.2.45>[@west,S=C]...192.1.2.23<192.1.2.23>[@east,S=C]===192.0.2.0/24
| ike_life: 3600s; ipsec_life: 28800s; rekey_margin: 540s; rekey_fuzz: 100%; keyingtries: 3; policy: PSK+ENCRYPT+TUNNEL+PFS+!IKEv1+IKEv2ALLOW+IKEv2Init
| * processed 0 messages from cryptographic helpers 
| next event EVENT_SHUNT_SCAN in 120 seconds
|  
| *received whack message
| * processed 0 messages from cryptographic helpers 
| next event EVENT_SHUNT_SCAN in 119 seconds
|  
| *received whack message
listening for IKE messages
| found ipsec0 with address 192.1.2.45
| found eth0 with address 192.0.1.254
| found eth1 with address 192.1.2.45
| found eth2 with address 192.9.4.45
| found lo with address 127.0.0.1
| IP interface lo 127.0.0.1 has no matching ipsec* interface -- ignored
| IP interface eth2 192.9.4.45 has no matching ipsec* interface -- ignored
| IP interface eth0 192.0.1.254 has no matching ipsec* interface -- ignored
| could not open /proc/net/if_inet6
forgetting secrets
loading secrets from "/tmp/ikev2-05-basic-psk/ipsec.secrets"
| id type added to secret(0x813f368) 1: @west
| id type added to secret(0x813f368) 1: @east
| Processing PSK at line 1: passed
| * processed 0 messages from cryptographic helpers 
| next event EVENT_SHUNT_SCAN in 119 seconds
|  
| *received whack message
| processing connection westnet--eastnet-ikev2
| empty esp_info, returning defaults
| creating state object #1 at 0x8140aa0
| processing connection westnet--eastnet-ikev2
| ICOOKIE:  1d 56 aa 77  a7 e4 a2 b3
| RCOOKIE:  00 00 00 00  00 00 00 00
| state hash entry 20
| inserting state object #1 on chain 20
| inserting event EVENT_SO_DISCARD, timeout in 0 seconds for #1
| processing connection westnet--eastnet-ikev2
| Queuing pending Quick Mode with 192.1.2.23 "westnet--eastnet-ikev2"
"westnet--eastnet-ikev2" #1: initiating v2 parent SA
| no IKE algorithms for this connection 
| 0: w->pcw_dead: 0 w->pcw_work: 0 cnt: 1
| asking helper 0 to do build_kenonce op on seq: 1 (len=2668, pcw_work=1)
| crypto helper write of request: cnt=2668<wlen=2668.  
| inserting event EVENT_CRYPTO_FAILED, timeout in 300 seconds for #1
| * processed 0 messages from cryptographic helpers 
| next event EVENT_SHUNT_SCAN in 118 seconds
! helper 0 read 2664+4/2668 bytesfd: 7
! helper 0 doing build_kenonce op id: 1
! Local DH secret:
!   b9 b4 4c dc  cd c5 7e 65  ed 16 f1 0d  1c a2 7c 4c
!   65 84 1c 69  d4 1e eb d5  59 b9 15 4c  bc 43 7b a0
! Public DH value sent:
!   11 a2 55 e4  76 51 88 07  03 9a da a5  f8 7c 84 c8
!   39 95 cd 28  c4 60 32 f2  1b 6a 78 72  8e 6b cc 06
!   82 24 c1 a4  33 af 01 53  21 99 b6 fe  e1 14 73 88
!   5e 23 c7 00  87 c8 20 91  a9 9a a1 30  7d cb 2a 3e
!   21 9a d3 7d  87 ec b5 dd  86 e4 1a 51  b6 a6 01 ef
!   03 89 d3 77  34 18 92 76  9c fa 57 be  ea 34 2a cd
!   eb 1f 8d 69  6a 86 28 03  6f 1f 3c d7  2f ee 84 eb
!   1c 9f 9e 56  90 68 98 14  62 b2 7b 76  d1 e8 36 be
!   55 fd 8d 18  18 a7 bb 60  30 d0 f5 e3  ed a2 e8 ea
!   11 fa bf 52  4b 2d be f2  da 18 d5 6f  92 1f 4a cc
!   51 77 a7 00  82 e0 8a 7b  21 f7 5b bd  0f 63 47 ea
!   86 5d b5 5e  39 bc 63 1b  62 66 e1 c4  44 fb b1 a1
!   9f 3b e2 79  c7 b8 14 0c  3a 17 7b d0  4c e8 1d f7
!   c8 39 a4 57  39 31 67 20  10 be dc f6  6f 97 47 cb
!   15 b0 42 8a  c4 08 b8 49  f5 4d 79 d6  8f 18 c6 19
!   ea 7b 39 60  8a b1 a8 6e  f4 4b 81 54  3c 5b 77 2f
! Generated nonce:
!   22 91 12 b0  c2 41 9a 9a  2f 75 85 cc  3a 1e 1c 27
|  
| helper 0 has finished work (cnt now 1)
| helper 0 replies to id: q#1
| calling callback function 0x807591c
| ikev2 parent outI1: calculated ke+nonce, sending I1
| processing connection westnet--eastnet-ikev2
| **emit ISAKMP Message:
|    initiator cookie:
|   1d 56 aa 77  a7 e4 a2 b3
|    responder cookie:
|   00 00 00 00  00 00 00 00
|    next payload type: ISAKMP_NEXT_v2SA
|    ISAKMP version: IKEv2 version 2.0 (rfc4306)
|    exchange type: ISAKMP_v2_SA_INIT
|    flags: ISAKMP_FLAG_INIT
|    message ID:  00 00 00 00
| ***emit IKEv2 Security Association Payload:
|    next payload type: ISAKMP_NEXT_v2KE
|    critical bit: Payload-Critical
| ****emit IKEv2 Proposal Substructure Payload:
|    next payload type: ISAKMP_NEXT_P
|    prop #: 1
|    proto ID: 1
|    spi size: 0
|    # transforms: 4
| *****emit IKEv2 Transform Substructure Payload:
|    next payload type: ISAKMP_NEXT_T
|    transform type: 1
|    transform ID: 12
| emitting length of IKEv2 Transform Substructure Payload: 8
| *****emit IKEv2 Transform Substructure Payload:
|    next payload type: ISAKMP_NEXT_T
|    transform type: 3
|    transform ID: 2
| emitting length of IKEv2 Transform Substructure Payload: 8
| *****emit IKEv2 Transform Substructure Payload:
|    next payload type: ISAKMP_NEXT_T
|    transform type: 2
|    transform ID: 2
| emitting length of IKEv2 Transform Substructure Payload: 8
| *****emit IKEv2 Transform Substructure Payload:
|    next payload type: ISAKMP_NEXT_NONE
|    transform type: 4
|    transform ID: 14
| emitting length of IKEv2 Transform Substructure Payload: 8
| emitting length of IKEv2 Proposal Substructure Payload: 40
| ****emit IKEv2 Proposal Substructure Payload:
|    next payload type: ISAKMP_NEXT_P
|    prop #: 2
|    proto ID: 1
|    spi size: 0
|    # transforms: 4
| *****emit IKEv2 Transform Substructure Payload:
|    next payload type: ISAKMP_NEXT_T
|    transform type: 1
|    transform ID: 12
| emitting length of IKEv2 Transform Substructure Payload: 8
| *****emit IKEv2 Transform Substructure Payload:
|    next payload type: ISAKMP_NEXT_T
|    transform type: 3
|    transform ID: 2
| emitting length of IKEv2 Transform Substructure Payload: 8
| *****emit IKEv2 Transform Substructure Payload:
|    next payload type: ISAKMP_NEXT_T
|    transform type: 2
|    transform ID: 1
| emitting length of IKEv2 Transform Substructure Payload: 8
| *****emit IKEv2 Transform Substructure Payload:
|    next payload type: ISAKMP_NEXT_NONE
|    transform type: 4
|    transform ID: 14
| emitting length of IKEv2 Transform Substructure Payload: 8
| emitting length of IKEv2 Proposal Substructure Payload: 40
| ****emit IKEv2 Proposal Substructure Payload:
|    next payload type: ISAKMP_NEXT_P
|    prop #: 3
|    proto ID: 1
|    spi size: 0
|    # transforms: 4
| *****emit IKEv2 Transform Substructure Payload:
|    next payload type: ISAKMP_NEXT_T
|    transform type: 1
|    transform ID: 3
| emitting length of IKEv2 Transform Substructure Payload: 8
| *****emit IKEv2 Transform Substructure Payload:
|    next payload type: ISAKMP_NEXT_T
|    transform type: 3
|    transform ID: 2
| emitting length of IKEv2 Transform Substructure Payload: 8
| *****emit IKEv2 Transform Substructure Payload:
|    next payload type: ISAKMP_NEXT_T
|    transform type: 2
|    transform ID: 2
| emitting length of IKEv2 Transform Substructure Payload: 8
| *****emit IKEv2 Transform Substructure Payload:
|    next payload type: ISAKMP_NEXT_NONE
|    transform type: 4
|    transform ID: 14
| emitting length of IKEv2 Transform Substructure Payload: 8
| emitting length of IKEv2 Proposal Substructure Payload: 40
| ****emit IKEv2 Proposal Substructure Payload:
|    next payload type: ISAKMP_NEXT_P
|    prop #: 4
|    proto ID: 1
|    spi size: 0
|    # transforms: 4
| *****emit IKEv2 Transform Substructure Payload:
|    next payload type: ISAKMP_NEXT_T
|    transform type: 1
|    transform ID: 3
| emitting length of IKEv2 Transform Substructure Payload: 8
| *****emit IKEv2 Transform Substructure Payload:
|    next payload type: ISAKMP_NEXT_T
|    transform type: 3
|    transform ID: 2
| emitting length of IKEv2 Transform Substructure Payload: 8
| *****emit IKEv2 Transform Substructure Payload:
|    next payload type: ISAKMP_NEXT_T
|    transform type: 2
|    transform ID: 1
| emitting length of IKEv2 Transform Substructure Payload: 8
| *****emit IKEv2 Transform Substructure Payload:
|    next payload type: ISAKMP_NEXT_NONE
|    transform type: 4
|    transform ID: 14
| emitting length of IKEv2 Transform Substructure Payload: 8
| emitting length of IKEv2 Proposal Substructure Payload: 40
| ****emit IKEv2 Proposal Substructure Payload:
|    next payload type: ISAKMP_NEXT_P
|    prop #: 5
|    proto ID: 1
|    spi size: 0
|    # transforms: 4
| *****emit IKEv2 Transform Substructure Payload:
|    next payload type: ISAKMP_NEXT_T
|    transform type: 1
|    transform ID: 12
| emitting length of IKEv2 Transform Substructure Payload: 8
| *****emit IKEv2 Transform Substructure Payload:
|    next payload type: ISAKMP_NEXT_T
|    transform type: 3
|    transform ID: 2
| emitting length of IKEv2 Transform Substructure Payload: 8
| *****emit IKEv2 Transform Substructure Payload:
|    next payload type: ISAKMP_NEXT_T
|    transform type: 2
|    transform ID: 2
| emitting length of IKEv2 Transform Substructure Payload: 8
| *****emit IKEv2 Transform Substructure Payload:
|    next payload type: ISAKMP_NEXT_NONE
|    transform type: 4
|    transform ID: 5
| emitting length of IKEv2 Transform Substructure Payload: 8
| emitting length of IKEv2 Proposal Substructure Payload: 40
| ****emit IKEv2 Proposal Substructure Payload:
|    next payload type: ISAKMP_NEXT_P
|    prop #: 6
|    proto ID: 1
|    spi size: 0
|    # transforms: 4
| *****emit IKEv2 Transform Substructure Payload:
|    next payload type: ISAKMP_NEXT_T
|    transform type: 1
|    transform ID: 12
| emitting length of IKEv2 Transform Substructure Payload: 8
| *****emit IKEv2 Transform Substructure Payload:
|    next payload type: ISAKMP_NEXT_T
|    transform type: 3
|    transform ID: 2
| emitting length of IKEv2 Transform Substructure Payload: 8
| *****emit IKEv2 Transform Substructure Payload:
|    next payload type: ISAKMP_NEXT_T
|    transform type: 2
|    transform ID: 1
| emitting length of IKEv2 Transform Substructure Payload: 8
| *****emit IKEv2 Transform Substructure Payload:
|    next payload type: ISAKMP_NEXT_NONE
|    transform type: 4
|    transform ID: 5
| emitting length of IKEv2 Transform Substructure Payload: 8
| emitting length of IKEv2 Proposal Substructure Payload: 40
| ****emit IKEv2 Proposal Substructure Payload:
|    next payload type: ISAKMP_NEXT_P
|    prop #: 7
|    proto ID: 1
|    spi size: 0
|    # transforms: 4
| *****emit IKEv2 Transform Substructure Payload:
|    next payload type: ISAKMP_NEXT_T
|    transform type: 1
|    transform ID: 3
| emitting length of IKEv2 Transform Substructure Payload: 8
| *****emit IKEv2 Transform Substructure Payload:
|    next payload type: ISAKMP_NEXT_T
|    transform type: 3
|    transform ID: 2
| emitting length of IKEv2 Transform Substructure Payload: 8
| *****emit IKEv2 Transform Substructure Payload:
|    next payload type: ISAKMP_NEXT_T
|    transform type: 2
|    transform ID: 2
| emitting length of IKEv2 Transform Substructure Payload: 8
| *****emit IKEv2 Transform Substructure Payload:
|    next payload type: ISAKMP_NEXT_NONE
|    transform type: 4
|    transform ID: 5
| emitting length of IKEv2 Transform Substructure Payload: 8
| emitting length of IKEv2 Proposal Substructure Payload: 40
| ****emit IKEv2 Proposal Substructure Payload:
|    next payload type: ISAKMP_NEXT_P
|    prop #: 8
|    proto ID: 1
|    spi size: 0
|    # transforms: 4
| *****emit IKEv2 Transform Substructure Payload:
|    next payload type: ISAKMP_NEXT_T
|    transform type: 1
|    transform ID: 3
| emitting length of IKEv2 Transform Substructure Payload: 8
| *****emit IKEv2 Transform Substructure Payload:
|    next payload type: ISAKMP_NEXT_T
|    transform type: 3
|    transform ID: 2
| emitting length of IKEv2 Transform Substructure Payload: 8
| *****emit IKEv2 Transform Substructure Payload:
|    next payload type: ISAKMP_NEXT_T
|    transform type: 2
|    transform ID: 1
| emitting length of IKEv2 Transform Substructure Payload: 8
| *****emit IKEv2 Transform Substructure Payload:
|    next payload type: ISAKMP_NEXT_NONE
|    transform type: 4
|    transform ID: 5
| emitting length of IKEv2 Transform Substructure Payload: 8
| emitting length of IKEv2 Proposal Substructure Payload: 40
| ****emit IKEv2 Proposal Substructure Payload:
|    next payload type: ISAKMP_NEXT_P
|    prop #: 9
|    proto ID: 1
|    spi size: 0
|    # transforms: 4
| *****emit IKEv2 Transform Substructure Payload:
|    next payload type: ISAKMP_NEXT_T
|    transform type: 1
|    transform ID: 3
| emitting length of IKEv2 Transform Substructure Payload: 8
| *****emit IKEv2 Transform Substructure Payload:
|    next payload type: ISAKMP_NEXT_T
|    transform type: 3
|    transform ID: 2
| emitting length of IKEv2 Transform Substructure Payload: 8
| *****emit IKEv2 Transform Substructure Payload:
|    next payload type: ISAKMP_NEXT_T
|    transform type: 2
|    transform ID: 2
| emitting length of IKEv2 Transform Substructure Payload: 8
| *****emit IKEv2 Transform Substructure Payload:
|    next payload type: ISAKMP_NEXT_NONE
|    transform type: 4
|    transform ID: 2
| emitting length of IKEv2 Transform Substructure Payload: 8
| emitting length of IKEv2 Proposal Substructure Payload: 40
| ****emit IKEv2 Proposal Substructure Payload:
|    next payload type: ISAKMP_NEXT_NONE
|    prop #: 10
|    proto ID: 1
|    spi size: 0
|    # transforms: 4
| *****emit IKEv2 Transform Substructure Payload:
|    next payload type: ISAKMP_NEXT_T
|    transform type: 1
|    transform ID: 3
| emitting length of IKEv2 Transform Substructure Payload: 8
| *****emit IKEv2 Transform Substructure Payload:
|    next payload type: ISAKMP_NEXT_T
|    transform type: 3
|    transform ID: 2
| emitting length of IKEv2 Transform Substructure Payload: 8
| *****emit IKEv2 Transform Substructure Payload:
|    next payload type: ISAKMP_NEXT_T
|    transform type: 2
|    transform ID: 1
| emitting length of IKEv2 Transform Substructure Payload: 8
| *****emit IKEv2 Transform Substructure Payload:
|    next payload type: ISAKMP_NEXT_NONE
|    transform type: 4
|    transform ID: 2
| emitting length of IKEv2 Transform Substructure Payload: 8
| emitting length of IKEv2 Proposal Substructure Payload: 40
| emitting length of IKEv2 Security Association Payload: 404
| ***emit IKEv2 Key Exchange Payload:
|    next payload type: ISAKMP_NEXT_v2Ni
|    transform type: 14
| emitting 256 raw bytes of ikev2 g^x into IKEv2 Key Exchange Payload
| ikev2 g^x  11 a2 55 e4  76 51 88 07  03 9a da a5  f8 7c 84 c8
| ikev2 g^x  39 95 cd 28  c4 60 32 f2  1b 6a 78 72  8e 6b cc 06
| ikev2 g^x  82 24 c1 a4  33 af 01 53  21 99 b6 fe  e1 14 73 88
| ikev2 g^x  5e 23 c7 00  87 c8 20 91  a9 9a a1 30  7d cb 2a 3e
| ikev2 g^x  21 9a d3 7d  87 ec b5 dd  86 e4 1a 51  b6 a6 01 ef
| ikev2 g^x  03 89 d3 77  34 18 92 76  9c fa 57 be  ea 34 2a cd
| ikev2 g^x  eb 1f 8d 69  6a 86 28 03  6f 1f 3c d7  2f ee 84 eb
| ikev2 g^x  1c 9f 9e 56  90 68 98 14  62 b2 7b 76  d1 e8 36 be
| ikev2 g^x  55 fd 8d 18  18 a7 bb 60  30 d0 f5 e3  ed a2 e8 ea
| ikev2 g^x  11 fa bf 52  4b 2d be f2  da 18 d5 6f  92 1f 4a cc
| ikev2 g^x  51 77 a7 00  82 e0 8a 7b  21 f7 5b bd  0f 63 47 ea
| ikev2 g^x  86 5d b5 5e  39 bc 63 1b  62 66 e1 c4  44 fb b1 a1
| ikev2 g^x  9f 3b e2 79  c7 b8 14 0c  3a 17 7b d0  4c e8 1d f7
| ikev2 g^x  c8 39 a4 57  39 31 67 20  10 be dc f6  6f 97 47 cb
| ikev2 g^x  15 b0 42 8a  c4 08 b8 49  f5 4d 79 d6  8f 18 c6 19
| ikev2 g^x  ea 7b 39 60  8a b1 a8 6e  f4 4b 81 54  3c 5b 77 2f
| emitting length of IKEv2 Key Exchange Payload: 264
| ***emit IKEv2 Nonce Payload:
|    next payload type: ISAKMP_NEXT_v2V
|    critical bit: Payload-Critical
| emitting 16 raw bytes of IKEv2 nonce into IKEv2 Nonce Payload
| IKEv2 nonce  22 91 12 b0  c2 41 9a 9a  2f 75 85 cc  3a 1e 1c 27
| emitting length of IKEv2 Nonce Payload: 20
| ***emit ISAKMP Vendor ID Payload:
|    next payload type: ISAKMP_NEXT_NONE
| emitting 12 raw bytes of Vendor ID into ISAKMP Vendor ID Payload
| Vendor ID  4f 45 71 6a  45 7f 70 51  5c 6b 70 4c
| emitting length of ISAKMP Vendor ID Payload: 16
| emitting length of ISAKMP Message: 732
| sending 732 bytes for ikev2_parent_outI1_tail through eth1:500 to 192.1.2.23:500 (using #1)
|   1d 56 aa 77  a7 e4 a2 b3  00 00 00 00  00 00 00 00
|   21 20 22 08  00 00 00 00  00 00 02 dc  22 80 01 94
|   02 00 00 28  01 01 00 04  03 00 00 08  01 00 00 0c
|   03 00 00 08  03 00 00 02  03 00 00 08  02 00 00 02
|   00 00 00 08  04 00 00 0e  02 00 00 28  02 01 00 04
|   03 00 00 08  01 00 00 0c  03 00 00 08  03 00 00 02
|   03 00 00 08  02 00 00 01  00 00 00 08  04 00 00 0e
|   02 00 00 28  03 01 00 04  03 00 00 08  01 00 00 03
|   03 00 00 08  03 00 00 02  03 00 00 08  02 00 00 02
|   00 00 00 08  04 00 00 0e  02 00 00 28  04 01 00 04
|   03 00 00 08  01 00 00 03  03 00 00 08  03 00 00 02
|   03 00 00 08  02 00 00 01  00 00 00 08  04 00 00 0e
|   02 00 00 28  05 01 00 04  03 00 00 08  01 00 00 0c
|   03 00 00 08  03 00 00 02  03 00 00 08  02 00 00 02
|   00 00 00 08  04 00 00 05  02 00 00 28  06 01 00 04
|   03 00 00 08  01 00 00 0c  03 00 00 08  03 00 00 02
|   03 00 00 08  02 00 00 01  00 00 00 08  04 00 00 05
|   02 00 00 28  07 01 00 04  03 00 00 08  01 00 00 03
|   03 00 00 08  03 00 00 02  03 00 00 08  02 00 00 02
|   00 00 00 08  04 00 00 05  02 00 00 28  08 01 00 04
|   03 00 00 08  01 00 00 03  03 00 00 08  03 00 00 02
|   03 00 00 08  02 00 00 01  00 00 00 08  04 00 00 05
|   02 00 00 28  09 01 00 04  03 00 00 08  01 00 00 03
|   03 00 00 08  03 00 00 02  03 00 00 08  02 00 00 02
|   00 00 00 08  04 00 00 02  00 00 00 28  0a 01 00 04
|   03 00 00 08  01 00 00 03  03 00 00 08  03 00 00 02
|   03 00 00 08  02 00 00 01  00 00 00 08  04 00 00 02
|   28 00 01 08  00 0e 00 00  11 a2 55 e4  76 51 88 07
|   03 9a da a5  f8 7c 84 c8  39 95 cd 28  c4 60 32 f2
|   1b 6a 78 72  8e 6b cc 06  82 24 c1 a4  33 af 01 53
|   21 99 b6 fe  e1 14 73 88  5e 23 c7 00  87 c8 20 91
|   a9 9a a1 30  7d cb 2a 3e  21 9a d3 7d  87 ec b5 dd
|   86 e4 1a 51  b6 a6 01 ef  03 89 d3 77  34 18 92 76
|   9c fa 57 be  ea 34 2a cd  eb 1f 8d 69  6a 86 28 03
|   6f 1f 3c d7  2f ee 84 eb  1c 9f 9e 56  90 68 98 14
|   62 b2 7b 76  d1 e8 36 be  55 fd 8d 18  18 a7 bb 60
|   30 d0 f5 e3  ed a2 e8 ea  11 fa bf 52  4b 2d be f2
|   da 18 d5 6f  92 1f 4a cc  51 77 a7 00  82 e0 8a 7b
|   21 f7 5b bd  0f 63 47 ea  86 5d b5 5e  39 bc 63 1b
|   62 66 e1 c4  44 fb b1 a1  9f 3b e2 79  c7 b8 14 0c
|   3a 17 7b d0  4c e8 1d f7  c8 39 a4 57  39 31 67 20
|   10 be dc f6  6f 97 47 cb  15 b0 42 8a  c4 08 b8 49
|   f5 4d 79 d6  8f 18 c6 19  ea 7b 39 60  8a b1 a8 6e
|   f4 4b 81 54  3c 5b 77 2f  2b 80 00 14  22 91 12 b0
|   c2 41 9a 9a  2f 75 85 cc  3a 1e 1c 27  00 00 00 10
|   4f 45 71 6a  45 7f 70 51  5c 6b 70 4c
| inserting event EVENT_RETRANSMIT, timeout in 10 seconds for #1
| complete v2 state transition with STF_OK
"westnet--eastnet-ikev2" #1: transition from state STATE_IKEv2_START to state STATE_PARENT_I1
"westnet--eastnet-ikev2" #1: STATE_PARENT_I1: sent v2I1, expected v2R1
| * processed 1 messages from cryptographic helpers 
| next event EVENT_SHUNT_SCAN in 118 seconds
|  
| *received 372 bytes from 192.1.2.23:500 on eth1 (port=500)
|   1d 56 aa 77  a7 e4 a2 b3  65 fc 37 f1  7e 24 da 76
|   21 20 22 20  00 00 00 00  00 00 01 74  22 80 00 2c
|   00 00 00 28  01 01 00 04  03 00 00 08  01 00 00 0c
|   03 00 00 08  03 00 00 02  03 00 00 08  02 00 00 02
|   00 00 00 08  04 00 00 0e  28 00 01 08  00 0e 00 00
|   0f 2d 6a 12  c9 f9 85 72  77 55 f9 b4  5b 9d 56 7b
|   b7 c3 d8 4a  65 32 78 e3  83 60 2f ab  75 d9 70 47
|   e5 98 b0 c0  77 ce 91 2d  21 83 25 67  a1 95 37 f7
|   78 59 90 90  6e 90 51 5d  c3 7e da f9  68 c8 49 61
|   6d 46 c7 d5  4b 86 d7 08  09 5f f6 01  f6 6b 15 5c
|   f7 7b 95 6e  87 72 9b c6  2d f7 d0 85  b8 5f d2 5e
|   20 0c 19 db  9c 7f 2f 98  5a 99 13 af  87 e4 0a 20
|   3a 51 d7 0d  50 0a 13 b9  4b c9 19 fb  73 07 6b f0
|   1e 81 30 73  05 be e1 a7  0a 5a 82 5c  fc 2b 61 bc
|   53 2b 05 64  0a 92 ef aa  02 8a f5 65  b0 87 66 af
|   1a 18 d5 3f  dd 0c 13 73  0c 76 e3 24  b7 f4 c0 2b
|   3c 91 e5 3f  d8 16 76 9d  ef 11 27 1e  71 94 51 a1
|   42 a1 1c 25  ad b1 c6 2f  10 07 e4 94  84 54 84 03
|   9d f2 c2 fa  21 49 d1 7c  de 17 cf 72  8d 99 65 43
|   f4 48 cf b1  79 dc 48 86  15 3f cb 0d  91 c0 89 8b
|   8b 4a 1b 87  75 30 d6 6d  f8 59 19 8a  15 3a 1a b0
|   2b 80 00 14  a2 e0 24 24  00 da 41 57  93 8d f1 ec
|   a4 5e 4d 1d  00 00 00 10  4f 45 71 6a  45 7f 70 51
|   5c 6b 70 4c
| **parse ISAKMP Message:
|    initiator cookie:
|   1d 56 aa 77  a7 e4 a2 b3
|    responder cookie:
|   65 fc 37 f1  7e 24 da 76
|    next payload type: ISAKMP_NEXT_v2SA
|    ISAKMP version: IKEv2 version 2.0 (rfc4306)
|    exchange type: ISAKMP_v2_SA_INIT
|    flags: ISAKMP_FLAG_RESPONSE
|    message ID:  00 00 00 00
|    length: 372
|  processing version=2.0 packet with exchange type=ISAKMP_v2_SA_INIT (34)
| ICOOKIE:  1d 56 aa 77  a7 e4 a2 b3
| RCOOKIE:  65 fc 37 f1  7e 24 da 76
| state hash entry 23
| v2 state object not found
| ICOOKIE:  1d 56 aa 77  a7 e4 a2 b3
| RCOOKIE:  00 00 00 00  00 00 00 00
| state hash entry 20
| v2 peer and cookies match on #1
| v2 state object #1 found, in STATE_PARENT_I1
| ICOOKIE:  1d 56 aa 77  a7 e4 a2 b3
| RCOOKIE:  00 00 00 00  00 00 00 00
| state hash entry 20
| ICOOKIE:  1d 56 aa 77  a7 e4 a2 b3
| RCOOKIE:  65 fc 37 f1  7e 24 da 76
| state hash entry 23
| inserting state object #1 on chain 23
| inserting event EVENT_SO_DISCARD, timeout in 0 seconds for #1
| ***parse IKEv2 Security Association Payload:
|    next payload type: ISAKMP_NEXT_v2KE
|    critical bit: Payload-Critical
|    length: 44
| processing payload: ISAKMP_NEXT_v2SA (len=44) 
| ***parse IKEv2 Key Exchange Payload:
|    next payload type: ISAKMP_NEXT_v2Ni
|    length: 264
|    transform type: 14
| processing payload: ISAKMP_NEXT_v2KE (len=264) 
| ***parse IKEv2 Nonce Payload:
|    next payload type: ISAKMP_NEXT_v2V
|    critical bit: Payload-Critical
|    length: 20
| processing payload: ISAKMP_NEXT_v2Ni (len=20) 
| ***parse IKEv2 Vendor ID Payload:
|    next payload type: ISAKMP_NEXT_NONE
|    critical bit: Payload-Non-Critical
|    length: 16
| processing payload: ISAKMP_NEXT_v2V (len=16) 
| ikev2 parent inR1: calculating g^{xy} in order to send I2
| DH public value received:
|   0f 2d 6a 12  c9 f9 85 72  77 55 f9 b4  5b 9d 56 7b
|   b7 c3 d8 4a  65 32 78 e3  83 60 2f ab  75 d9 70 47
|   e5 98 b0 c0  77 ce 91 2d  21 83 25 67  a1 95 37 f7
|   78 59 90 90  6e 90 51 5d  c3 7e da f9  68 c8 49 61
|   6d 46 c7 d5  4b 86 d7 08  09 5f f6 01  f6 6b 15 5c
|   f7 7b 95 6e  87 72 9b c6  2d f7 d0 85  b8 5f d2 5e
|   20 0c 19 db  9c 7f 2f 98  5a 99 13 af  87 e4 0a 20
|   3a 51 d7 0d  50 0a 13 b9  4b c9 19 fb  73 07 6b f0
|   1e 81 30 73  05 be e1 a7  0a 5a 82 5c  fc 2b 61 bc
|   53 2b 05 64  0a 92 ef aa  02 8a f5 65  b0 87 66 af
|   1a 18 d5 3f  dd 0c 13 73  0c 76 e3 24  b7 f4 c0 2b
|   3c 91 e5 3f  d8 16 76 9d  ef 11 27 1e  71 94 51 a1
|   42 a1 1c 25  ad b1 c6 2f  10 07 e4 94  84 54 84 03
|   9d f2 c2 fa  21 49 d1 7c  de 17 cf 72  8d 99 65 43
|   f4 48 cf b1  79 dc 48 86  15 3f cb 0d  91 c0 89 8b
|   8b 4a 1b 87  75 30 d6 6d  f8 59 19 8a  15 3a 1a b0
| ****parse IKEv2 Proposal Substructure Payload:
|    next payload type: ISAKMP_NEXT_NONE
|    length: 40
|    prop #: 1
|    proto ID: 1
|    spi size: 0
|    # transforms: 4
| *****parse IKEv2 Transform Substructure Payload:
|    next payload type: ISAKMP_NEXT_T
|    length: 8
|    transform type: 1
|    transform ID: 12
| *****parse IKEv2 Transform Substructure Payload:
|    next payload type: ISAKMP_NEXT_T
|    length: 8
|    transform type: 3
|    transform ID: 2
| *****parse IKEv2 Transform Substructure Payload:
|    next payload type: ISAKMP_NEXT_T
|    length: 8
|    transform type: 2
|    transform ID: 2
| *****parse IKEv2 Transform Substructure Payload:
|    next payload type: ISAKMP_NEXT_NONE
|    length: 8
|    transform type: 4
|    transform ID: 14
| calculating skeyseed using prf=prf-hmac-sha1 integ=auth-hmac-sha1-96 cipherkey=aes-cbc
| 0: w->pcw_dead: 0 w->pcw_work: 0 cnt: 1
| asking helper 0 to do compute dh(v2) op on seq: 2 (len=2668, pcw_work=1)
| crypto helper write of request: cnt=2668<wlen=2668.  
| inserting event EVENT_CRYPTO_FAILED, timeout in 300 seconds for #1
| complete v2 state transition with STF_SUSPEND
| * processed 0 messages from cryptographic helpers 
| next event EVENT_SHUNT_SCAN in 118 seconds
! helper 0 read 2664+4/2668 bytesfd: 7
! helper 0 doing compute dh(v2) op id: 2
! long term secret:   b9 b4 4c dc  cd c5 7e 65  ed 16 f1 0d  1c a2 7c 4c
! long term secret:   65 84 1c 69  d4 1e eb d5  59 b9 15 4c  bc 43 7b a0
! calc_dh_shared(): time elapsed (OAKLEY_GROUP_MODP2048): 5269 usec
! DH shared-secret:
!   ae c4 a2 04  3d aa b8 d1  aa 10 9c 0b  a3 d6 85 6b
!   56 e8 cb 88  3f 4f a2 c0  1e b1 01 86  45 4a ab 34
!   ee 8b fb 27  68 af a7 29  66 f9 7d c3  fb 5d 5d 04
!   63 76 31 05  88 21 ea cc  34 ad 77 b6  97 60 26 1d
!   b0 7a 4f 8c  4c 8e 2e fc  f6 c0 c0 ef  1f 60 1e b8
!   e0 02 fb 42  f3 73 5b 30  ca 6c da d6  53 e4 ee b4
!   a5 38 a4 8c  e1 ed a2 69  49 f5 ba 47  1a 6a d9 37
!   3e f8 65 8b  9a d7 5a fc  4c fc 0d 1a  6f 42 00 81
!   a8 43 26 6b  ef 20 11 34  a5 63 ae 66  d2 60 f3 2f
!   10 e3 6e 37  51 fd bb 4c  d5 c0 27 e0  b6 0a a7 f3
!   df 2a c5 96  39 78 ac ab  30 f1 ea 91  7e 1b f1 e0
!   5d 2e fe a1  55 74 4c 5a  1e 78 8c 18  7b 79 c6 70
!   06 4c 46 73  8f a1 4e 71  e6 df e9 b9  91 68 e1 d1
!   6d 21 b0 dc  d5 9b 2b c6  68 a5 f4 82  c4 1c a4 54
!   e3 ce ee 4e  2a d3 c6 92  1c 25 8c 0d  9c ca 9c de
!   ce 16 3a 0b  ff 32 34 37  22 ea 5e ef  b8 e2 7d 0d
! calculating skeyseed using prf=prf-hmac-sha1 integ=auth-hmac-sha1-96 cipherkey=16
! Input to SKEYSEED:   22 91 12 b0  c2 41 9a 9a  2f 75 85 cc  3a 1e 1c 27
! Input to SKEYSEED:   a2 e0 24 24  00 da 41 57  93 8d f1 ec  a4 5e 4d 1d
! PRF+ input
! Ni  22 91 12 b0  c2 41 9a 9a  2f 75 85 cc  3a 1e 1c 27
! Nr  a2 e0 24 24  00 da 41 57  93 8d f1 ec  a4 5e 4d 1d
! SPIi  1d 56 aa 77  a7 e4 a2 b3
! SPIr  65 fc 37 f1  7e 24 da 76
! prf+[1]:  ec 1b 3a fd  b7 30 07 d5  96 8d f7 43  a7 cb a3 2c
! prf+[1]:  27 36 04 e0
! prf+[2]:  0e ca 41 c6  12 3c 9b 14  c3 3a 6c ee  c1 31 b0 84
! prf+[2]:  36 d5 3e c3
! prf+[3]:  4d 08 b9 f8  40 37 a3 25  39 fb 39 ce  f3 73 31 53
! prf+[3]:  0e d8 45 d2
! prf+[4]:  3a 42 10 3f  c2 9f 53 b7  e0 d3 52 bb  9c 7f 4f be
! prf+[4]:  14 5d 81 3d
! prf+[5]:  14 3b c6 1b  90 3f 9e 2a  8b 08 5b cf  37 53 26 ba
! prf+[5]:  fb 58 63 fd
! prf+[6]:  f8 ba fc 6b  5d 42 3d 90  eb 80 6f ed  ff 54 d3 b0
! prf+[6]:  96 0a 91 4f
! prf+[7]:  45 ef 75 ed  06 72 60 c7  ff 3f 46 fb  c3 1d 6c 4f
! prf+[7]:  43 b1 64 23
! shared:    ae c4 a2 04  3d aa b8 d1  aa 10 9c 0b  a3 d6 85 6b
! shared:    56 e8 cb 88  3f 4f a2 c0  1e b1 01 86  45 4a ab 34
! shared:    ee 8b fb 27  68 af a7 29  66 f9 7d c3  fb 5d 5d 04
! shared:    63 76 31 05  88 21 ea cc  34 ad 77 b6  97 60 26 1d
! shared:    b0 7a 4f 8c  4c 8e 2e fc  f6 c0 c0 ef  1f 60 1e b8
! shared:    e0 02 fb 42  f3 73 5b 30  ca 6c da d6  53 e4 ee b4
! shared:    a5 38 a4 8c  e1 ed a2 69  49 f5 ba 47  1a 6a d9 37
! shared:    3e f8 65 8b  9a d7 5a fc  4c fc 0d 1a  6f 42 00 81
! shared:    a8 43 26 6b  ef 20 11 34  a5 63 ae 66  d2 60 f3 2f
! shared:    10 e3 6e 37  51 fd bb 4c  d5 c0 27 e0  b6 0a a7 f3
! shared:    df 2a c5 96  39 78 ac ab  30 f1 ea 91  7e 1b f1 e0
! shared:    5d 2e fe a1  55 74 4c 5a  1e 78 8c 18  7b 79 c6 70
! shared:    06 4c 46 73  8f a1 4e 71  e6 df e9 b9  91 68 e1 d1
! shared:    6d 21 b0 dc  d5 9b 2b c6  68 a5 f4 82  c4 1c a4 54
! shared:    e3 ce ee 4e  2a d3 c6 92  1c 25 8c 0d  9c ca 9c de
! shared:    ce 16 3a 0b  ff 32 34 37  22 ea 5e ef  b8 e2 7d 0d
! skeyseed:  98 aa d4 3b  7a 1a 9d 07  3a 95 fc 4e  a3 27 46 9d
! skeyseed:  4f 2b 12 18
! SK_d:  ec 1b 3a fd  b7 30 07 d5  96 8d f7 43  a7 cb a3 2c
! SK_d:  27 36 04 e0
! SK_ai:  0e ca 41 c6  12 3c 9b 14  c3 3a 6c ee  c1 31 b0 84
! SK_ai:  36 d5 3e c3
! SK_ar:  4d 08 b9 f8  40 37 a3 25  39 fb 39 ce  f3 73 31 53
! SK_ar:  0e d8 45 d2
! SK_ei:  3a 42 10 3f  c2 9f 53 b7  e0 d3 52 bb  9c 7f 4f be
! SK_er:  14 5d 81 3d  14 3b c6 1b  90 3f 9e 2a  8b 08 5b cf
! SK_pi:  37 53 26 ba  fb 58 63 fd  f8 ba fc 6b  5d 42 3d 90
! SK_pi:  eb 80 6f ed
! SK_pr:  ff 54 d3 b0  96 0a 91 4f  45 ef 75 ed  06 72 60 c7
! SK_pr:  ff 3f 46 fb
|  
| helper 0 has finished work (cnt now 1)
| helper 0 replies to id: q#2
| calling callback function 0x8076e2e
| ikev2 parent inR1outI1: calculating g^{xy}, sending I2
| processing connection westnet--eastnet-ikev2
| duplicating state object #1
| creating state object #2 at 0x8142c90
| ICOOKIE:  1d 56 aa 77  a7 e4 a2 b3
| RCOOKIE:  65 fc 37 f1  7e 24 da 76
| state hash entry 23
| inserting state object #2 on chain 23
| inserting event EVENT_SO_DISCARD, timeout in 0 seconds for #2
| **emit ISAKMP Message:
|    initiator cookie:
|   1d 56 aa 77  a7 e4 a2 b3
|    responder cookie:
|   65 fc 37 f1  7e 24 da 76
|    next payload type: ISAKMP_NEXT_v2E
|    ISAKMP version: IKEv2 version 2.0 (rfc4306)
|    exchange type: ISAKMP_v2_AUTH
|    flags: ISAKMP_FLAG_INIT
|    message ID:  00 00 00 01
| ***emit IKEv2 Encryption Payload:
|    next payload type: ISAKMP_NEXT_v2IDi
|    critical bit: Payload-Critical
| emitting 16 zero bytes of iv into IKEv2 Encryption Payload
| IKEv2 thinking whether to send my certificate:
|  my policy has no RSASIG, the policy is : PSK+ENCRYPT+TUNNEL+PFS+UP+!IKEv1+IKEv2ALLOW+IKEv2Init
|  sendcert: CERT_ALWAYSSEND and I did not get a certificate request 
|  so do not send cert.
| I did not send a certificate because digital signatures are not being used. (PSK)
| *****emit IKEv2 Identification Payload:
|    next payload type: ISAKMP_NEXT_v2AUTH
|    id_type: ID_FQDN
| emitting 4 raw bytes of my identity into IKEv2 Identification Payload
| my identity  77 65 73 74
| emitting length of IKEv2 Identification Payload: 12
| idhash calc pi  37 53 26 ba  fb 58 63 fd  f8 ba fc 6b  5d 42 3d 90
| idhash calc pi  eb 80 6f ed
| idhash calc I2  02 00 00 00  77 65 73 74
| *****emit IKEv2 Authentication Payload:
|    next payload type: ISAKMP_NEXT_v2SA
|    auth method: v2_AUTH_SHARED
| started looking for secret for @west->@east of kind PPK_PSK
| actually looking for secret for @west->@east of kind PPK_PSK
| line 1: key type PPK_PSK(@west) to type PPK_PSK 
| 1: compared key @east to @west / @east -> 2
| 2: compared key @west to @west / @east -> 6
| line 1: match=6 
| best_match 0>6 best=0x813f368 (line=1)
| concluding with best_match=6 best=0x813f368 (lineno=1)
| negotiated prf: oakley_sha hash length: 20
| inner prf ouput  32 1f 3f cb  b0 71 c5 e9  cf fb 04 98  9e 4d 6e e6
| inner prf ouput  e1 34 7b 93
| inputs to hash1 (first packet)
|   1d 56 aa 77  a7 e4 a2 b3  00 00 00 00  00 00 00 00
|   21 20 22 08  00 00 00 00  00 00 02 dc  22 80 01 94
|   02 00 00 28  01 01 00 04  03 00 00 08  01 00 00 0c
|   03 00 00 08  03 00 00 02  03 00 00 08  02 00 00 02
|   00 00 00 08  04 00 00 0e  02 00 00 28  02 01 00 04
|   03 00 00 08  01 00 00 0c  03 00 00 08  03 00 00 02
|   03 00 00 08  02 00 00 01  00 00 00 08  04 00 00 0e
|   02 00 00 28  03 01 00 04  03 00 00 08  01 00 00 03
|   03 00 00 08  03 00 00 02  03 00 00 08  02 00 00 02
|   00 00 00 08  04 00 00 0e  02 00 00 28  04 01 00 04
|   03 00 00 08  01 00 00 03  03 00 00 08  03 00 00 02
|   03 00 00 08  02 00 00 01  00 00 00 08  04 00 00 0e
|   02 00 00 28  05 01 00 04  03 00 00 08  01 00 00 0c
|   03 00 00 08  03 00 00 02  03 00 00 08  02 00 00 02
|   00 00 00 08  04 00 00 05  02 00 00 28  06 01 00 04
|   03 00 00 08  01 00 00 0c  03 00 00 08  03 00 00 02
|   03 00 00 08  02 00 00 01  00 00 00 08  04 00 00 05
|   02 00 00 28  07 01 00 04  03 00 00 08  01 00 00 03
|   03 00 00 08  03 00 00 02  03 00 00 08  02 00 00 02
|   00 00 00 08  04 00 00 05  02 00 00 28  08 01 00 04
|   03 00 00 08  01 00 00 03  03 00 00 08  03 00 00 02
|   03 00 00 08  02 00 00 01  00 00 00 08  04 00 00 05
|   02 00 00 28  09 01 00 04  03 00 00 08  01 00 00 03
|   03 00 00 08  03 00 00 02  03 00 00 08  02 00 00 02
|   00 00 00 08  04 00 00 02  00 00 00 28  0a 01 00 04
|   03 00 00 08  01 00 00 03  03 00 00 08  03 00 00 02
|   03 00 00 08  02 00 00 01  00 00 00 08  04 00 00 02
|   28 00 01 08  00 0e 00 00  11 a2 55 e4  76 51 88 07
|   03 9a da a5  f8 7c 84 c8  39 95 cd 28  c4 60 32 f2
|   1b 6a 78 72  8e 6b cc 06  82 24 c1 a4  33 af 01 53
|   21 99 b6 fe  e1 14 73 88  5e 23 c7 00  87 c8 20 91
|   a9 9a a1 30  7d cb 2a 3e  21 9a d3 7d  87 ec b5 dd
|   86 e4 1a 51  b6 a6 01 ef  03 89 d3 77  34 18 92 76
|   9c fa 57 be  ea 34 2a cd  eb 1f 8d 69  6a 86 28 03
|   6f 1f 3c d7  2f ee 84 eb  1c 9f 9e 56  90 68 98 14
|   62 b2 7b 76  d1 e8 36 be  55 fd 8d 18  18 a7 bb 60
|   30 d0 f5 e3  ed a2 e8 ea  11 fa bf 52  4b 2d be f2
|   da 18 d5 6f  92 1f 4a cc  51 77 a7 00  82 e0 8a 7b
|   21 f7 5b bd  0f 63 47 ea  86 5d b5 5e  39 bc 63 1b
|   62 66 e1 c4  44 fb b1 a1  9f 3b e2 79  c7 b8 14 0c
|   3a 17 7b d0  4c e8 1d f7  c8 39 a4 57  39 31 67 20
|   10 be dc f6  6f 97 47 cb  15 b0 42 8a  c4 08 b8 49
|   f5 4d 79 d6  8f 18 c6 19  ea 7b 39 60  8a b1 a8 6e
|   f4 4b 81 54  3c 5b 77 2f  2b 80 00 14  22 91 12 b0
|   c2 41 9a 9a  2f 75 85 cc  3a 1e 1c 27  00 00 00 10
|   4f 45 71 6a  45 7f 70 51  5c 6b 70 4c
| inputs to hash2 (responder nonce)
|   a2 e0 24 24  00 da 41 57  93 8d f1 ec  a4 5e 4d 1d
| idhash  cc 6c 95 26  ff c4 f5 17  8e 68 6b c9  50 55 16 da
| idhash  21 b9 e7 8b
| PSK auth octets  85 9e ca 5a  f5 16 d2 24  eb 97 5a dc  85 c8 fd bf
| PSK auth octets  d5 56 92 c6
| emitting 20 raw bytes of PSK auth into IKEv2 Authentication Payload
| PSK auth  85 9e ca 5a  f5 16 d2 24  eb 97 5a dc  85 c8 fd bf
| PSK auth  d5 56 92 c6
| emitting length of IKEv2 Authentication Payload: 28
| empty esp_info, returning defaults
| *****emit IKEv2 Security Association Payload:
|    next payload type: ISAKMP_NEXT_v2TSi
|    critical bit: Payload-Critical
| generate SPI:  d2 ef c0 71
| ******emit IKEv2 Proposal Substructure Payload:
|    next payload type: ISAKMP_NEXT_P
|    prop #: 1
|    proto ID: 3
|    spi size: 4
|    # transforms: 3
| emitting 4 raw bytes of our spi into IKEv2 Proposal Substructure Payload
| our spi  d2 ef c0 71
| *******emit IKEv2 Transform Substructure Payload:
|    next payload type: ISAKMP_NEXT_T
|    transform type: 1
|    transform ID: 12
| emitting length of IKEv2 Transform Substructure Payload: 8
| *******emit IKEv2 Transform Substructure Payload:
|    next payload type: ISAKMP_NEXT_T
|    transform type: 3
|    transform ID: 2
| emitting length of IKEv2 Transform Substructure Payload: 8
| *******emit IKEv2 Transform Substructure Payload:
|    next payload type: ISAKMP_NEXT_NONE
|    transform type: 5
|    transform ID: 0
| emitting length of IKEv2 Transform Substructure Payload: 8
| emitting length of IKEv2 Proposal Substructure Payload: 36
| ******emit IKEv2 Proposal Substructure Payload:
|    next payload type: ISAKMP_NEXT_P
|    prop #: 2
|    proto ID: 3
|    spi size: 4
|    # transforms: 3
| emitting 4 raw bytes of our spi into IKEv2 Proposal Substructure Payload
| our spi  d2 ef c0 71
| *******emit IKEv2 Transform Substructure Payload:
|    next payload type: ISAKMP_NEXT_T
|    transform type: 1
|    transform ID: 12
| emitting length of IKEv2 Transform Substructure Payload: 8
| *******emit IKEv2 Transform Substructure Payload:
|    next payload type: ISAKMP_NEXT_T
|    transform type: 3
|    transform ID: 2
| emitting length of IKEv2 Transform Substructure Payload: 8
| *******emit IKEv2 Transform Substructure Payload:
|    next payload type: ISAKMP_NEXT_NONE
|    transform type: 5
|    transform ID: 0
| emitting length of IKEv2 Transform Substructure Payload: 8
| emitting length of IKEv2 Proposal Substructure Payload: 36
| ******emit IKEv2 Proposal Substructure Payload:
|    next payload type: ISAKMP_NEXT_P
|    prop #: 3
|    proto ID: 3
|    spi size: 4
|    # transforms: 3
| emitting 4 raw bytes of our spi into IKEv2 Proposal Substructure Payload
| our spi  d2 ef c0 71
| *******emit IKEv2 Transform Substructure Payload:
|    next payload type: ISAKMP_NEXT_T
|    transform type: 1
|    transform ID: 3
| emitting length of IKEv2 Transform Substructure Payload: 8
| *******emit IKEv2 Transform Substructure Payload:
|    next payload type: ISAKMP_NEXT_T
|    transform type: 3
|    transform ID: 2
| emitting length of IKEv2 Transform Substructure Payload: 8
| *******emit IKEv2 Transform Substructure Payload:
|    next payload type: ISAKMP_NEXT_NONE
|    transform type: 5
|    transform ID: 0
| emitting length of IKEv2 Transform Substructure Payload: 8
| emitting length of IKEv2 Proposal Substructure Payload: 36
| ******emit IKEv2 Proposal Substructure Payload:
|    next payload type: ISAKMP_NEXT_NONE
|    prop #: 4
|    proto ID: 3
|    spi size: 4
|    # transforms: 3
| emitting 4 raw bytes of our spi into IKEv2 Proposal Substructure Payload
| our spi  d2 ef c0 71
| *******emit IKEv2 Transform Substructure Payload:
|    next payload type: ISAKMP_NEXT_T
|    transform type: 1
|    transform ID: 3
| emitting length of IKEv2 Transform Substructure Payload: 8
| *******emit IKEv2 Transform Substructure Payload:
|    next payload type: ISAKMP_NEXT_T
|    transform type: 3
|    transform ID: 2
| emitting length of IKEv2 Transform Substructure Payload: 8
| *******emit IKEv2 Transform Substructure Payload:
|    next payload type: ISAKMP_NEXT_NONE
|    transform type: 5
|    transform ID: 0
| emitting length of IKEv2 Transform Substructure Payload: 8
| emitting length of IKEv2 Proposal Substructure Payload: 36
| emitting length of IKEv2 Security Association Payload: 148
| *****emit IKEv2 Traffic Selectors:
|    next payload type: ISAKMP_NEXT_v2TSr
|    number of TS: 1
| ******emit IKEv2 Traffic Selectors:
|    TS type: ID_IPV4_ADDR_RANGE
|    IP Protocol ID: 0
|    start port: 0
|    end port: 65535
| emitting 4 raw bytes of ipv4 low into IKEv2 Traffic Selectors
| ipv4 low  c0 00 01 00
| emitting 4 raw bytes of ipv4 high into IKEv2 Traffic Selectors
| ipv4 high  c0 00 01 ff
| emitting length of IKEv2 Traffic Selectors: 16
| emitting length of IKEv2 Traffic Selectors: 24
| *****emit IKEv2 Traffic Selectors:
|    next payload type: ISAKMP_NEXT_NONE
|    number of TS: 1
| ******emit IKEv2 Traffic Selectors:
|    TS type: ID_IPV4_ADDR_RANGE
|    IP Protocol ID: 0
|    start port: 0
|    end port: 65535
| emitting 4 raw bytes of ipv4 low into IKEv2 Traffic Selectors
| ipv4 low  c0 00 02 00
| emitting 4 raw bytes of ipv4 high into IKEv2 Traffic Selectors
| ipv4 high  c0 00 02 ff
| emitting length of IKEv2 Traffic Selectors: 16
| emitting length of IKEv2 Traffic Selectors: 24
| emitting 4 raw bytes of padding and length into cleartext
| padding and length  00 01 02 03
| emitting 12 zero bytes of 96-bits of truncated HMAC into IKEv2 Encryption Payload
| emitting length of IKEv2 Encryption Payload: 272
| emitting length of ISAKMP Message: 300
| data before encryption:
|   27 00 00 0c  02 00 00 00  77 65 73 74  21 00 00 1c
|   02 00 00 00  85 9e ca 5a  f5 16 d2 24  eb 97 5a dc
|   85 c8 fd bf  d5 56 92 c6  2c 80 00 94  02 00 00 24
|   01 03 04 03  d2 ef c0 71  03 00 00 08  01 00 00 0c
|   03 00 00 08  03 00 00 02  00 00 00 08  05 00 00 00
|   02 00 00 24  02 03 04 03  d2 ef c0 71  03 00 00 08
|   01 00 00 0c  03 00 00 08  03 00 00 02  00 00 00 08
|   05 00 00 00  02 00 00 24  03 03 04 03  d2 ef c0 71
|   03 00 00 08  01 00 00 03  03 00 00 08  03 00 00 02
|   00 00 00 08  05 00 00 00  00 00 00 24  04 03 04 03
|   d2 ef c0 71  03 00 00 08  01 00 00 03  03 00 00 08
|   03 00 00 02  00 00 00 08  05 00 00 00  2d 00 00 18
|   01 00 00 00  07 00 00 10  00 00 ff ff  c0 00 01 00
|   c0 00 01 ff  00 00 00 18  01 00 00 00  07 00 00 10
|   00 00 ff ff  c0 00 02 00  c0 00 02 ff  00 01 02 03
| data after encryption:
|   93 e1 c4 80  8a a3 6b 6d  ee 24 45 51  9f 7b b8 98
|   35 bf e4 d0  b0 c2 45 9c  31 44 50 7f  7f 7c 24 4a
|   20 65 5c 6a  82 7a 8f 73  fd 75 21 cc  34 1b b6 ce
|   13 65 33 2c  f9 29 8e c9  a6 05 fa a5  6a 7b d0 5f
|   2c 1c b2 96  1f 2d 4e 9d  b0 e6 73 11  92 21 af b1
|   ae 7a f1 9f  39 01 30 c8  06 93 22 f5  49 13 ff 89
|   c2 55 91 17  b2 4e c7 1c  88 77 de 2d  31 97 1d d0
|   31 94 44 d4  76 88 ed 5a  59 d1 94 6c  ff a4 60 60
|   47 27 1d 82  89 40 4b 0a  2a 0c 90 ff  f2 0b d1 a4
|   87 a4 70 84  9c 7e ef 8f  34 db 7a 29  f6 eb 50 bf
|   ed 02 5b 23  74 b5 c8 ed  02 e3 1c e1  43 a3 d1 90
|   90 6a 94 7f  bd 48 8f b6  a1 dc bf a6  21 bc 59 22
|   3b 69 8d d2  20 45 8e 8c  ba a3 f5 d1  fa 41 99 33
|   e5 7d 12 a3  12 ab fb ad  80 03 6e d1  ab d5 53 d9
|   91 42 4b 11  75 31 9c 13  00 25 38 06  d7 f7 c5 72
| data being hmac:  1d 56 aa 77  a7 e4 a2 b3  65 fc 37 f1  7e 24 da 76
| data being hmac:  2e 20 23 08  00 00 00 01  00 00 01 2c  23 80 01 10
| data being hmac:  bc 09 64 fc  7f 1c 35 5b  18 7b 62 2d  5d c0 fb 68
| data being hmac:  93 e1 c4 80  8a a3 6b 6d  ee 24 45 51  9f 7b b8 98
| data being hmac:  35 bf e4 d0  b0 c2 45 9c  31 44 50 7f  7f 7c 24 4a
| data being hmac:  20 65 5c 6a  82 7a 8f 73  fd 75 21 cc  34 1b b6 ce
| data being hmac:  13 65 33 2c  f9 29 8e c9  a6 05 fa a5  6a 7b d0 5f
| data being hmac:  2c 1c b2 96  1f 2d 4e 9d  b0 e6 73 11  92 21 af b1
| data being hmac:  ae 7a f1 9f  39 01 30 c8  06 93 22 f5  49 13 ff 89
| data being hmac:  c2 55 91 17  b2 4e c7 1c  88 77 de 2d  31 97 1d d0
| data being hmac:  31 94 44 d4  76 88 ed 5a  59 d1 94 6c  ff a4 60 60
| data being hmac:  47 27 1d 82  89 40 4b 0a  2a 0c 90 ff  f2 0b d1 a4
| data being hmac:  87 a4 70 84  9c 7e ef 8f  34 db 7a 29  f6 eb 50 bf
| data being hmac:  ed 02 5b 23  74 b5 c8 ed  02 e3 1c e1  43 a3 d1 90
| data being hmac:  90 6a 94 7f  bd 48 8f b6  a1 dc bf a6  21 bc 59 22
| data being hmac:  3b 69 8d d2  20 45 8e 8c  ba a3 f5 d1  fa 41 99 33
| data being hmac:  e5 7d 12 a3  12 ab fb ad  80 03 6e d1  ab d5 53 d9
| data being hmac:  91 42 4b 11  75 31 9c 13  00 25 38 06  d7 f7 c5 72
| out calculated auth:
|   23 c3 6a a6  8a fe d8 10  8e 9d 48 83
| complete v2 state transition with STF_OK
"westnet--eastnet-ikev2" #2: transition from state STATE_PARENT_I1 to state STATE_PARENT_I2
"westnet--eastnet-ikev2" #2: STATE_PARENT_I2: sent v2I2, expected v2R2 {auth=IKEv2 cipher=aes_128 integ=sha1 prf=oakley_sha group=modp2048}
| sending reply packet to 192.1.2.23:500 (from port 500)
| sending 300 bytes for STATE_PARENT_I1 through eth1:500 to 192.1.2.23:500 (using #2)
|   1d 56 aa 77  a7 e4 a2 b3  65 fc 37 f1  7e 24 da 76
|   2e 20 23 08  00 00 00 01  00 00 01 2c  23 80 01 10
|   bc 09 64 fc  7f 1c 35 5b  18 7b 62 2d  5d c0 fb 68
|   93 e1 c4 80  8a a3 6b 6d  ee 24 45 51  9f 7b b8 98
|   35 bf e4 d0  b0 c2 45 9c  31 44 50 7f  7f 7c 24 4a
|   20 65 5c 6a  82 7a 8f 73  fd 75 21 cc  34 1b b6 ce
|   13 65 33 2c  f9 29 8e c9  a6 05 fa a5  6a 7b d0 5f
|   2c 1c b2 96  1f 2d 4e 9d  b0 e6 73 11  92 21 af b1
|   ae 7a f1 9f  39 01 30 c8  06 93 22 f5  49 13 ff 89
|   c2 55 91 17  b2 4e c7 1c  88 77 de 2d  31 97 1d d0
|   31 94 44 d4  76 88 ed 5a  59 d1 94 6c  ff a4 60 60
|   47 27 1d 82  89 40 4b 0a  2a 0c 90 ff  f2 0b d1 a4
|   87 a4 70 84  9c 7e ef 8f  34 db 7a 29  f6 eb 50 bf
|   ed 02 5b 23  74 b5 c8 ed  02 e3 1c e1  43 a3 d1 90
|   90 6a 94 7f  bd 48 8f b6  a1 dc bf a6  21 bc 59 22
|   3b 69 8d d2  20 45 8e 8c  ba a3 f5 d1  fa 41 99 33
|   e5 7d 12 a3  12 ab fb ad  80 03 6e d1  ab d5 53 d9
|   91 42 4b 11  75 31 9c 13  00 25 38 06  d7 f7 c5 72
|   23 c3 6a a6  8a fe d8 10  8e 9d 48 83
| * processed 1 messages from cryptographic helpers 
| next event EVENT_SHUNT_SCAN in 118 seconds
|  
| *received 204 bytes from 192.1.2.23:500 on eth1 (port=500)
|   1d 56 aa 77  a7 e4 a2 b3  65 fc 37 f1  7e 24 da 76
|   2e 20 23 20  00 00 00 01  00 00 00 cc  24 80 00 b0
|   49 af c7 e2  56 75 ad 5e  0c 12 46 5b  51 71 74 4e
|   bd 47 e8 6d  95 0f d2 8d  7f 38 5e 05  5b 3f 09 bf
|   ca 64 e7 ad  87 7b 73 c7  92 0f 28 67  bd 2a 9e 8a
|   c8 8e 5a b1  69 84 7e e9  50 86 72 06  d9 47 67 7d
|   b5 52 43 0a  c9 29 4a bd  ee d2 3d 88  39 95 4a c3
|   4d 50 04 98  48 03 c5 52  8c 3a 2b 27  fa c4 25 bb
|   28 04 6b 49  f6 32 2d bc  9b 7e 6c 25  c8 d6 51 98
|   ed 55 25 df  f5 aa 32 f9  cd 69 85 b2  3c 38 04 ca
|   ed d1 b0 b2  e1 6b e7 5a  3a 35 7f 89  5a 19 33 8a
|   7c e8 39 ad  68 39 a4 df  42 0e 8c f6  73 73 0a 31
|   be 4f c0 04  c6 5a 24 e1  42 8e 5e 4f
| **parse ISAKMP Message:
|    initiator cookie:
|   1d 56 aa 77  a7 e4 a2 b3
|    responder cookie:
|   65 fc 37 f1  7e 24 da 76
|    next payload type: ISAKMP_NEXT_v2E
|    ISAKMP version: IKEv2 version 2.0 (rfc4306)
|    exchange type: ISAKMP_v2_AUTH
|    flags: ISAKMP_FLAG_RESPONSE
|    message ID:  00 00 00 01
|    length: 204
|  processing version=2.0 packet with exchange type=ISAKMP_v2_AUTH (35)
| ICOOKIE:  1d 56 aa 77  a7 e4 a2 b3
| RCOOKIE:  65 fc 37 f1  7e 24 da 76
| state hash entry 23
| v2 peer, cookies and msgid match on #2
| v2 state object #2 found, in STATE_PARENT_I2
| ***parse IKEv2 Encryption Payload:
|    next payload type: ISAKMP_NEXT_v2IDr
|    critical bit: Payload-Critical
|    length: 176
| processing payload: ISAKMP_NEXT_v2E (len=176) 
| ikev2 parent inR2: calculating g^{xy} in order to decrypt I2
| data being hmac:  1d 56 aa 77  a7 e4 a2 b3  65 fc 37 f1  7e 24 da 76
| data being hmac:  2e 20 23 20  00 00 00 01  00 00 00 cc  24 80 00 b0
| data being hmac:  49 af c7 e2  56 75 ad 5e  0c 12 46 5b  51 71 74 4e
| data being hmac:  bd 47 e8 6d  95 0f d2 8d  7f 38 5e 05  5b 3f 09 bf
| data being hmac:  ca 64 e7 ad  87 7b 73 c7  92 0f 28 67  bd 2a 9e 8a
| data being hmac:  c8 8e 5a b1  69 84 7e e9  50 86 72 06  d9 47 67 7d
| data being hmac:  b5 52 43 0a  c9 29 4a bd  ee d2 3d 88  39 95 4a c3
| data being hmac:  4d 50 04 98  48 03 c5 52  8c 3a 2b 27  fa c4 25 bb
| data being hmac:  28 04 6b 49  f6 32 2d bc  9b 7e 6c 25  c8 d6 51 98
| data being hmac:  ed 55 25 df  f5 aa 32 f9  cd 69 85 b2  3c 38 04 ca
| data being hmac:  ed d1 b0 b2  e1 6b e7 5a  3a 35 7f 89  5a 19 33 8a
| data being hmac:  7c e8 39 ad  68 39 a4 df  42 0e 8c f6  73 73 0a 31
| R2 calculated auth:  be 4f c0 04  c6 5a 24 e1  42 8e 5e 4f
| R2  provided  auth:  be 4f c0 04  c6 5a 24 e1  42 8e 5e 4f
| authenticator matched
| data before decryption:
|   bd 47 e8 6d  95 0f d2 8d  7f 38 5e 05  5b 3f 09 bf
|   ca 64 e7 ad  87 7b 73 c7  92 0f 28 67  bd 2a 9e 8a
|   c8 8e 5a b1  69 84 7e e9  50 86 72 06  d9 47 67 7d
|   b5 52 43 0a  c9 29 4a bd  ee d2 3d 88  39 95 4a c3
|   4d 50 04 98  48 03 c5 52  8c 3a 2b 27  fa c4 25 bb
|   28 04 6b 49  f6 32 2d bc  9b 7e 6c 25  c8 d6 51 98
|   ed 55 25 df  f5 aa 32 f9  cd 69 85 b2  3c 38 04 ca
|   ed d1 b0 b2  e1 6b e7 5a  3a 35 7f 89  5a 19 33 8a
|   7c e8 39 ad  68 39 a4 df  42 0e 8c f6  73 73 0a 31
| decrypted payload:  27 00 00 0c  02 00 00 00  65 61 73 74  21 00 00 1c
| decrypted payload:  02 00 00 00  de 48 5b 76  35 7b 98 58  19 48 95 0b
| decrypted payload:  f8 0a 83 3c  ad 43 0b b4  2c 80 00 28  00 00 00 24
| decrypted payload:  01 03 04 03  09 26 0e f3  03 00 00 08  01 00 00 0c
| decrypted payload:  03 00 00 08  03 00 00 02  00 00 00 08  05 00 00 00
| decrypted payload:  2d 00 00 18  01 00 00 00  07 00 00 10  00 00 ff ff
| decrypted payload:  c0 00 01 00  c0 00 01 ff  00 00 00 18  01 00 00 00
| decrypted payload:  07 00 00 10  00 00 ff ff  c0 00 02 00  c0 00 02 ff
| decrypted payload:  00 01 02 03  04 05 06 07  08 09 0a 0b  0c 0d 0e 0f
| striping 16 bytes as pad
| **parse IKEv2 Identification Payload:
|    next payload type: ISAKMP_NEXT_v2AUTH
|    length: 12
|    id_type: ID_FQDN
| processing payload: ISAKMP_NEXT_v2IDr (len=12) 
| **parse IKEv2 Authentication Payload:
|    next payload type: ISAKMP_NEXT_v2SA
|    length: 28
|    auth method: v2_AUTH_SHARED
| processing payload: ISAKMP_NEXT_v2AUTH (len=28) 
| **parse IKEv2 Security Association Payload:
|    next payload type: ISAKMP_NEXT_v2TSi
|    critical bit: Payload-Critical
|    length: 40
| processing payload: ISAKMP_NEXT_v2SA (len=40) 
| **parse IKEv2 Traffic Selectors:
|    next payload type: ISAKMP_NEXT_v2TSr
|    length: 24
|    number of TS: 1
| processing payload: ISAKMP_NEXT_v2TSi (len=24) 
| **parse IKEv2 Traffic Selectors:
|    next payload type: ISAKMP_NEXT_NONE
|    length: 24
|    number of TS: 1
| processing payload: ISAKMP_NEXT_v2TSr (len=24) 
packet from 192.1.2.23:500: IKEv2 mode peer ID is ID_FQDN: '@east'
| idhash verify pr  ff 54 d3 b0  96 0a 91 4f  45 ef 75 ed  06 72 60 c7
| idhash verify pr  ff 3f 46 fb
| idhash auth R2  02 00 00 00  65 61 73 74
| started looking for secret for @west->@east of kind PPK_PSK
| actually looking for secret for @west->@east of kind PPK_PSK
| line 1: key type PPK_PSK(@west) to type PPK_PSK 
| 1: compared key @east to @west / @east -> 2
| 2: compared key @west to @west / @east -> 6
| line 1: match=6 
| best_match 0>6 best=0x813f368 (line=1)
| concluding with best_match=6 best=0x813f368 (lineno=1)
| negotiated prf: oakley_sha hash length: 20
| inner prf ouput  32 1f 3f cb  b0 71 c5 e9  cf fb 04 98  9e 4d 6e e6
| inner prf ouput  e1 34 7b 93
| inputs to hash1 (first packet)
|   1d 56 aa 77  a7 e4 a2 b3  65 fc 37 f1  7e 24 da 76
|   21 20 22 20  00 00 00 00  00 00 01 74  22 80 00 2c
|   00 00 00 28  01 01 00 04  03 00 00 08  01 00 00 0c
|   03 00 00 08  03 00 00 02  03 00 00 08  02 00 00 02
|   00 00 00 08  04 00 00 0e  28 00 01 08  00 0e 00 00
|   0f 2d 6a 12  c9 f9 85 72  77 55 f9 b4  5b 9d 56 7b
|   b7 c3 d8 4a  65 32 78 e3  83 60 2f ab  75 d9 70 47
|   e5 98 b0 c0  77 ce 91 2d  21 83 25 67  a1 95 37 f7
|   78 59 90 90  6e 90 51 5d  c3 7e da f9  68 c8 49 61
|   6d 46 c7 d5  4b 86 d7 08  09 5f f6 01  f6 6b 15 5c
|   f7 7b 95 6e  87 72 9b c6  2d f7 d0 85  b8 5f d2 5e
|   20 0c 19 db  9c 7f 2f 98  5a 99 13 af  87 e4 0a 20
|   3a 51 d7 0d  50 0a 13 b9  4b c9 19 fb  73 07 6b f0
|   1e 81 30 73  05 be e1 a7  0a 5a 82 5c  fc 2b 61 bc
|   53 2b 05 64  0a 92 ef aa  02 8a f5 65  b0 87 66 af
|   1a 18 d5 3f  dd 0c 13 73  0c 76 e3 24  b7 f4 c0 2b
|   3c 91 e5 3f  d8 16 76 9d  ef 11 27 1e  71 94 51 a1
|   42 a1 1c 25  ad b1 c6 2f  10 07 e4 94  84 54 84 03
|   9d f2 c2 fa  21 49 d1 7c  de 17 cf 72  8d 99 65 43
|   f4 48 cf b1  79 dc 48 86  15 3f cb 0d  91 c0 89 8b
|   8b 4a 1b 87  75 30 d6 6d  f8 59 19 8a  15 3a 1a b0
|   2b 80 00 14  a2 e0 24 24  00 da 41 57  93 8d f1 ec
|   a4 5e 4d 1d  00 00 00 10  4f 45 71 6a  45 7f 70 51
|   5c 6b 70 4c
| inputs to hash2 (initiator nonce)
|   22 91 12 b0  c2 41 9a 9a  2f 75 85 cc  3a 1e 1c 27
| idhash  f5 4f 6b 57  3f 34 58 a9  4f 20 63 f1  65 97 89 cb
| idhash  96 25 7b 14
| Received PSK auth octets
|   de 48 5b 76  35 7b 98 58  19 48 95 0b  f8 0a 83 3c
|   ad 43 0b b4
| Calculated PSK auth octets
|   de 48 5b 76  35 7b 98 58  19 48 95 0b  f8 0a 83 3c
|   ad 43 0b b4
| empty esp_info, returning defaults
| ***parse IKEv2 Proposal Substructure Payload:
|    next payload type: ISAKMP_NEXT_NONE
|    length: 36
|    prop #: 1
|    proto ID: 3
|    spi size: 4
|    # transforms: 3
| parsing 4 raw bytes of IKEv2 Proposal Substructure Payload into CHILD SA SPI
| CHILD SA SPI  09 26 0e f3
| SPI received: 09260ef3
| ****parse IKEv2 Transform Substructure Payload:
|    next payload type: ISAKMP_NEXT_T
|    length: 8
|    transform type: 1
|    transform ID: 12
| ****parse IKEv2 Transform Substructure Payload:
|    next payload type: ISAKMP_NEXT_T
|    length: 8
|    transform type: 3
|    transform ID: 2
| ****parse IKEv2 Transform Substructure Payload:
|    next payload type: ISAKMP_NEXT_NONE
|    length: 8
|    transform type: 5
|    transform ID: 0
| kernel_alg_esp_info():transid=12, auth=2, ei=0x812b6b4, enckeylen=16, authkeylen=20, encryptalg=12, authalg=3
| prf+[0]:  0c 28 75 b0  25 c2 fb ef  5c 65 1b 0f  ce db 6f 50
| prf+[0]:  ce a2 41 85
| prf+[1]:  47 44 c4 14  77 80 52 f6  cc 9a c4 72  72 e4 3f fb
| prf+[1]:  5a f7 e0 22
| prf+[2]:  cb 74 36 4f  6d ee 4d 92  9c 69 34 fd  79 96 a5 78
| prf+[2]:  76 95 d7 b8
| prf+[3]:  87 a4 85 c9  57 f0 6c a1  4f e1 58 b8  58 b5 c3 9b
| prf+[3]:  29 8b 7c 8e
| our  keymat  0c 28 75 b0  25 c2 fb ef  5c 65 1b 0f  ce db 6f 50
| our  keymat  ce a2 41 85  47 44 c4 14  77 80 52 f6  cc 9a c4 72
| our  keymat  72 e4 3f fb
| peer keymat  5a f7 e0 22  cb 74 36 4f  6d ee 4d 92  9c 69 34 fd
| peer keymat  79 96 a5 78  76 95 d7 b8  87 a4 85 c9  57 f0 6c a1
| peer keymat  4f e1 58 b8
| install_ipsec_sa() for #2: inbound and outbound
| route owner of "westnet--eastnet-ikev2" unrouted: NULL; eroute owner: NULL
| could_route called for westnet--eastnet-ikev2 (kind=CK_PERMANENT)
| pfkey_lib_debug:pfkey_msg_hdr_build: 
| pfkey_lib_debug:pfkey_msg_hdr_build: on_entry &pfkey_ext=0p0xbfbcdbf0 pfkey_ext=0p0xbfbcece4 *pfkey_ext=0p(nil). 
| pfkey_lib_debug:pfkey_msg_hdr_build: on_exit &pfkey_ext=0p0xbfbcdbf0 pfkey_ext=0p0xbfbcece4 *pfkey_ext=0p0x8143470. 
| pfkey_lib_debug:pfkey_sa_build: spi=00001001 replay=0 sa_state=1 auth=0 encrypt=0 flags=0 
| pfkey_lib_debug:pfkey_address_build: exttype=5 proto=0 prefixlen=0 
| pfkey_lib_debug:pfkey_address_build: found address family AF_INET. 
| pfkey_lib_debug:pfkey_address_build: found address=192.1.2.45:0. 
| pfkey_lib_debug:pfkey_address_build: successful created len: 3. 
| pfkey_lib_debug:pfkey_address_build: exttype=6 proto=0 prefixlen=0 
| pfkey_lib_debug:pfkey_address_build: found address family AF_INET. 
| pfkey_lib_debug:pfkey_address_build: found address=192.1.2.23:0. 
| pfkey_lib_debug:pfkey_address_build: successful created len: 3. 
| pfkey_lib_debug:pfkey_msg_build: pfkey_msg=0p0x81439b8 allocated 88 bytes, &(extensions[0])=0p0xbfbcece4 
| pfkey_lib_debug:pfkey_msg_build: copying 24 bytes from extensions[1] (type=1) 
| pfkey_lib_debug:pfkey_msg_build: copying 24 bytes from extensions[5] (type=5) 
| pfkey_lib_debug:pfkey_msg_build: copying 24 bytes from extensions[6] (type=6) 
| pfkey_lib_debug:pfkey_msg_build: extensions permitted=78001ffb, seen=00000063, required=00000063. 
| pfkey_lib_debug:pfkey_msg_parse: parsing message ver=2, type=3(add), errno=0, satype=9(IPIP), len=11, res=0, seq=5, pid=916. 
| pfkey_lib_debug:pfkey_msg_parse: satype 9(IPIP) conversion to proto gives 4 for msg_type 3(add). 
| pfkey_lib_debug:pfkey_msg_parse: remain=9 
| pfkey_lib_debug:pfkey_msg_parse: extensions permitted=78001ffb, required=00000063. 
| pfkey_lib_debug:pfkey_msg_parse: parsing ext type=1(security-association) remain=9. 
| pfkey_lib_debug:pfkey_msg_parse: remain=9 ext_type=1(security-association) ext_len=3 parsing ext 0p0x81439c8 with parser pfkey_sa_parse. 
| pfkey_lib_debug:pfkey_sa_parse: successfully found len=3 exttype=1(security-association) spi=00001001 replay=0 state=1 auth=0 encrypt=0 flags=0 ref=0. 
| pfkey_lib_debug:pfkey_msg_parse: Extension 1(security-association) parsed. 
| pfkey_lib_debug:pfkey_msg_parse: parsing ext type=5(source-address) remain=6. 
| pfkey_lib_debug:pfkey_msg_parse: remain=6 ext_type=5(source-address) ext_len=3 parsing ext 0p0x81439e0 with parser pfkey_address_parse. 
| pfkey_lib_debug:pfkey_address_parse: found exttype=5(source-address) family=2(AF_INET) address=192.1.2.45 proto=0 port=0. 
| pfkey_lib_debug:pfkey_address_parse: successful. 
| pfkey_lib_debug:pfkey_msg_parse: Extension 5(source-address) parsed. 
| pfkey_lib_debug:pfkey_msg_parse: parsing ext type=6(destination-address) remain=3. 
| pfkey_lib_debug:pfkey_msg_parse: remain=3 ext_type=6(destination-address) ext_len=3 parsing ext 0p0x81439f8 with parser pfkey_address_parse. 
| pfkey_lib_debug:pfkey_address_parse: found exttype=6(destination-address) family=2(AF_INET) address=192.1.2.23 proto=0 port=0. 
| pfkey_lib_debug:pfkey_address_parse: successful. 
| pfkey_lib_debug:pfkey_msg_parse: Extension 6(destination-address) parsed. 
| pfkey_lib_debug:pfkey_msg_parse: extensions permitted=78001ffb, seen=00000063, required=00000063. 
| finish_pfkey_msg: SADB_ADD message 5 for Add SA tun.1001@192.1.2.23
|   02 03 00 09  0b 00 00 00  05 00 00 00  94 03 00 00
|   03 00 01 00  00 00 10 01  00 01 00 00  00 00 00 00
|   00 00 00 00  00 00 00 00  03 00 05 00  00 00 00 00
|   02 00 00 00  c0 01 02 2d  00 00 00 00  00 00 00 00
|   03 00 06 00  00 00 00 00  02 00 00 00  c0 01 02 17
|   00 00 00 00  00 00 00 00
| pfkey_get: SADB_ADD message 5
| pfkey_lib_debug:pfkey_msg_parse: parsing message ver=2, type=3(add), errno=0, satype=9(IPIP), len=11, res=0, seq=5, pid=916. 
| pfkey_lib_debug:pfkey_msg_parse: satype 9(IPIP) conversion to proto gives 4 for msg_type 3(add). 
| pfkey_lib_debug:pfkey_msg_parse: remain=9 
| pfkey_lib_debug:pfkey_msg_parse: extensions permitted=78001ffb, required=00000063. 
| pfkey_lib_debug:pfkey_msg_parse: parsing ext type=1(security-association) remain=9. 
| pfkey_lib_debug:pfkey_msg_parse: remain=9 ext_type=1(security-association) ext_len=3 parsing ext 0p0xbfbcdcf4 with parser pfkey_sa_parse. 
| pfkey_lib_debug:pfkey_sa_parse: successfully found len=3 exttype=1(security-association) spi=00001001 replay=0 state=1 auth=0 encrypt=0 flags=0 ref=3. 
| pfkey_lib_debug:pfkey_msg_parse: Extension 1(security-association) parsed. 
| pfkey_lib_debug:pfkey_msg_parse: parsing ext type=5(source-address) remain=6. 
| pfkey_lib_debug:pfkey_msg_parse: remain=6 ext_type=5(source-address) ext_len=3 parsing ext 0p0xbfbcdd0c with parser pfkey_address_parse. 
| pfkey_lib_debug:pfkey_address_parse: found exttype=5(source-address) family=2(AF_INET) address=192.1.2.45 proto=0 port=0. 
| pfkey_lib_debug:pfkey_address_parse: successful. 
| pfkey_lib_debug:pfkey_msg_parse: Extension 5(source-address) parsed. 
| pfkey_lib_debug:pfkey_msg_parse: parsing ext type=6(destination-address) remain=3. 
| pfkey_lib_debug:pfkey_msg_parse: remain=3 ext_type=6(destination-address) ext_len=3 parsing ext 0p0xbfbcdd24 with parser pfkey_address_parse. 
| pfkey_lib_debug:pfkey_address_parse: found exttype=6(destination-address) family=2(AF_INET) address=192.1.2.23 proto=0 port=0. 
| pfkey_lib_debug:pfkey_address_parse: successful. 
| pfkey_lib_debug:pfkey_msg_parse: Extension 6(destination-address) parsed. 
| pfkey_lib_debug:pfkey_msg_parse: extensions permitted=78001ffb, seen=00000063, required=00000063. 
| added tunnel with ref=0
| recorded ref=0 as refhim
| looking for alg with transid: 12 keylen: 128 auth: 2 
| checking transid: 11 keylen: 0 auth: 1 
| checking transid: 11 keylen: 0 auth: 2 
| checking transid: 2 keylen: 8 auth: 0 
| checking transid: 2 keylen: 8 auth: 1 
| checking transid: 2 keylen: 8 auth: 2 
| checking transid: 3 keylen: 24 auth: 0 
| checking transid: 3 keylen: 24 auth: 1 
| checking transid: 3 keylen: 24 auth: 2 
| checking transid: 12 keylen: 16 auth: 0 
| checking transid: 12 keylen: 16 auth: 1 
| checking transid: 12 keylen: 16 auth: 2 
| pfkey_lib_debug:pfkey_msg_hdr_build: 
| pfkey_lib_debug:pfkey_msg_hdr_build: on_entry &pfkey_ext=0p0xbfbcdbf0 pfkey_ext=0p0xbfbcece4 *pfkey_ext=0p(nil). 
| pfkey_lib_debug:pfkey_msg_hdr_build: on_exit &pfkey_ext=0p0xbfbcdbf0 pfkey_ext=0p0xbfbcece4 *pfkey_ext=0p0x8143470. 
| pfkey_lib_debug:pfkey_sa_build: spi=09260ef3 replay=64 sa_state=1 auth=3 encrypt=12 flags=0 
| pfkey_lib_debug:pfkey_address_build: exttype=5 proto=0 prefixlen=0 
| pfkey_lib_debug:pfkey_address_build: found address family AF_INET. 
| pfkey_lib_debug:pfkey_address_build: found address=192.1.2.45:0. 
| pfkey_lib_debug:pfkey_address_build: successful created len: 3. 
| pfkey_lib_debug:pfkey_address_build: exttype=6 proto=0 prefixlen=0 
| pfkey_lib_debug:pfkey_address_build: found address family AF_INET. 
| pfkey_lib_debug:pfkey_address_build: found address=192.1.2.23:0. 
| pfkey_lib_debug:pfkey_address_build: successful created len: 3. 
| pfkey_lib_debug:pfkey_key_build: 
| pfkey_lib_debug:pfkey_key_build: 
| pfkey_lib_debug:pfkey_msg_build: pfkey_msg=0p0x81439e0 allocated 144 bytes, &(extensions[0])=0p0xbfbcece4 
| pfkey_lib_debug:pfkey_msg_build: copying 24 bytes from extensions[1] (type=1) 
| pfkey_lib_debug:pfkey_msg_build: copying 24 bytes from extensions[5] (type=5) 
| pfkey_lib_debug:pfkey_msg_build: copying 24 bytes from extensions[6] (type=6) 
| pfkey_lib_debug:pfkey_msg_build: copying 32 bytes from extensions[8] (type=8) 
| pfkey_lib_debug:pfkey_msg_build: copying 24 bytes from extensions[9] (type=9) 
| pfkey_lib_debug:pfkey_msg_build: extensions permitted=78001ffb, seen=00000363, required=00000063. 
| pfkey_lib_debug:pfkey_msg_parse: parsing message ver=2, type=3(add), errno=0, satype=3(ESP), len=18, res=0, seq=6, pid=916. 
| pfkey_lib_debug:pfkey_msg_parse: satype 3(ESP) conversion to proto gives 50 for msg_type 3(add). 
| pfkey_lib_debug:pfkey_msg_parse: remain=16 
| pfkey_lib_debug:pfkey_msg_parse: extensions permitted=78001ffb, required=00000063. 
| pfkey_lib_debug:pfkey_msg_parse: parsing ext type=1(security-association) remain=16. 
| pfkey_lib_debug:pfkey_msg_parse: remain=16 ext_type=1(security-association) ext_len=3 parsing ext 0p0x81439f0 with parser pfkey_sa_parse. 
| pfkey_lib_debug:pfkey_sa_parse: successfully found len=3 exttype=1(security-association) spi=09260ef3 replay=64 state=1 auth=3 encrypt=12 flags=0 ref=0. 
| pfkey_lib_debug:pfkey_msg_parse: Extension 1(security-association) parsed. 
| pfkey_lib_debug:pfkey_msg_parse: parsing ext type=5(source-address) remain=13. 
| pfkey_lib_debug:pfkey_msg_parse: remain=13 ext_type=5(source-address) ext_len=3 parsing ext 0p0x8143a08 with parser pfkey_address_parse. 
| pfkey_lib_debug:pfkey_address_parse: found exttype=5(source-address) family=2(AF_INET) address=192.1.2.45 proto=0 port=0. 
| pfkey_lib_debug:pfkey_address_parse: successful. 
| pfkey_lib_debug:pfkey_msg_parse: Extension 5(source-address) parsed. 
| pfkey_lib_debug:pfkey_msg_parse: parsing ext type=6(destination-address) remain=10. 
| pfkey_lib_debug:pfkey_msg_parse: remain=10 ext_type=6(destination-address) ext_len=3 parsing ext 0p0x8143a20 with parser pfkey_address_parse. 
| pfkey_lib_debug:pfkey_address_parse: found exttype=6(destination-address) family=2(AF_INET) address=192.1.2.23 proto=0 port=0. 
| pfkey_lib_debug:pfkey_address_parse: successful. 
| pfkey_lib_debug:pfkey_msg_parse: Extension 6(destination-address) parsed. 
| pfkey_lib_debug:pfkey_msg_parse: parsing ext type=8(authentication-key) remain=7. 
| pfkey_lib_debug:pfkey_msg_parse: remain=7 ext_type=8(authentication-key) ext_len=4 parsing ext 0p0x8143a38 with parser pfkey_key_parse. 
| pfkey_lib_debug:pfkey_key_parse: success, found len=4 exttype=8(authentication-key) bits=160 reserved=0. 
| pfkey_lib_debug:pfkey_msg_parse: Extension 8(authentication-key) parsed. 
| pfkey_lib_debug:pfkey_msg_parse: parsing ext type=9(cipher-key) remain=3. 
| pfkey_lib_debug:pfkey_msg_parse: remain=3 ext_type=9(cipher-key) ext_len=3 parsing ext 0p0x8143a58 with parser pfkey_key_parse. 
| pfkey_lib_debug:pfkey_key_parse: success, found len=3 exttype=9(cipher-key) bits=128 reserved=0. 
| pfkey_lib_debug:pfkey_msg_parse: Extension 9(cipher-key) parsed. 
| pfkey_lib_debug:pfkey_msg_parse: extensions permitted=78001ffb, seen=00000363, required=00000063. 
| finish_pfkey_msg: SADB_ADD message 6 for Add SA esp.9260ef3@192.1.2.23
|   02 03 00 03  12 00 00 00  06 00 00 00  94 03 00 00
|   03 00 01 00  09 26 0e f3  40 01 03 0c  00 00 00 00
|   00 00 00 00  00 00 00 00  03 00 05 00  00 00 00 00
|   02 00 00 00  c0 01 02 2d  00 00 00 00  00 00 00 00
|   03 00 06 00  00 00 00 00  02 00 00 00  c0 01 02 17
|   00 00 00 00  00 00 00 00  04 00 08 00  a0 00 00 00
|   79 96 a5 78  76 95 d7 b8  87 a4 85 c9  57 f0 6c a1
|   4f e1 58 b8  00 00 00 00  03 00 09 00  80 00 00 00
|   5a f7 e0 22  cb 74 36 4f  6d ee 4d 92  9c 69 34 fd
| pfkey_get: SADB_ADD message 6
| pfkey_lib_debug:pfkey_msg_parse: parsing message ver=2, type=3(add), errno=0, satype=3(ESP), len=11, res=0, seq=6, pid=916. 
| pfkey_lib_debug:pfkey_msg_parse: satype 3(ESP) conversion to proto gives 50 for msg_type 3(add). 
| pfkey_lib_debug:pfkey_msg_parse: remain=9 
| pfkey_lib_debug:pfkey_msg_parse: extensions permitted=78001ffb, required=00000063. 
| pfkey_lib_debug:pfkey_msg_parse: parsing ext type=1(security-association) remain=9. 
| pfkey_lib_debug:pfkey_msg_parse: remain=9 ext_type=1(security-association) ext_len=3 parsing ext 0p0xbfbcdcf4 with parser pfkey_sa_parse. 
| pfkey_lib_debug:pfkey_sa_parse: successfully found len=3 exttype=1(security-association) spi=09260ef3 replay=64 state=1 auth=3 encrypt=12 flags=0 ref=4. 
| pfkey_lib_debug:pfkey_msg_parse: Extension 1(security-association) parsed. 
| pfkey_lib_debug:pfkey_msg_parse: parsing ext type=5(source-address) remain=6. 
| pfkey_lib_debug:pfkey_msg_parse: remain=6 ext_type=5(source-address) ext_len=3 parsing ext 0p0xbfbcdd0c with parser pfkey_address_parse. 
| pfkey_lib_debug:pfkey_address_parse: found exttype=5(source-address) family=2(AF_INET) address=192.1.2.45 proto=0 port=0. 
| pfkey_lib_debug:pfkey_address_parse: successful. 
| pfkey_lib_debug:pfkey_msg_parse: Extension 5(source-address) parsed. 
| pfkey_lib_debug:pfkey_msg_parse: parsing ext type=6(destination-address) remain=3. 
| pfkey_lib_debug:pfkey_msg_parse: remain=3 ext_type=6(destination-address) ext_len=3 parsing ext 0p0xbfbcdd24 with parser pfkey_address_parse. 
| pfkey_lib_debug:pfkey_address_parse: found exttype=6(destination-address) family=2(AF_INET) address=192.1.2.23 proto=0 port=0. 
| pfkey_lib_debug:pfkey_address_parse: successful. 
| pfkey_lib_debug:pfkey_msg_parse: Extension 6(destination-address) parsed. 
| pfkey_lib_debug:pfkey_msg_parse: extensions permitted=78001ffb, seen=00000063, required=00000063. 
| grouping unk0.9260ef3@192.1.2.23 (ref=0) and unk0.1001@192.1.2.23 (ref=0)
| pfkey_lib_debug:pfkey_msg_hdr_build: 
| pfkey_lib_debug:pfkey_msg_hdr_build: on_entry &pfkey_ext=0p0xbfbceca0 pfkey_ext=0p0xbfbcecf4 *pfkey_ext=0p(nil). 
| pfkey_lib_debug:pfkey_msg_hdr_build: on_exit &pfkey_ext=0p0xbfbceca0 pfkey_ext=0p0xbfbcecf4 *pfkey_ext=0p0x8143470. 
| pfkey_lib_debug:pfkey_sa_build: spi=00001001 replay=0 sa_state=0 auth=0 encrypt=0 flags=0 
| pfkey_lib_debug:pfkey_address_build: exttype=6 proto=0 prefixlen=0 
| pfkey_lib_debug:pfkey_address_build: found address family AF_INET. 
| pfkey_lib_debug:pfkey_address_build: found address=192.1.2.23:0. 
| pfkey_lib_debug:pfkey_address_build: successful created len: 3. 
| pfkey_lib_debug:pfkey_x_satype_build: 
| pfkey_lib_debug:pfkey_sa_build: spi=09260ef3 replay=0 sa_state=0 auth=0 encrypt=0 flags=0 
| pfkey_lib_debug:pfkey_address_build: exttype=20 proto=0 prefixlen=0 
| pfkey_lib_debug:pfkey_address_build: found address family AF_INET. 
| pfkey_lib_debug:pfkey_address_build: found address=192.1.2.23:0. 
| pfkey_lib_debug:pfkey_address_build: successful created len: 3. 
| pfkey_lib_debug:pfkey_msg_build: pfkey_msg=0p0x81439b8 allocated 120 bytes, &(extensions[0])=0p0xbfbcecf4 
| pfkey_lib_debug:pfkey_msg_build: copying 24 bytes from extensions[1] (type=1) 
| pfkey_lib_debug:pfkey_msg_build: copying 24 bytes from extensions[6] (type=6) 
| pfkey_lib_debug:pfkey_msg_build: copying 8 bytes from extensions[18] (type=18) 
| pfkey_lib_debug:pfkey_msg_build: copying 24 bytes from extensions[19] (type=19) 
| pfkey_lib_debug:pfkey_msg_build: copying 24 bytes from extensions[20] (type=20) 
| pfkey_lib_debug:pfkey_msg_build: extensions permitted=001c0043, seen=001c0043, required=00000043. 
| pfkey_lib_debug:pfkey_msg_parse: parsing message ver=2, type=13(x-groupsa), errno=0, satype=9(IPIP), len=15, res=0, seq=7, pid=916. 
| pfkey_lib_debug:pfkey_msg_parse: satype 9(IPIP) conversion to proto gives 4 for msg_type 13(x-groupsa). 
| pfkey_lib_debug:pfkey_msg_parse: remain=13 
| pfkey_lib_debug:pfkey_msg_parse: extensions permitted=001c0043, required=00000043. 
| pfkey_lib_debug:pfkey_msg_parse: parsing ext type=1(security-association) remain=13. 
| pfkey_lib_debug:pfkey_msg_parse: remain=13 ext_type=1(security-association) ext_len=3 parsing ext 0p0x81439c8 with parser pfkey_sa_parse. 
| pfkey_lib_debug:pfkey_sa_parse: successfully found len=3 exttype=1(security-association) spi=00001001 replay=0 state=0 auth=0 encrypt=0 flags=0 ref=0. 
| pfkey_lib_debug:pfkey_msg_parse: Extension 1(security-association) parsed. 
| pfkey_lib_debug:pfkey_msg_parse: parsing ext type=6(destination-address) remain=10. 
| pfkey_lib_debug:pfkey_msg_parse: remain=10 ext_type=6(destination-address) ext_len=3 parsing ext 0p0x81439e0 with parser pfkey_address_parse. 
| pfkey_lib_debug:pfkey_address_parse: found exttype=6(destination-address) family=2(AF_INET) address=192.1.2.23 proto=0 port=0. 
| pfkey_lib_debug:pfkey_address_parse: successful. 
| pfkey_lib_debug:pfkey_msg_parse: Extension 6(destination-address) parsed. 
| pfkey_lib_debug:pfkey_msg_parse: parsing ext type=18(X-satype2) remain=7. 
| pfkey_lib_debug:pfkey_msg_parse: remain=7 ext_type=18(X-satype2) ext_len=1 parsing ext 0p0x81439f8 with parser pfkey_x_satype_parse. 
| pfkey_lib_debug:pfkey_x_satype_parse: enter 
| pfkey_lib_debug:pfkey_x_satype_parse: len=1 ext=18(X-satype2) satype=3(ESP) res=0,0,0. 
| pfkey_lib_debug:pfkey_msg_parse: Extension 18(X-satype2) parsed. 
| pfkey_lib_debug:pfkey_msg_parse: parsing ext type=19(X-security-association) remain=6. 
| pfkey_lib_debug:pfkey_msg_parse: remain=6 ext_type=19(X-security-association) ext_len=3 parsing ext 0p0x8143a00 with parser pfkey_sa_parse. 
| pfkey_lib_debug:pfkey_sa_parse: successfully found len=3 exttype=19(X-security-association) spi=09260ef3 replay=0 state=0 auth=0 encrypt=0 flags=0 ref=0. 
| pfkey_lib_debug:pfkey_msg_parse: Extension 19(X-security-association) parsed. 
| pfkey_lib_debug:pfkey_msg_parse: parsing ext type=20(X-destination-address2) remain=3. 
| pfkey_lib_debug:pfkey_msg_parse: remain=3 ext_type=20(X-destination-address2) ext_len=3 parsing ext 0p0x8143a18 with parser pfkey_address_parse. 
| pfkey_lib_debug:pfkey_address_parse: found exttype=20(X-destination-address2) family=2(AF_INET) address=192.1.2.23 proto=0 port=0. 
| pfkey_lib_debug:pfkey_address_parse: successful. 
| pfkey_lib_debug:pfkey_msg_parse: Extension 20(X-destination-address2) parsed. 
| pfkey_lib_debug:pfkey_msg_parse: extensions permitted=001c0043, seen=001c0043, required=00000043. 
| finish_pfkey_msg: K_SADB_X_GRPSA message 7 for group unk0.1001@192.1.2.23
|   02 0d 00 09  0f 00 00 00  07 00 00 00  94 03 00 00
|   03 00 01 00  00 00 10 01  00 00 00 00  00 00 00 00
|   00 00 00 00  00 00 00 00  03 00 06 00  00 00 00 00
|   02 00 00 00  c0 01 02 17  00 00 00 00  00 00 00 00
|   01 00 12 00  03 00 00 00  03 00 13 00  09 26 0e f3
|   00 00 00 00  00 00 00 00  00 00 00 00  00 00 00 00
|   03 00 14 00  00 00 00 00  02 00 00 00  c0 01 02 17
|   00 00 00 00  00 00 00 00
| pfkey_get: K_SADB_X_GRPSA message 7
| set up outoing SA, ref=0/4294901761
| pfkey_lib_debug:pfkey_msg_hdr_build: 
| pfkey_lib_debug:pfkey_msg_hdr_build: on_entry &pfkey_ext=0p0xbfbcdbf0 pfkey_ext=0p0xbfbcece4 *pfkey_ext=0p(nil). 
| pfkey_lib_debug:pfkey_msg_hdr_build: on_exit &pfkey_ext=0p0xbfbcdbf0 pfkey_ext=0p0xbfbcece4 *pfkey_ext=0p0x8143470. 
| pfkey_lib_debug:pfkey_sa_build: spi=00001002 replay=0 sa_state=1 auth=0 encrypt=0 flags=0 
| pfkey_lib_debug:pfkey_address_build: exttype=5 proto=0 prefixlen=0 
| pfkey_lib_debug:pfkey_address_build: found address family AF_INET. 
| pfkey_lib_debug:pfkey_address_build: found address=192.1.2.23:0. 
| pfkey_lib_debug:pfkey_address_build: successful created len: 3. 
| pfkey_lib_debug:pfkey_address_build: exttype=6 proto=0 prefixlen=0 
| pfkey_lib_debug:pfkey_address_build: found address family AF_INET. 
| pfkey_lib_debug:pfkey_address_build: found address=192.1.2.45:0. 
| pfkey_lib_debug:pfkey_address_build: successful created len: 3. 
| pfkey_lib_debug:pfkey_msg_build: pfkey_msg=0p0x8143998 allocated 88 bytes, &(extensions[0])=0p0xbfbcece4 
| pfkey_lib_debug:pfkey_msg_build: copying 24 bytes from extensions[1] (type=1) 
| pfkey_lib_debug:pfkey_msg_build: copying 24 bytes from extensions[5] (type=5) 
| pfkey_lib_debug:pfkey_msg_build: copying 24 bytes from extensions[6] (type=6) 
| pfkey_lib_debug:pfkey_msg_build: extensions permitted=78001ffb, seen=00000063, required=00000063. 
| pfkey_lib_debug:pfkey_msg_parse: parsing message ver=2, type=3(add), errno=0, satype=9(IPIP), len=11, res=0, seq=8, pid=916. 
| pfkey_lib_debug:pfkey_msg_parse: satype 9(IPIP) conversion to proto gives 4 for msg_type 3(add). 
| pfkey_lib_debug:pfkey_msg_parse: remain=9 
| pfkey_lib_debug:pfkey_msg_parse: extensions permitted=78001ffb, required=00000063. 
| pfkey_lib_debug:pfkey_msg_parse: parsing ext type=1(security-association) remain=9. 
| pfkey_lib_debug:pfkey_msg_parse: remain=9 ext_type=1(security-association) ext_len=3 parsing ext 0p0x81439a8 with parser pfkey_sa_parse. 
| pfkey_lib_debug:pfkey_sa_parse: successfully found len=3 exttype=1(security-association) spi=00001002 replay=0 state=1 auth=0 encrypt=0 flags=0 ref=0. 
| pfkey_lib_debug:pfkey_msg_parse: Extension 1(security-association) parsed. 
| pfkey_lib_debug:pfkey_msg_parse: parsing ext type=5(source-address) remain=6. 
| pfkey_lib_debug:pfkey_msg_parse: remain=6 ext_type=5(source-address) ext_len=3 parsing ext 0p0x81439c0 with parser pfkey_address_parse. 
| pfkey_lib_debug:pfkey_address_parse: found exttype=5(source-address) family=2(AF_INET) address=192.1.2.23 proto=0 port=0. 
| pfkey_lib_debug:pfkey_address_parse: successful. 
| pfkey_lib_debug:pfkey_msg_parse: Extension 5(source-address) parsed. 
| pfkey_lib_debug:pfkey_msg_parse: parsing ext type=6(destination-address) remain=3. 
| pfkey_lib_debug:pfkey_msg_parse: remain=3 ext_type=6(destination-address) ext_len=3 parsing ext 0p0x81439d8 with parser pfkey_address_parse. 
| pfkey_lib_debug:pfkey_address_parse: found exttype=6(destination-address) family=2(AF_INET) address=192.1.2.45 proto=0 port=0. 
| pfkey_lib_debug:pfkey_address_parse: successful. 
| pfkey_lib_debug:pfkey_msg_parse: Extension 6(destination-address) parsed. 
| pfkey_lib_debug:pfkey_msg_parse: extensions permitted=78001ffb, seen=00000063, required=00000063. 
| finish_pfkey_msg: SADB_ADD message 8 for Add SA tun.1002@192.1.2.23
|   02 03 00 09  0b 00 00 00  08 00 00 00  94 03 00 00
|   03 00 01 00  00 00 10 02  00 01 00 00  00 00 00 00
|   00 00 00 00  00 00 00 00  03 00 05 00  00 00 00 00
|   02 00 00 00  c0 01 02 17  00 00 00 00  00 00 00 00
|   03 00 06 00  00 00 00 00  02 00 00 00  c0 01 02 2d
|   00 00 00 00  00 00 00 00
| pfkey_get: SADB_ADD message 8
| pfkey_lib_debug:pfkey_msg_parse: parsing message ver=2, type=3(add), errno=0, satype=9(IPIP), len=11, res=0, seq=8, pid=916. 
| pfkey_lib_debug:pfkey_msg_parse: satype 9(IPIP) conversion to proto gives 4 for msg_type 3(add). 
| pfkey_lib_debug:pfkey_msg_parse: remain=9 
| pfkey_lib_debug:pfkey_msg_parse: extensions permitted=78001ffb, required=00000063. 
| pfkey_lib_debug:pfkey_msg_parse: parsing ext type=1(security-association) remain=9. 
| pfkey_lib_debug:pfkey_msg_parse: remain=9 ext_type=1(security-association) ext_len=3 parsing ext 0p0xbfbcdcf4 with parser pfkey_sa_parse. 
| pfkey_lib_debug:pfkey_sa_parse: successfully found len=3 exttype=1(security-association) spi=00001002 replay=0 state=1 auth=0 encrypt=0 flags=1 ref=5. 
| pfkey_lib_debug:pfkey_msg_parse: Extension 1(security-association) parsed. 
| pfkey_lib_debug:pfkey_msg_parse: parsing ext type=5(source-address) remain=6. 
| pfkey_lib_debug:pfkey_msg_parse: remain=6 ext_type=5(source-address) ext_len=3 parsing ext 0p0xbfbcdd0c with parser pfkey_address_parse. 
| pfkey_lib_debug:pfkey_address_parse: found exttype=5(source-address) family=2(AF_INET) address=192.1.2.23 proto=0 port=0. 
| pfkey_lib_debug:pfkey_address_parse: successful. 
| pfkey_lib_debug:pfkey_msg_parse: Extension 5(source-address) parsed. 
| pfkey_lib_debug:pfkey_msg_parse: parsing ext type=6(destination-address) remain=3. 
| pfkey_lib_debug:pfkey_msg_parse: remain=3 ext_type=6(destination-address) ext_len=3 parsing ext 0p0xbfbcdd24 with parser pfkey_address_parse. 
| pfkey_lib_debug:pfkey_address_parse: found exttype=6(destination-address) family=2(AF_INET) address=192.1.2.45 proto=0 port=0. 
| pfkey_lib_debug:pfkey_address_parse: successful. 
| pfkey_lib_debug:pfkey_msg_parse: Extension 6(destination-address) parsed. 
| pfkey_lib_debug:pfkey_msg_parse: extensions permitted=78001ffb, seen=00000063, required=00000063. 
| added tunnel with ref=0
| looking for alg with transid: 12 keylen: 128 auth: 2 
| checking transid: 11 keylen: 0 auth: 1 
| checking transid: 11 keylen: 0 auth: 2 
| checking transid: 2 keylen: 8 auth: 0 
| checking transid: 2 keylen: 8 auth: 1 
| checking transid: 2 keylen: 8 auth: 2 
| checking transid: 3 keylen: 24 auth: 0 
| checking transid: 3 keylen: 24 auth: 1 
| checking transid: 3 keylen: 24 auth: 2 
| checking transid: 12 keylen: 16 auth: 0 
| checking transid: 12 keylen: 16 auth: 1 
| checking transid: 12 keylen: 16 auth: 2 
| pfkey_lib_debug:pfkey_msg_hdr_build: 
| pfkey_lib_debug:pfkey_msg_hdr_build: on_entry &pfkey_ext=0p0xbfbcdbf0 pfkey_ext=0p0xbfbcece4 *pfkey_ext=0p(nil). 
| pfkey_lib_debug:pfkey_msg_hdr_build: on_exit &pfkey_ext=0p0xbfbcdbf0 pfkey_ext=0p0xbfbcece4 *pfkey_ext=0p0x8143470. 
| pfkey_lib_debug:pfkey_sa_build: spi=d2efc071 replay=64 sa_state=1 auth=3 encrypt=12 flags=0 
| pfkey_lib_debug:pfkey_address_build: exttype=5 proto=0 prefixlen=0 
| pfkey_lib_debug:pfkey_address_build: found address family AF_INET. 
| pfkey_lib_debug:pfkey_address_build: found address=192.1.2.23:0. 
| pfkey_lib_debug:pfkey_address_build: successful created len: 3. 
| pfkey_lib_debug:pfkey_address_build: exttype=6 proto=0 prefixlen=0 
| pfkey_lib_debug:pfkey_address_build: found address family AF_INET. 
| pfkey_lib_debug:pfkey_address_build: found address=192.1.2.45:0. 
| pfkey_lib_debug:pfkey_address_build: successful created len: 3. 
| pfkey_lib_debug:pfkey_key_build: 
| pfkey_lib_debug:pfkey_key_build: 
| pfkey_lib_debug:pfkey_msg_build: pfkey_msg=0p0x81439e0 allocated 144 bytes, &(extensions[0])=0p0xbfbcece4 
| pfkey_lib_debug:pfkey_msg_build: copying 24 bytes from extensions[1] (type=1) 
| pfkey_lib_debug:pfkey_msg_build: copying 24 bytes from extensions[5] (type=5) 
| pfkey_lib_debug:pfkey_msg_build: copying 24 bytes from extensions[6] (type=6) 
| pfkey_lib_debug:pfkey_msg_build: copying 32 bytes from extensions[8] (type=8) 
| pfkey_lib_debug:pfkey_msg_build: copying 24 bytes from extensions[9] (type=9) 
| pfkey_lib_debug:pfkey_msg_build: extensions permitted=78001ffb, seen=00000363, required=00000063. 
| pfkey_lib_debug:pfkey_msg_parse: parsing message ver=2, type=3(add), errno=0, satype=3(ESP), len=18, res=0, seq=9, pid=916. 
| pfkey_lib_debug:pfkey_msg_parse: satype 3(ESP) conversion to proto gives 50 for msg_type 3(add). 
| pfkey_lib_debug:pfkey_msg_parse: remain=16 
| pfkey_lib_debug:pfkey_msg_parse: extensions permitted=78001ffb, required=00000063. 
| pfkey_lib_debug:pfkey_msg_parse: parsing ext type=1(security-association) remain=16. 
| pfkey_lib_debug:pfkey_msg_parse: remain=16 ext_type=1(security-association) ext_len=3 parsing ext 0p0x81439f0 with parser pfkey_sa_parse. 
| pfkey_lib_debug:pfkey_sa_parse: successfully found len=3 exttype=1(security-association) spi=d2efc071 replay=64 state=1 auth=3 encrypt=12 flags=0 ref=0. 
| pfkey_lib_debug:pfkey_msg_parse: Extension 1(security-association) parsed. 
| pfkey_lib_debug:pfkey_msg_parse: parsing ext type=5(source-address) remain=13. 
| pfkey_lib_debug:pfkey_msg_parse: remain=13 ext_type=5(source-address) ext_len=3 parsing ext 0p0x8143a08 with parser pfkey_address_parse. 
| pfkey_lib_debug:pfkey_address_parse: found exttype=5(source-address) family=2(AF_INET) address=192.1.2.23 proto=0 port=0. 
| pfkey_lib_debug:pfkey_address_parse: successful. 
| pfkey_lib_debug:pfkey_msg_parse: Extension 5(source-address) parsed. 
| pfkey_lib_debug:pfkey_msg_parse: parsing ext type=6(destination-address) remain=10. 
| pfkey_lib_debug:pfkey_msg_parse: remain=10 ext_type=6(destination-address) ext_len=3 parsing ext 0p0x8143a20 with parser pfkey_address_parse. 
| pfkey_lib_debug:pfkey_address_parse: found exttype=6(destination-address) family=2(AF_INET) address=192.1.2.45 proto=0 port=0. 
| pfkey_lib_debug:pfkey_address_parse: successful. 
| pfkey_lib_debug:pfkey_msg_parse: Extension 6(destination-address) parsed. 
| pfkey_lib_debug:pfkey_msg_parse: parsing ext type=8(authentication-key) remain=7. 
| pfkey_lib_debug:pfkey_msg_parse: remain=7 ext_type=8(authentication-key) ext_len=4 parsing ext 0p0x8143a38 with parser pfkey_key_parse. 
| pfkey_lib_debug:pfkey_key_parse: success, found len=4 exttype=8(authentication-key) bits=160 reserved=0. 
| pfkey_lib_debug:pfkey_msg_parse: Extension 8(authentication-key) parsed. 
| pfkey_lib_debug:pfkey_msg_parse: parsing ext type=9(cipher-key) remain=3. 
| pfkey_lib_debug:pfkey_msg_parse: remain=3 ext_type=9(cipher-key) ext_len=3 parsing ext 0p0x8143a58 with parser pfkey_key_parse. 
| pfkey_lib_debug:pfkey_key_parse: success, found len=3 exttype=9(cipher-key) bits=128 reserved=0. 
| pfkey_lib_debug:pfkey_msg_parse: Extension 9(cipher-key) parsed. 
| pfkey_lib_debug:pfkey_msg_parse: extensions permitted=78001ffb, seen=00000363, required=00000063. 
| finish_pfkey_msg: SADB_ADD message 9 for Add SA esp.d2efc071@192.1.2.45
|   02 03 00 03  12 00 00 00  09 00 00 00  94 03 00 00
|   03 00 01 00  d2 ef c0 71  40 01 03 0c  00 00 00 00
|   00 00 00 00  00 00 00 00  03 00 05 00  00 00 00 00
|   02 00 00 00  c0 01 02 17  00 00 00 00  00 00 00 00
|   03 00 06 00  00 00 00 00  02 00 00 00  c0 01 02 2d
|   00 00 00 00  00 00 00 00  04 00 08 00  a0 00 00 00
|   ce a2 41 85  47 44 c4 14  77 80 52 f6  cc 9a c4 72
|   72 e4 3f fb  00 00 00 00  03 00 09 00  80 00 00 00
|   0c 28 75 b0  25 c2 fb ef  5c 65 1b 0f  ce db 6f 50
| pfkey_get: SADB_ADD message 9
| pfkey_lib_debug:pfkey_msg_parse: parsing message ver=2, type=3(add), errno=0, satype=3(ESP), len=11, res=0, seq=9, pid=916. 
| pfkey_lib_debug:pfkey_msg_parse: satype 3(ESP) conversion to proto gives 50 for msg_type 3(add). 
| pfkey_lib_debug:pfkey_msg_parse: remain=9 
| pfkey_lib_debug:pfkey_msg_parse: extensions permitted=78001ffb, required=00000063. 
| pfkey_lib_debug:pfkey_msg_parse: parsing ext type=1(security-association) remain=9. 
| pfkey_lib_debug:pfkey_msg_parse: remain=9 ext_type=1(security-association) ext_len=3 parsing ext 0p0xbfbcdcf4 with parser pfkey_sa_parse. 
| pfkey_lib_debug:pfkey_sa_parse: successfully found len=3 exttype=1(security-association) spi=d2efc071 replay=64 state=1 auth=3 encrypt=12 flags=1 ref=6. 
| pfkey_lib_debug:pfkey_msg_parse: Extension 1(security-association) parsed. 
| pfkey_lib_debug:pfkey_msg_parse: parsing ext type=5(source-address) remain=6. 
| pfkey_lib_debug:pfkey_msg_parse: remain=6 ext_type=5(source-address) ext_len=3 parsing ext 0p0xbfbcdd0c with parser pfkey_address_parse. 
| pfkey_lib_debug:pfkey_address_parse: found exttype=5(source-address) family=2(AF_INET) address=192.1.2.23 proto=0 port=0. 
| pfkey_lib_debug:pfkey_address_parse: successful. 
| pfkey_lib_debug:pfkey_msg_parse: Extension 5(source-address) parsed. 
| pfkey_lib_debug:pfkey_msg_parse: parsing ext type=6(destination-address) remain=3. 
| pfkey_lib_debug:pfkey_msg_parse: remain=3 ext_type=6(destination-address) ext_len=3 parsing ext 0p0xbfbcdd24 with parser pfkey_address_parse. 
| pfkey_lib_debug:pfkey_address_parse: found exttype=6(destination-address) family=2(AF_INET) address=192.1.2.45 proto=0 port=0. 
| pfkey_lib_debug:pfkey_address_parse: successful. 
| pfkey_lib_debug:pfkey_msg_parse: Extension 6(destination-address) parsed. 
| pfkey_lib_debug:pfkey_msg_parse: extensions permitted=78001ffb, seen=00000063, required=00000063. 
| add inbound eroute 192.0.2.0/24:0 --0-> 192.0.1.0/24:0 => tun.1002@192.1.2.45 (raw_eroute)
| pfkey_lib_debug:pfkey_msg_hdr_build: 
| pfkey_lib_debug:pfkey_msg_hdr_build: on_entry &pfkey_ext=0p0xbfbceac0 pfkey_ext=0p0xbfbceb9c *pfkey_ext=0p(nil). 
| pfkey_lib_debug:pfkey_msg_hdr_build: on_exit &pfkey_ext=0p0xbfbceac0 pfkey_ext=0p0xbfbceb9c *pfkey_ext=0p0x8143470. 
| pfkey_lib_debug:pfkey_sa_build: spi=00001002 replay=0 sa_state=0 auth=0 encrypt=0 flags=8 
| pfkey_lib_debug:pfkey_address_build: exttype=5 proto=0 prefixlen=0 
| pfkey_lib_debug:pfkey_address_build: found address family AF_INET. 
| pfkey_lib_debug:pfkey_address_build: found address=192.1.2.23:0. 
| pfkey_lib_debug:pfkey_address_build: successful created len: 3. 
| pfkey_lib_debug:pfkey_address_build: exttype=6 proto=0 prefixlen=0 
| pfkey_lib_debug:pfkey_address_build: found address family AF_INET. 
| pfkey_lib_debug:pfkey_address_build: found address=192.1.2.45:0. 
| pfkey_lib_debug:pfkey_address_build: successful created len: 3. 
| pfkey_lib_debug:pfkey_address_build: exttype=21 proto=0 prefixlen=0 
| pfkey_lib_debug:pfkey_address_build: found address family AF_INET. 
| pfkey_lib_debug:pfkey_address_build: found address=192.0.2.0:0. 
| pfkey_lib_debug:pfkey_address_build: successful created len: 3. 
| pfkey_lib_debug:pfkey_address_build: exttype=22 proto=0 prefixlen=0 
| pfkey_lib_debug:pfkey_address_build: found address family AF_INET. 
| pfkey_lib_debug:pfkey_address_build: found address=192.0.1.0:0. 
| pfkey_lib_debug:pfkey_address_build: successful created len: 3. 
| pfkey_lib_debug:pfkey_address_build: exttype=23 proto=0 prefixlen=0 
| pfkey_lib_debug:pfkey_address_build: found address family AF_INET. 
| pfkey_lib_debug:pfkey_address_build: found address=255.255.255.0:0. 
| pfkey_lib_debug:pfkey_address_build: successful created len: 3. 
| pfkey_lib_debug:pfkey_address_build: exttype=24 proto=0 prefixlen=0 
| pfkey_lib_debug:pfkey_address_build: found address family AF_INET. 
| pfkey_lib_debug:pfkey_address_build: found address=255.255.255.0:0. 
| pfkey_lib_debug:pfkey_address_build: successful created len: 3. 
| pfkey_lib_debug:pfkey_msg_build: pfkey_msg=0p0x8143a18 allocated 184 bytes, &(extensions[0])=0p0xbfbceb9c 
| pfkey_lib_debug:pfkey_msg_build: copying 24 bytes from extensions[1] (type=1) 
| pfkey_lib_debug:pfkey_msg_build: copying 24 bytes from extensions[5] (type=5) 
| pfkey_lib_debug:pfkey_msg_build: copying 24 bytes from extensions[6] (type=6) 
| pfkey_lib_debug:pfkey_msg_build: copying 24 bytes from extensions[21] (type=21) 
| pfkey_lib_debug:pfkey_msg_build: copying 24 bytes from extensions[22] (type=22) 
| pfkey_lib_debug:pfkey_msg_build: copying 24 bytes from extensions[23] (type=23) 
| pfkey_lib_debug:pfkey_msg_build: copying 24 bytes from extensions[24] (type=24) 
| pfkey_lib_debug:pfkey_msg_build: extensions permitted=05e00c63, seen=01e00063, required=01e00043. 
| pfkey_lib_debug:pfkey_msg_parse: parsing message ver=2, type=14(x-addflow(eroute)), errno=0, satype=9(IPIP), len=23, res=0, seq=10, pid=916. 
| pfkey_lib_debug:pfkey_msg_parse: satype 9(IPIP) conversion to proto gives 4 for msg_type 14(x-addflow(eroute)). 
| pfkey_lib_debug:pfkey_msg_parse: remain=21 
| pfkey_lib_debug:pfkey_msg_parse: extensions permitted=05e00c63, required=01e00043. 
| pfkey_lib_debug:pfkey_msg_parse: parsing ext type=1(security-association) remain=21. 
| pfkey_lib_debug:pfkey_msg_parse: remain=21 ext_type=1(security-association) ext_len=3 parsing ext 0p0x8143a28 with parser pfkey_sa_parse. 
| pfkey_lib_debug:pfkey_sa_parse: successfully found len=3 exttype=1(security-association) spi=00001002 replay=0 state=0 auth=0 encrypt=0 flags=8 ref=0. 
| pfkey_lib_debug:pfkey_msg_parse: Extension 1(security-association) parsed. 
| pfkey_lib_debug:pfkey_msg_parse: parsing ext type=5(source-address) remain=18. 
| pfkey_lib_debug:pfkey_msg_parse: remain=18 ext_type=5(source-address) ext_len=3 parsing ext 0p0x8143a40 with parser pfkey_address_parse. 
| pfkey_lib_debug:pfkey_address_parse: found exttype=5(source-address) family=2(AF_INET) address=192.1.2.23 proto=0 port=0. 
| pfkey_lib_debug:pfkey_address_parse: successful. 
| pfkey_lib_debug:pfkey_msg_parse: Extension 5(source-address) parsed. 
| pfkey_lib_debug:pfkey_msg_parse: parsing ext type=6(destination-address) remain=15. 
| pfkey_lib_debug:pfkey_msg_parse: remain=15 ext_type=6(destination-address) ext_len=3 parsing ext 0p0x8143a58 with parser pfkey_address_parse. 
| pfkey_lib_debug:pfkey_address_parse: found exttype=6(destination-address) family=2(AF_INET) address=192.1.2.45 proto=0 port=0. 
| pfkey_lib_debug:pfkey_address_parse: successful. 
| pfkey_lib_debug:pfkey_msg_parse: Extension 6(destination-address) parsed. 
| pfkey_lib_debug:pfkey_msg_parse: parsing ext type=21(X-source-flow-address) remain=12. 
| pfkey_lib_debug:pfkey_msg_parse: remain=12 ext_type=21(X-source-flow-address) ext_len=3 parsing ext 0p0x8143a70 with parser pfkey_address_parse. 
| pfkey_lib_debug:pfkey_address_parse: found exttype=21(X-source-flow-address) family=2(AF_INET) address=192.0.2.0 proto=0 port=0. 
| pfkey_lib_debug:pfkey_address_parse: successful. 
| pfkey_lib_debug:pfkey_msg_parse: Extension 21(X-source-flow-address) parsed. 
| pfkey_lib_debug:pfkey_msg_parse: parsing ext type=22(X-dest-flow-address) remain=9. 
| pfkey_lib_debug:pfkey_msg_parse: remain=9 ext_type=22(X-dest-flow-address) ext_len=3 parsing ext 0p0x8143a88 with parser pfkey_address_parse. 
| pfkey_lib_debug:pfkey_address_parse: found exttype=22(X-dest-flow-address) family=2(AF_INET) address=192.0.1.0 proto=0 port=0. 
| pfkey_lib_debug:pfkey_address_parse: successful. 
| pfkey_lib_debug:pfkey_msg_parse: Extension 22(X-dest-flow-address) parsed. 
| pfkey_lib_debug:pfkey_msg_parse: parsing ext type=23(X-source-mask) remain=6. 
| pfkey_lib_debug:pfkey_msg_parse: remain=6 ext_type=23(X-source-mask) ext_len=3 parsing ext 0p0x8143aa0 with parser pfkey_address_parse. 
| pfkey_lib_debug:pfkey_address_parse: found exttype=23(X-source-mask) family=2(AF_INET) address=255.255.255.0 proto=0 port=0. 
| pfkey_lib_debug:pfkey_address_parse: successful. 
| pfkey_lib_debug:pfkey_msg_parse: Extension 23(X-source-mask) parsed. 
| pfkey_lib_debug:pfkey_msg_parse: parsing ext type=24(X-dest-mask) remain=3. 
| pfkey_lib_debug:pfkey_msg_parse: remain=3 ext_type=24(X-dest-mask) ext_len=3 parsing ext 0p0x8143ab8 with parser pfkey_address_parse. 
| pfkey_lib_debug:pfkey_address_parse: found exttype=24(X-dest-mask) family=2(AF_INET) address=255.255.255.0 proto=0 port=0. 
| pfkey_lib_debug:pfkey_address_parse: successful. 
| pfkey_lib_debug:pfkey_msg_parse: Extension 24(X-dest-mask) parsed. 
| pfkey_lib_debug:pfkey_msg_parse: extensions permitted=05e00c63, seen=01e00063, required=01e00043. 
| finish_pfkey_msg: K_SADB_X_ADDFLOW message 10 for flow tun.1002@192.1.2.45
|   02 0e 00 09  17 00 00 00  0a 00 00 00  94 03 00 00
|   03 00 01 00  00 00 10 02  00 00 00 00  08 00 00 00
|   00 00 00 00  00 00 00 00  03 00 05 00  00 00 00 00
|   02 00 00 00  c0 01 02 17  00 00 00 00  00 00 00 00
|   03 00 06 00  00 00 00 00  02 00 00 00  c0 01 02 2d
|   00 00 00 00  00 00 00 00  03 00 15 00  00 00 00 00
|   02 00 00 00  c0 00 02 00  88 ad 07 08  b8 b0 07 08
|   03 00 16 00  00 00 00 00  02 00 00 00  c0 00 01 00
|   c8 91 07 08  48 af 07 08  03 00 17 00  00 00 00 00
|   02 00 00 00  ff ff ff 00  02 00 00 00  0a 00 00 00
|   03 00 18 00  00 00 00 00  02 00 00 00  ff ff ff 00
|   2a eb bc bf  68 eb bc bf
| pfkey_get: K_SADB_X_ADDFLOW message 10
| raw_eroute result=1 
| grouping unk0.d2efc071@192.1.2.45 (ref=0) and unk0.1002@192.1.2.45 (ref=0)
| pfkey_lib_debug:pfkey_msg_hdr_build: 
| pfkey_lib_debug:pfkey_msg_hdr_build: on_entry &pfkey_ext=0p0xbfbceca0 pfkey_ext=0p0xbfbcecf4 *pfkey_ext=0p(nil). 
| pfkey_lib_debug:pfkey_msg_hdr_build: on_exit &pfkey_ext=0p0xbfbceca0 pfkey_ext=0p0xbfbcecf4 *pfkey_ext=0p0x8143470. 
| pfkey_lib_debug:pfkey_sa_build: spi=00001002 replay=0 sa_state=0 auth=0 encrypt=0 flags=0 
| pfkey_lib_debug:pfkey_address_build: exttype=6 proto=0 prefixlen=0 
| pfkey_lib_debug:pfkey_address_build: found address family AF_INET. 
| pfkey_lib_debug:pfkey_address_build: found address=192.1.2.45:0. 
| pfkey_lib_debug:pfkey_address_build: successful created len: 3. 
| pfkey_lib_debug:pfkey_x_satype_build: 
| pfkey_lib_debug:pfkey_sa_build: spi=d2efc071 replay=0 sa_state=0 auth=0 encrypt=0 flags=0 
| pfkey_lib_debug:pfkey_address_build: exttype=20 proto=0 prefixlen=0 
| pfkey_lib_debug:pfkey_address_build: found address family AF_INET. 
| pfkey_lib_debug:pfkey_address_build: found address=192.1.2.45:0. 
| pfkey_lib_debug:pfkey_address_build: successful created len: 3. 
| pfkey_lib_debug:pfkey_msg_build: pfkey_msg=0p0x81439b8 allocated 120 bytes, &(extensions[0])=0p0xbfbcecf4 
| pfkey_lib_debug:pfkey_msg_build: copying 24 bytes from extensions[1] (type=1) 
| pfkey_lib_debug:pfkey_msg_build: copying 24 bytes from extensions[6] (type=6) 
| pfkey_lib_debug:pfkey_msg_build: copying 8 bytes from extensions[18] (type=18) 
| pfkey_lib_debug:pfkey_msg_build: copying 24 bytes from extensions[19] (type=19) 
| pfkey_lib_debug:pfkey_msg_build: copying 24 bytes from extensions[20] (type=20) 
| pfkey_lib_debug:pfkey_msg_build: extensions permitted=001c0043, seen=001c0043, required=00000043. 
| pfkey_lib_debug:pfkey_msg_parse: parsing message ver=2, type=13(x-groupsa), errno=0, satype=9(IPIP), len=15, res=0, seq=11, pid=916. 
| pfkey_lib_debug:pfkey_msg_parse: satype 9(IPIP) conversion to proto gives 4 for msg_type 13(x-groupsa). 
| pfkey_lib_debug:pfkey_msg_parse: remain=13 
| pfkey_lib_debug:pfkey_msg_parse: extensions permitted=001c0043, required=00000043. 
| pfkey_lib_debug:pfkey_msg_parse: parsing ext type=1(security-association) remain=13. 
| pfkey_lib_debug:pfkey_msg_parse: remain=13 ext_type=1(security-association) ext_len=3 parsing ext 0p0x81439c8 with parser pfkey_sa_parse. 
| pfkey_lib_debug:pfkey_sa_parse: successfully found len=3 exttype=1(security-association) spi=00001002 replay=0 state=0 auth=0 encrypt=0 flags=0 ref=0. 
| pfkey_lib_debug:pfkey_msg_parse: Extension 1(security-association) parsed. 
| pfkey_lib_debug:pfkey_msg_parse: parsing ext type=6(destination-address) remain=10. 
| pfkey_lib_debug:pfkey_msg_parse: remain=10 ext_type=6(destination-address) ext_len=3 parsing ext 0p0x81439e0 with parser pfkey_address_parse. 
| pfkey_lib_debug:pfkey_address_parse: found exttype=6(destination-address) family=2(AF_INET) address=192.1.2.45 proto=0 port=0. 
| pfkey_lib_debug:pfkey_address_parse: successful. 
| pfkey_lib_debug:pfkey_msg_parse: Extension 6(destination-address) parsed. 
| pfkey_lib_debug:pfkey_msg_parse: parsing ext type=18(X-satype2) remain=7. 
| pfkey_lib_debug:pfkey_msg_parse: remain=7 ext_type=18(X-satype2) ext_len=1 parsing ext 0p0x81439f8 with parser pfkey_x_satype_parse. 
| pfkey_lib_debug:pfkey_x_satype_parse: enter 
| pfkey_lib_debug:pfkey_x_satype_parse: len=1 ext=18(X-satype2) satype=3(ESP) res=0,0,0. 
| pfkey_lib_debug:pfkey_msg_parse: Extension 18(X-satype2) parsed. 
| pfkey_lib_debug:pfkey_msg_parse: parsing ext type=19(X-security-association) remain=6. 
| pfkey_lib_debug:pfkey_msg_parse: remain=6 ext_type=19(X-security-association) ext_len=3 parsing ext 0p0x8143a00 with parser pfkey_sa_parse. 
| pfkey_lib_debug:pfkey_sa_parse: successfully found len=3 exttype=19(X-security-association) spi=d2efc071 replay=0 state=0 auth=0 encrypt=0 flags=0 ref=0. 
| pfkey_lib_debug:pfkey_msg_parse: Extension 19(X-security-association) parsed. 
| pfkey_lib_debug:pfkey_msg_parse: parsing ext type=20(X-destination-address2) remain=3. 
| pfkey_lib_debug:pfkey_msg_parse: remain=3 ext_type=20(X-destination-address2) ext_len=3 parsing ext 0p0x8143a18 with parser pfkey_address_parse. 
| pfkey_lib_debug:pfkey_address_parse: found exttype=20(X-destination-address2) family=2(AF_INET) address=192.1.2.45 proto=0 port=0. 
| pfkey_lib_debug:pfkey_address_parse: successful. 
| pfkey_lib_debug:pfkey_msg_parse: Extension 20(X-destination-address2) parsed. 
| pfkey_lib_debug:pfkey_msg_parse: extensions permitted=001c0043, seen=001c0043, required=00000043. 
| finish_pfkey_msg: K_SADB_X_GRPSA message 11 for group unk0.1002@192.1.2.45
|   02 0d 00 09  0f 00 00 00  0b 00 00 00  94 03 00 00
|   03 00 01 00  00 00 10 02  00 00 00 00  00 00 00 00
|   00 00 00 00  00 00 00 00  03 00 06 00  00 00 00 00
|   02 00 00 00  c0 01 02 2d  00 00 00 00  00 00 00 00
|   01 00 12 00  03 00 00 00  03 00 13 00  d2 ef c0 71
|   00 00 00 00  00 00 00 00  00 00 00 00  00 00 00 00
|   03 00 14 00  00 00 00 00  02 00 00 00  c0 01 02 2d
|   00 00 00 00  00 00 00 00
| pfkey_get: K_SADB_X_GRPSA message 11
| set up incoming SA, ref=0/4294901761
| sr for #2: unrouted
| route owner of "westnet--eastnet-ikev2" unrouted: NULL; eroute owner: NULL
| route_and_eroute with c: westnet--eastnet-ikev2 (next: none) ero:null esr:{(nil)} ro:null rosr:{(nil)} and state: 2
| eroute_connection add eroute 192.0.1.0/24:0 --0-> 192.0.2.0/24:0 => tun.1001@192.1.2.23 (raw_eroute)
| pfkey_lib_debug:pfkey_msg_hdr_build: 
| pfkey_lib_debug:pfkey_msg_hdr_build: on_entry &pfkey_ext=0p0xbfbceb40 pfkey_ext=0p0xbfbcec1c *pfkey_ext=0p(nil). 
| pfkey_lib_debug:pfkey_msg_hdr_build: on_exit &pfkey_ext=0p0xbfbceb40 pfkey_ext=0p0xbfbcec1c *pfkey_ext=0p0x8143470. 
| pfkey_lib_debug:pfkey_sa_build: spi=00001001 replay=0 sa_state=0 auth=0 encrypt=0 flags=0 
| pfkey_lib_debug:pfkey_address_build: exttype=5 proto=0 prefixlen=0 
| pfkey_lib_debug:pfkey_address_build: found address family AF_INET. 
| pfkey_lib_debug:pfkey_address_build: found address=192.1.2.45:0. 
| pfkey_lib_debug:pfkey_address_build: successful created len: 3. 
| pfkey_lib_debug:pfkey_address_build: exttype=6 proto=0 prefixlen=0 
| pfkey_lib_debug:pfkey_address_build: found address family AF_INET. 
| pfkey_lib_debug:pfkey_address_build: found address=192.1.2.23:0. 
| pfkey_lib_debug:pfkey_address_build: successful created len: 3. 
| pfkey_lib_debug:pfkey_address_build: exttype=21 proto=0 prefixlen=0 
| pfkey_lib_debug:pfkey_address_build: found address family AF_INET. 
| pfkey_lib_debug:pfkey_address_build: found address=192.0.1.0:0. 
| pfkey_lib_debug:pfkey_address_build: successful created len: 3. 
| pfkey_lib_debug:pfkey_address_build: exttype=22 proto=0 prefixlen=0 
| pfkey_lib_debug:pfkey_address_build: found address family AF_INET. 
| pfkey_lib_debug:pfkey_address_build: found address=192.0.2.0:0. 
| pfkey_lib_debug:pfkey_address_build: successful created len: 3. 
| pfkey_lib_debug:pfkey_address_build: exttype=23 proto=0 prefixlen=0 
| pfkey_lib_debug:pfkey_address_build: found address family AF_INET. 
| pfkey_lib_debug:pfkey_address_build: found address=255.255.255.0:0. 
| pfkey_lib_debug:pfkey_address_build: successful created len: 3. 
| pfkey_lib_debug:pfkey_address_build: exttype=24 proto=0 prefixlen=0 
| pfkey_lib_debug:pfkey_address_build: found address family AF_INET. 
| pfkey_lib_debug:pfkey_address_build: found address=255.255.255.0:0. 
| pfkey_lib_debug:pfkey_address_build: successful created len: 3. 
| pfkey_lib_debug:pfkey_msg_build: pfkey_msg=0p0x8143a18 allocated 184 bytes, &(extensions[0])=0p0xbfbcec1c 
| pfkey_lib_debug:pfkey_msg_build: copying 24 bytes from extensions[1] (type=1) 
| pfkey_lib_debug:pfkey_msg_build: copying 24 bytes from extensions[5] (type=5) 
| pfkey_lib_debug:pfkey_msg_build: copying 24 bytes from extensions[6] (type=6) 
| pfkey_lib_debug:pfkey_msg_build: copying 24 bytes from extensions[21] (type=21) 
| pfkey_lib_debug:pfkey_msg_build: copying 24 bytes from extensions[22] (type=22) 
| pfkey_lib_debug:pfkey_msg_build: copying 24 bytes from extensions[23] (type=23) 
| pfkey_lib_debug:pfkey_msg_build: copying 24 bytes from extensions[24] (type=24) 
| pfkey_lib_debug:pfkey_msg_build: extensions permitted=05e00c63, seen=01e00063, required=01e00043. 
| pfkey_lib_debug:pfkey_msg_parse: parsing message ver=2, type=14(x-addflow(eroute)), errno=0, satype=9(IPIP), len=23, res=0, seq=12, pid=916. 
| pfkey_lib_debug:pfkey_msg_parse: satype 9(IPIP) conversion to proto gives 4 for msg_type 14(x-addflow(eroute)). 
| pfkey_lib_debug:pfkey_msg_parse: remain=21 
| pfkey_lib_debug:pfkey_msg_parse: extensions permitted=05e00c63, required=01e00043. 
| pfkey_lib_debug:pfkey_msg_parse: parsing ext type=1(security-association) remain=21. 
| pfkey_lib_debug:pfkey_msg_parse: remain=21 ext_type=1(security-association) ext_len=3 parsing ext 0p0x8143a28 with parser pfkey_sa_parse. 
| pfkey_lib_debug:pfkey_sa_parse: successfully found len=3 exttype=1(security-association) spi=00001001 replay=0 state=0 auth=0 encrypt=0 flags=0 ref=0. 
| pfkey_lib_debug:pfkey_msg_parse: Extension 1(security-association) parsed. 
| pfkey_lib_debug:pfkey_msg_parse: parsing ext type=5(source-address) remain=18. 
| pfkey_lib_debug:pfkey_msg_parse: remain=18 ext_type=5(source-address) ext_len=3 parsing ext 0p0x8143a40 with parser pfkey_address_parse. 
| pfkey_lib_debug:pfkey_address_parse: found exttype=5(source-address) family=2(AF_INET) address=192.1.2.45 proto=0 port=0. 
| pfkey_lib_debug:pfkey_address_parse: successful. 
| pfkey_lib_debug:pfkey_msg_parse: Extension 5(source-address) parsed. 
| pfkey_lib_debug:pfkey_msg_parse: parsing ext type=6(destination-address) remain=15. 
| pfkey_lib_debug:pfkey_msg_parse: remain=15 ext_type=6(destination-address) ext_len=3 parsing ext 0p0x8143a58 with parser pfkey_address_parse. 
| pfkey_lib_debug:pfkey_address_parse: found exttype=6(destination-address) family=2(AF_INET) address=192.1.2.23 proto=0 port=0. 
| pfkey_lib_debug:pfkey_address_parse: successful. 
| pfkey_lib_debug:pfkey_msg_parse: Extension 6(destination-address) parsed. 
| pfkey_lib_debug:pfkey_msg_parse: parsing ext type=21(X-source-flow-address) remain=12. 
| pfkey_lib_debug:pfkey_msg_parse: remain=12 ext_type=21(X-source-flow-address) ext_len=3 parsing ext 0p0x8143a70 with parser pfkey_address_parse. 
| pfkey_lib_debug:pfkey_address_parse: found exttype=21(X-source-flow-address) family=2(AF_INET) address=192.0.1.0 proto=0 port=0. 
| pfkey_lib_debug:pfkey_address_parse: successful. 
| pfkey_lib_debug:pfkey_msg_parse: Extension 21(X-source-flow-address) parsed. 
| pfkey_lib_debug:pfkey_msg_parse: parsing ext type=22(X-dest-flow-address) remain=9. 
| pfkey_lib_debug:pfkey_msg_parse: remain=9 ext_type=22(X-dest-flow-address) ext_len=3 parsing ext 0p0x8143a88 with parser pfkey_address_parse. 
| pfkey_lib_debug:pfkey_address_parse: found exttype=22(X-dest-flow-address) family=2(AF_INET) address=192.0.2.0 proto=0 port=0. 
| pfkey_lib_debug:pfkey_address_parse: successful. 
| pfkey_lib_debug:pfkey_msg_parse: Extension 22(X-dest-flow-address) parsed. 
| pfkey_lib_debug:pfkey_msg_parse: parsing ext type=23(X-source-mask) remain=6. 
| pfkey_lib_debug:pfkey_msg_parse: remain=6 ext_type=23(X-source-mask) ext_len=3 parsing ext 0p0x8143aa0 with parser pfkey_address_parse. 
| pfkey_lib_debug:pfkey_address_parse: found exttype=23(X-source-mask) family=2(AF_INET) address=255.255.255.0 proto=0 port=0. 
| pfkey_lib_debug:pfkey_address_parse: successful. 
| pfkey_lib_debug:pfkey_msg_parse: Extension 23(X-source-mask) parsed. 
| pfkey_lib_debug:pfkey_msg_parse: parsing ext type=24(X-dest-mask) remain=3. 
| pfkey_lib_debug:pfkey_msg_parse: remain=3 ext_type=24(X-dest-mask) ext_len=3 parsing ext 0p0x8143ab8 with parser pfkey_address_parse. 
| pfkey_lib_debug:pfkey_address_parse: found exttype=24(X-dest-mask) family=2(AF_INET) address=255.255.255.0 proto=0 port=0. 
| pfkey_lib_debug:pfkey_address_parse: successful. 
| pfkey_lib_debug:pfkey_msg_parse: Extension 24(X-dest-mask) parsed. 
| pfkey_lib_debug:pfkey_msg_parse: extensions permitted=05e00c63, seen=01e00063, required=01e00043. 
| finish_pfkey_msg: K_SADB_X_ADDFLOW message 12 for flow tun.1001@192.1.2.23
|   02 0e 00 09  17 00 00 00  0c 00 00 00  94 03 00 00
|   03 00 01 00  00 00 10 01  00 00 00 00  00 00 00 00
|   00 00 00 00  00 00 00 00  03 00 05 00  00 00 00 00
|   02 00 00 00  c0 01 02 2d  00 00 00 00  00 00 00 00
|   03 00 06 00  00 00 00 00  02 00 00 00  c0 01 02 17
|   00 00 00 00  00 00 00 00  03 00 15 00  00 00 00 00
|   02 00 00 00  c0 00 01 00  c8 91 07 08  48 af 07 08
|   03 00 16 00  00 00 00 00  02 00 00 00  c0 00 02 00
|   88 ad 07 08  b8 b0 07 08  03 00 17 00  00 00 00 00
|   02 00 00 00  ff ff ff 00  02 00 00 00  0a 00 00 00
|   03 00 18 00  00 00 00 00  02 00 00 00  ff ff ff 00
|   aa eb bc bf  e8 eb bc bf
| pfkey_get: K_SADB_X_ADDFLOW message 12
| raw_eroute result=1 
| command executing up-client
| executing up-client: 2>&1 PLUTO_VERB='up-client' PLUTO_VERSION='2.0' PLUTO_CONNECTION='westnet--eastnet-ikev2' PLUTO_INTERFACE='ipsec0' PLUTO_NEXT_HOP='192.1.2.23' PLUTO_ME='192.1.2.45' PLUTO_MY_ID='@west' PLUTO_MY_CLIENT='192.0.1.0/24' PLUTO_MY_CLIENT_NET='192.0.1.0' PLUTO_MY_CLIENT_MASK='255.255.255.0' PLUTO_MY_PORT='0' PLUTO_MY_PROTOCOL='0' PLUTO_PEER='192.1.2.23' PLUTO_PEER_ID='@east' PLUTO_PEER_CLIENT='192.0.2.0/24' PLUTO_PEER_CLIENT_NET='192.0.2.0' PLUTO_PEER_CLIENT_MASK='255.255.255.0' PLUTO_PEER_PORT='0' PLUTO_PEER_PROTOCOL='0' PLUTO_PEER_CA='' PLUTO_STACK='klips' PLUTO_CONN_POLICY='PSK+ENCRYPT+TUNNEL+PFS+UP+!IKEv1+IKEv2ALLOW+IKEv2Init' PLUTO_XAUTH_USERNAME=''  ipsec _updown
| route_and_eroute: firewall_notified: true
| command executing prepare-client
| executing prepare-client: 2>&1 PLUTO_VERB='prepare-client' PLUTO_VERSION='2.0' PLUTO_CONNECTION='westnet--eastnet-ikev2' PLUTO_INTERFACE='ipsec0' PLUTO_NEXT_HOP='192.1.2.23' PLUTO_ME='192.1.2.45' PLUTO_MY_ID='@west' PLUTO_MY_CLIENT='192.0.1.0/24' PLUTO_MY_CLIENT_NET='192.0.1.0' PLUTO_MY_CLIENT_MASK='255.255.255.0' PLUTO_MY_PORT='0' PLUTO_MY_PROTOCOL='0' PLUTO_PEER='192.1.2.23' PLUTO_PEER_ID='@east' PLUTO_PEER_CLIENT='192.0.2.0/24' PLUTO_PEER_CLIENT_NET='192.0.2.0' PLUTO_PEER_CLIENT_MASK='255.255.255.0' PLUTO_PEER_PORT='0' PLUTO_PEER_PROTOCOL='0' PLUTO_PEER_CA='' PLUTO_STACK='klips' PLUTO_CONN_POLICY='PSK+ENCRYPT+TUNNEL+PFS+UP+!IKEv1+IKEv2ALLOW+IKEv2Init' PLUTO_XAUTH_USERNAME=''  ipsec _updown
| command executing route-client
| executing route-client: 2>&1 PLUTO_VERB='route-client' PLUTO_VERSION='2.0' PLUTO_CONNECTION='westnet--eastnet-ikev2' PLUTO_INTERFACE='ipsec0' PLUTO_NEXT_HOP='192.1.2.23' PLUTO_ME='192.1.2.45' PLUTO_MY_ID='@west' PLUTO_MY_CLIENT='192.0.1.0/24' PLUTO_MY_CLIENT_NET='192.0.1.0' PLUTO_MY_CLIENT_MASK='255.255.255.0' PLUTO_MY_PORT='0' PLUTO_MY_PROTOCOL='0' PLUTO_PEER='192.1.2.23' PLUTO_PEER_ID='@east' PLUTO_PEER_CLIENT='192.0.2.0/24' PLUTO_PEER_CLIENT_NET='192.0.2.0' PLUTO_PEER_CLIENT_MASK='255.255.255.0' PLUTO_PEER_PORT='0' PLUTO_PEER_PROTOCOL='0' PLUTO_PEER_CA='' PLUTO_STACK='klips' PLUTO_CONN_POLICY='PSK+ENCRYPT+TUNNEL+PFS+UP+!IKEv1+IKEv2ALLOW+IKEv2Init' PLUTO_XAUTH_USERNAME=''  ipsec _updown
| route_and_eroute: instance "westnet--eastnet-ikev2", setting eroute_owner {spd=0x813ff98,sr=0x813ff98} to #2 (was #0) (newest_ipsec_sa=#2)
| complete v2 state transition with STF_OK
"westnet--eastnet-ikev2" #2: transition from state STATE_PARENT_I2 to state STATE_PARENT_I3
"westnet--eastnet-ikev2" #2: negotiated tunnel [192.0.1.0,192.0.1.255] -> [192.0.2.0,192.0.2.255]
"westnet--eastnet-ikev2" #2: STATE_PARENT_I3: PARENT SA established tunnel mode {ESP=>0x09260ef3 <0xd2efc071 xfrm=AES_128-HMAC_SHA1 NATOA=none NATD=none DPD=none}
| releasing whack for #2 (sock=15)
| releasing whack for #1 (sock=14)
| * processed 0 messages from cryptographic helpers 
| next event EVENT_SHUNT_SCAN in 117 seconds
|  
| *received whack message
| * processed 0 messages from cryptographic helpers 
| next event EVENT_SHUNT_SCAN in 104 seconds
west:~# : ==== tuc ====
west:~# if [ -f /tmp/core ]; then echo CORE FOUND; mv /tmp/core /var/tmp; fi
west:~# : ==== end ====
west:~# ipsec setup stop
IPSEC EVENT: KLIPS device ipsec0 shut down.
ipsec_setup: Stopping Openswan IPsec...
west:~# kill `cat /var/run/klogd.pid`; cat /tmp/klog.log
klogd 1.3-3#33.1, log source = /proc/kmsg started.
<5>Linux version 2.6.18.6 (antony@cyclops) (gcc version 4.1.2 20061115 (prerelease) (Debian 4.1.1-21)) #1 Mon Jan 14 16:26:00 EST 2008
<7>On node 0 totalpages: 8192
<7>  DMA zone: 8192 pages, LIFO batch:1
<4>Built 1 zonelists.  Total pages: 8192
<5>Kernel command line: initrd=/btmp/antony/ikev2/2008_01_14/UMLPOOL/initrd.uml umlroot=/btmp/antony/ikev2/2008_01_14/UMLPOOL/west/root root=/dev/ram0 rw ssl=pty eth0=daemon,10:00:00:ab:cd:ff,unix,/tmp/uml6bcyGN.d/west/ctl,/tmp/uml6bcyGN.d/west/data eth1=daemon,10:00:00:64:64:45,unix,/tmp/uml6bcyGN.d/public/ctl,/tmp/uml6bcyGN.d/public/data eth2=daemon,10:00:00:32:64:45,unix,/tmp/uml6bcyGN.d/admin/ctl,/tmp/uml6bcyGN.d/admin/data init=/linuxrc single
<4>PID hash table entries: 256 (order: 8, 1024 bytes)
<4>Dentry cache hash table entries: 4096 (order: 2, 16384 bytes)
<4>Inode-cache hash table entries: 2048 (order: 1, 8192 bytes)
<6>Memory: 27292k available
<7>Calibrating delay loop... 3814.19 BogoMIPS (lpj=19070976)
<4>Mount-cache hash table entries: 512
<4>Checking for host processor cmov support...Yes
<4>Checking for host processor xmm support...No
<4>Checking that host ptys support output SIGIO...Yes
<4>Checking that host ptys support SIGIO on close...No, enabling workaround
<6>checking if image is initramfs...it isn't (bad gzip magic numbers); looks like an initrd
<4>Freeing initrd memory: 1212k freed
<4>Using 2.6 host AIO
<6>NET: Registered protocol family 16
<6>NET: Registered protocol family 2
<4>IP route cache hash table entries: 256 (order: -2, 1024 bytes)
<4>TCP established hash table entries: 1024 (order: 0, 4096 bytes)
<4>TCP bind hash table entries: 512 (order: -1, 2048 bytes)
<6>TCP: Hash tables configured (established 1024 bind 512)
<6>TCP reno registered
<6>klips_info:ipsec_init: KLIPS startup, Openswan KLIPS IPsec stack version: 2.5.testing-g70d71a2f-dirty
<6>NET: Registered protocol family 15
<6>klips_info:ipsec_alg_init: KLIPS alg v=0.8.1-0 (EALG_MAX=255, AALG_MAX=251)
<6>klips_info:ipsec_alg_init: calling ipsec_alg_static_init()
<4>ipsec_aes_init(alg_type=15 alg_id=12 name=aes): ret=0
<4>ipsec_aes_init(alg_type=14 alg_id=9 name=aes_mac): ret=0
<4>ipsec_3des_init(alg_type=15 alg_id=3 name=3des): ret=0
<4>daemon_setup : Ignoring data socket specification
<6>Netdevice 0 (10:00:00:ab:cd:ff) : daemon backend (uml_switch version 3) - unix:/tmp/uml6bcyGN.d/west/ctl
<4>daemon_setup : Ignoring data socket specification
<6>Netdevice 1 (10:00:00:64:64:45) : daemon backend (uml_switch version 3) - unix:/tmp/uml6bcyGN.d/public/ctl
<4>daemon_setup : Ignoring data socket specification
<6>Netdevice 2 (10:00:00:32:64:45) : daemon backend (uml_switch version 3) - unix:/tmp/uml6bcyGN.d/admin/ctl
<4>Checking host MADV_REMOVE support...OK
<4>mconsole (version 2) initialized on /home/antony/.uml/west/mconsole
<6>Host TLS support detected
<6>Detected host type: i386
<5>VFS: Disk quotas dquot_6.5.1
<4>Dquot-cache hash table entries: 1024 (order 0, 4096 bytes)
<6>Initializing Cryptographic API
<6>io scheduler noop registered
<6>io scheduler anticipatory registered (default)
<6>io scheduler deadline registered
<6>io scheduler cfq registered
<4>RAMDISK driver initialized: 16 RAM disks of 4096K size 1024 blocksize
<6>loop: loaded (max 8 devices)
<6>nbd: registered device at major 43
<6>PPP generic driver version 2.4.2
<6>SLIP: version 0.8.4-NET3.019-NEWTTY (dynamic channels, max=256).
<6>tun: Universal TUN/TAP device driver, 1.6
<6>tun: (C) 1999-2004 Max Krasnyansky <maxk@qualcomm.com>
<4>Netfilter messages via NETLINK v0.30.
<6>IPv4 over IPv4 tunneling driver
<6>GRE over IPv4 tunneling driver
<4>ip_conntrack version 2.4 (213 buckets, 1704 max) - 204 bytes per conntrack
<4>ip_tables: (C) 2000-2006 Netfilter Core Team
<4>arp_tables: (C) 2002 David S. Miller
<6>TCP bic registered
<6>TCP cubic registered
<6>TCP westwood registered
<6>TCP highspeed registered
<6>TCP hybla registered
<6>TCP htcp registered
<6>TCP vegas registered
<6>TCP scalable registered
<6>NET: Registered protocol family 1
<6>NET: Registered protocol family 17
<6>Initialized stdio console driver
<4>Console initialized on /dev/tty0
<6>Initializing software serial port version 1
<4>Failed to open 'root_fs', errno = 2
<5>RAMDISK: cramfs filesystem found at block 0
<5>RAMDISK: Loading 1212KiB [1 disk] into ram disk... |/-\|/-\|/-\|/-\|/-\|/-\|/-\|/-\|/-\|/-\|/-\|/-\|/-\|/-\|/-\|/-\|/-\|/-\|/-\done.
<4>VFS: Mounted root (cramfs filesystem) readonly.
<6>line_ioctl: tty0: ioctl KDSIGACCEPT called
<4>
<2>IPSEC EVENT: KLIPS device ipsec0 shut down.
<4>
Kernel logging (proc) stopped.
Kernel log daemon terminating.
west:~# halt -p -f
System halted.

