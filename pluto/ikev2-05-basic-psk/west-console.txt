Starting UML /btmp/antony/ikev2/2008_01_14/UMLPOOL/west/start.sh
spawn /btmp/antony/ikev2/2008_01_14/UMLPOOL/west/start.sh single
Checking that ptrace can change system call numbers...OK
Checking syscall emulation patch for ptrace...OK
Checking advanced syscall emulation patch for ptrace...OK
Checking for tmpfs mount on /dev/shm...OK
Checking PROT_EXEC mmap in /dev/shm/...OK
Checking for the skas3 patch in the host:
  - /proc/mm...not found
  - PTRACE_FAULTINFO...not found
  - PTRACE_LDT...not found
UML running in SKAS0 mode
Checking that ptrace can change system call numbers...OK
Checking syscall emulation patch for ptrace...OK
Checking advanced syscall emulation patch for ptrace...OK
Linux version 2.6.18.6 (antony@cyclops) (gcc version 4.1.2 20061115 (prerelease) (Debian 4.1.1-21)) #1 Mon Jan 14 16:26:00 EST 2008
Built 1 zonelists.  Total pages: 8192
Kernel command line: initrd=/btmp/antony/ikev2/2008_01_14/UMLPOOL/initrd.uml umlroot=/btmp/antony/ikev2/2008_01_14/UMLPOOL/west/root root=/dev/ram0 rw ssl=pty eth0=daemon,10:00:00:ab:cd:ff,unix,/tmp/umlEV4Tk1.d/west/ctl,/tmp/umlEV4Tk1.d/west/data eth1=daemon,10:00:00:64:64:45,unix,/tmp/umlEV4Tk1.d/public/ctl,/tmp/umlEV4Tk1.d/public/data eth2=daemon,10:00:00:32:64:45,unix,/tmp/umlEV4Tk1.d/admin/ctl,/tmp/umlEV4Tk1.d/admin/data init=/linuxrc single
PID hash table entries: 256 (order: 8, 1024 bytes)
Dentry cache hash table entries: 4096 (order: 2, 16384 bytes)
Inode-cache hash table entries: 2048 (order: 1, 8192 bytes)
Memory: 27292k available
Mount-cache hash table entries: 512
Checking for host processor cmov support...Yes
Checking for host processor xmm support...No
Checking that host ptys support output SIGIO...Yes
Checking that host ptys support SIGIO on close...No, enabling workaround
checking if image is initramfs...it isn't (bad gzip magic numbers); looks like an initrd
Freeing initrd memory: 1212k freed
Using 2.6 host AIO
NET: Registered protocol family 16
NET: Registered protocol family 2
IP route cache hash table entries: 256 (order: -2, 1024 bytes)
TCP established hash table entries: 1024 (order: 0, 4096 bytes)
TCP bind hash table entries: 512 (order: -1, 2048 bytes)
TCP: Hash tables configured (established 1024 bind 512)
TCP reno registered
klips_info:ipsec_init: KLIPS startup, Openswan KLIPS IPsec stack version: 2.5.testing-g70d71a2f-dirty
NET: Registered protocol family 15
klips_info:ipsec_alg_init: KLIPS alg v=0.8.1-0 (EALG_MAX=255, AALG_MAX=251)
klips_info:ipsec_alg_init: calling ipsec_alg_static_init()
ipsec_aes_init(alg_type=15 alg_id=12 name=aes): ret=0
ipsec_aes_init(alg_type=14 alg_id=9 name=aes_mac): ret=0
ipsec_3des_init(alg_type=15 alg_id=3 name=3des): ret=0
daemon_setup : Ignoring data socket specification
Netdevice 0 (10:00:00:ab:cd:ff) : daemon backend (uml_switch version 3) - unix:/tmp/umlEV4Tk1.d/west/ctl
daemon_setup : Ignoring data socket specification
Netdevice 1 (10:00:00:64:64:45) : daemon backend (uml_switch version 3) - unix:/tmp/umlEV4Tk1.d/public/ctl
daemon_setup : Ignoring data socket specification
Netdevice 2 (10:00:00:32:64:45) : daemon backend (uml_switch version 3) - unix:/tmp/umlEV4Tk1.d/admin/ctl
Checking host MADV_REMOVE support...OK
mconsole (version 2) initialized on /home/antony/.uml/west/mconsole
Host TLS support detected
Detected host type: i386
VFS: Disk quotas dquot_6.5.1
Dquot-cache hash table entries: 1024 (order 0, 4096 bytes)
Initializing Cryptographic API
io scheduler noop registered
io scheduler anticipatory registered (default)
io scheduler deadline registered
io scheduler cfq registered
RAMDISK driver initialized: 16 RAM disks of 4096K size 1024 blocksize
loop: loaded (max 8 devices)
nbd: registered device at major 43
PPP generic driver version 2.4.2
SLIP: version 0.8.4-NET3.019-NEWTTY (dynamic channels, max=256).
tun: Universal TUN/TAP device driver, 1.6
tun: (C) 1999-2004 Max Krasnyansky <maxk@qualcomm.com>
Netfilter messages via NETLINK v0.30.
IPv4 over IPv4 tunneling driver
GRE over IPv4 tunneling driver
ip_conntrack version 2.4 (213 buckets, 1704 max) - 204 bytes per conntrack
ip_tables: (C) 2000-2006 Netfilter Core Team
arp_tables: (C) 2002 David S. Miller
TCP bic registered
TCP cubic registered
TCP westwood registered
TCP highspeed registered
TCP hybla registered
TCP htcp registered
TCP vegas registered
TCP scalable registered
NET: Registered protocol family 1
NET: Registered protocol family 17
Initialized stdio console driver
Console initialized on /dev/tty0
Initializing software serial port version 1
Failed to open 'root_fs', errno = 2
RAMDISK: cramfs filesystem found at block 0
RAMDISK: Loading 1212KiB [1 disk] into ram disk... |/-\|/-\|/-\|/-\|/-\|/-\|/-\|/-\|/-\|/-\|/-\|/-\|/-\|/-\|/-\|/-\|/-\|/-\|/-\done.
VFS: Mounted root (cramfs filesystem) readonly.
MOUNTING /btmp/antony/ikev2/2008_01_14/UMLPOOL/west/root for UML testing root.
Mounting a tmpfs over /dev...done.
Creating initial device nodes...done.
Invoked with Arguments: single
Creating initial device nodes...done.
crw-r--r--    1 root     root       5,   1 Feb 21 21:53 /dev/console
line_ioctl: tty0: ioctl KDSIGACCEPT called
INIT: version 2.78 booting
/dev/root on / type hostfs (rw)
proc on /proc type proc (rw)
devpts on /dev/pts type devpts (rw,gid=5,mode=620)
/dev/shm on /tmp type tmpfs (rw)
/dev/shm on /var/run type tmpfs (rw)
none on /usr/share type hostfs (ro)
none on /testing type hostfs (ro,/home/antony/ikev2/testing)
none on /usr/src type hostfs (ro,/home/antony/ikev2)
none on /usr/obj type hostfs (ro,/home/antony/ikev2/OBJ.linux.i386)
none on /usr/local type hostfs (rw,/btmp/antony/ikev2/2008_01_14/UMLPOOL/west/root/usr/local)
none on /var/tmp type hostfs (rw,/btmp/antony/ikev2/2008_01_14/UMLPOOL/west/root/var/tmp)
none on /proc type proc (rw)
crw-r--r--    1 root     root       5,   1 Feb 21 21:53 /dev/console
mount: proc already mounted
Activating swap...
Checking all file systems...
Parallelizing fsck version 1.18 (11-Nov-1999)
Setting kernel variables.
Mounting local filesystems...
mount: devpts already mounted on /dev/pts
/dev/shm on /tmp type tmpfs (rw)
/dev/shm on /var/run type tmpfs (rw)
none on /usr/share type hostfs (ro)
none on /testing type hostfs (ro,/home/antony/ikev2/testing)
none on /usr/src type hostfs (ro,/home/antony/ikev2)
none on /usr/obj type hostfs (ro,/home/antony/ikev2/OBJ.linux.i386)
none on /usr/local type hostfs (rw,/btmp/antony/ikev2/2008_01_14/UMLPOOL/west/root/usr/local)
none on /var/tmp type hostfs (rw,/btmp/antony/ikev2/2008_01_14/UMLPOOL/west/root/var/tmp)
Enabling packet forwarding: done.
Configuring network interfaces: done.
Cleaning: /tmp /var/lock /var/run.
Initializing random number generator... done.
Recovering nvi editor sessions... done.
Give root password for maintenance
(or type Control-D for normal startup): 
west:~# echo Starting loading module
Starting loading module
west:~# exec bash --noediting
west:~# ulimit -c unlimited
west:~# echo Finished loading module
Finished loading module
west:~# klogd -c 4 -x -f /tmp/klog.log
west:~# : ==== start ====
west:~# TESTNAME=ikev2-05-basic-psk
west:~# source /testing/pluto/bin/westlocal.sh
west:~# ping -n -c 1 192.0.2.254
PING 192.0.2.254 (192.0.2.254): 56 data bytes
64 bytes from 192.0.2.254: icmp_seq=0 ttl=64 time=33.0 ms

--- 192.0.2.254 ping statistics ---
1 packets transmitted, 1 packets received, 0% packet loss
round-trip min/avg/max = 33.0/33.0/33.0 ms
west:~# iptables -A INPUT -i eth1 -s 192.0.2.0/24 -j DROP
west:~# ping -n -c 1 192.0.2.254
PING 192.0.2.254 (192.0.2.254): 56 data bytes

--- 192.0.2.254 ping statistics ---
1 packets transmitted, 0 packets received, 100% packet loss
west:~# ipsec setup start
ipsec_setup: Starting Openswan IPsec U2.5.testing-g43bc1d6c-dirty/K2.5.testing-g70d71a2f-dirty...
west:~# ipsec whack --whackrecord /var/tmp/ikev2.record
west:~# ipsec auto --add westnet--eastnet-ikev2
west:~# ipsec auto --status
000 using kernel interface: klips
000 interface ipsec0/eth1 192.1.2.45
000 %myid = (none)
000 debug raw+crypt+parsing+emitting+control+lifecycle+klips+dns+oppo+controlmore+pfkey+nattraversal+x509
000  
000 algorithm ESP encrypt: id=3, name=ESP_3DES, ivlen=64, keysizemin=192, keysizemax=192
000 algorithm ESP encrypt: id=12, name=ESP_AES, ivlen=128, keysizemin=128, keysizemax=256
000 algorithm ESP auth attr: id=1, name=AUTH_ALGORITHM_HMAC_MD5, keysizemin=128, keysizemax=128
000 algorithm ESP auth attr: id=2, name=AUTH_ALGORITHM_HMAC_SHA1, keysizemin=160, keysizemax=160
000 algorithm ESP auth attr: id=9, name=AUTH_ALGORITHM_AES_CBC, keysizemin=128, keysizemax=128
000  
000 algorithm IKE encrypt: id=3, name=OAKLEY_BLOWFISH_CBC, blocksize=8, keydeflen=128
000 algorithm IKE encrypt: id=5, name=OAKLEY_3DES_CBC, blocksize=8, keydeflen=192
000 algorithm IKE encrypt: id=7, name=OAKLEY_AES_CBC, blocksize=16, keydeflen=128
000 algorithm IKE encrypt: id=65004, name=OAKLEY_SERPENT_CBC, blocksize=16, keydeflen=128
000 algorithm IKE encrypt: id=65005, name=OAKLEY_TWOFISH_CBC, blocksize=16, keydeflen=128
000 algorithm IKE encrypt: id=65289, name=OAKLEY_TWOFISH_CBC_SSH, blocksize=16, keydeflen=128
000 algorithm IKE hash: id=1, name=OAKLEY_MD5, hashsize=16
000 algorithm IKE hash: id=2, name=OAKLEY_SHA1, hashsize=20
000 algorithm IKE hash: id=4, name=OAKLEY_SHA2_256, hashsize=32
000 algorithm IKE hash: id=6, name=OAKLEY_SHA2_512, hashsize=64
000 algorithm IKE dh group: id=2, name=OAKLEY_GROUP_MODP1024, bits=1024
000 algorithm IKE dh group: id=5, name=OAKLEY_GROUP_MODP1536, bits=1536
000 algorithm IKE dh group: id=14, name=OAKLEY_GROUP_MODP2048, bits=2048
000 algorithm IKE dh group: id=15, name=OAKLEY_GROUP_MODP3072, bits=3072
000 algorithm IKE dh group: id=16, name=OAKLEY_GROUP_MODP4096, bits=4096
000 algorithm IKE dh group: id=17, name=OAKLEY_GROUP_MODP6144, bits=6144
000 algorithm IKE dh group: id=18, name=OAKLEY_GROUP_MODP8192, bits=8192
000  
000 stats db_ops: {curr_cnt, total_cnt, maxsz} :context={0,0,0} trans={0,0,0} attrs={0,0,0} 
000  
000 "westnet--eastnet-ikev2": 192.0.1.0/24===192.1.2.45<192.1.2.45>[@west,S=C]...192.1.2.23<192.1.2.23>[@east,S=C]===192.0.2.0/24; unrouted; eroute owner: #0
000 "westnet--eastnet-ikev2":     myip=unset; hisip=unset;
000 "westnet--eastnet-ikev2":   ike_life: 3600s; ipsec_life: 28800s; rekey_margin: 540s; rekey_fuzz: 100%; keyingtries: 3
000 "westnet--eastnet-ikev2":   policy: PSK+ENCRYPT+TUNNEL+PFS+!IKEv1+IKEv2ALLOW+IKEv2Init; prio: 24,24; interface: eth1; 
000 "westnet--eastnet-ikev2":   newest ISAKMP SA: #0; newest IPsec SA: #0; 
000  
000  
west:~# /testing/pluto/bin/wait-until-pluto-started
west:~# echo done
done
west:~# : === NETJIG start of WEST westrun.sh 
west:~# ipsec auto --up  westnet--eastnet-ikev2
133 "westnet--eastnet-ikev2" #1: STATE_PARENT_I1: initiate
133 "westnet--eastnet-ikev2" #1: STATE_PARENT_I1: sent v2I1, expected v2R1
134 "westnet--eastnet-ikev2" #2: STATE_PARENT_I2: sent v2I2, expected v2R2 {auth=IKEv2 cipher=aes_128 integ=sha1 prf=oakley_sha group=modp2048}
004 "westnet--eastnet-ikev2" #2: STATE_PARENT_I3: PARENT SA established tunnel mode {ESP=>0xb374a893 <0x79acbc7a xfrm=AES_128-HMAC_SHA1 NATOA=none NATD=none DPD=none}
west:~# ipsec look
west Thu Feb 21 21:54:31 GMT 2008
192.0.1.0/24       -> 192.0.2.0/24       => tun0x1001@192.1.2.23 esp0xb374a893@192.1.2.23  (0)
ipsec0->eth1 mtu=16260(1500)->1500
esp0x79acbc7a@192.1.2.45 ESP_AES_HMAC_SHA1: dir=in  src=192.1.2.23 iv_bits=128bits iv=0x4e279d3e52f127f8acf3497b7ea52178 ooowin=64 alen=160 aklen=160 eklen=128 life(c,s,h)=addtime(0,0,0) natencap=none natsport=0 natdport=0 refcount=4 ref=6
esp0xb374a893@192.1.2.23 ESP_AES_HMAC_SHA1: dir=out src=192.1.2.45 iv_bits=128bits iv=0xc625c795ab89de1724c854de88ff25ab ooowin=64 alen=160 aklen=160 eklen=128 life(c,s,h)=addtime(0,0,0) natencap=none natsport=0 natdport=0 refcount=4 ref=4
tun0x1001@192.1.2.23 IPIP: dir=out src=192.1.2.45 life(c,s,h)=addtime(0,0,0) natencap=none natsport=0 natdport=0 refcount=4 ref=3
tun0x1002@192.1.2.45 IPIP: dir=in  src=192.1.2.23 policy=192.0.2.0/24->192.0.1.0/24 flags=0x8<> life(c,s,h)=addtime(0,0,0) natencap=none natsport=0 natdport=0 refcount=4 ref=5
ROUTING TABLE
192.1.2.0/24 dev eth1  proto kernel  scope link  src 192.1.2.45 
192.1.2.0/24 dev ipsec0  proto kernel  scope link  src 192.1.2.45 
192.0.2.0/24 dev ipsec0  scope link 
default via 192.1.2.254 dev eth1 
west:~# echo done
done
west:~# 

west:~# : ==== cut ====
west:~# ipsec auto --status
000 using kernel interface: klips
000 interface ipsec0/eth1 192.1.2.45
000 %myid = (none)
000 debug raw+crypt+parsing+emitting+control+lifecycle+klips+dns+oppo+controlmore+pfkey+nattraversal+x509
000  
000 algorithm ESP encrypt: id=3, name=ESP_3DES, ivlen=64, keysizemin=192, keysizemax=192
000 algorithm ESP encrypt: id=12, name=ESP_AES, ivlen=128, keysizemin=128, keysizemax=256
000 algorithm ESP auth attr: id=1, name=AUTH_ALGORITHM_HMAC_MD5, keysizemin=128, keysizemax=128
000 algorithm ESP auth attr: id=2, name=AUTH_ALGORITHM_HMAC_SHA1, keysizemin=160, keysizemax=160
000 algorithm ESP auth attr: id=9, name=AUTH_ALGORITHM_AES_CBC, keysizemin=128, keysizemax=128
000  
000 algorithm IKE encrypt: id=3, name=OAKLEY_BLOWFISH_CBC, blocksize=8, keydeflen=128
000 algorithm IKE encrypt: id=5, name=OAKLEY_3DES_CBC, blocksize=8, keydeflen=192
000 algorithm IKE encrypt: id=7, name=OAKLEY_AES_CBC, blocksize=16, keydeflen=128
000 algorithm IKE encrypt: id=65004, name=OAKLEY_SERPENT_CBC, blocksize=16, keydeflen=128
000 algorithm IKE encrypt: id=65005, name=OAKLEY_TWOFISH_CBC, blocksize=16, keydeflen=128
000 algorithm IKE encrypt: id=65289, name=OAKLEY_TWOFISH_CBC_SSH, blocksize=16, keydeflen=128
000 algorithm IKE hash: id=1, name=OAKLEY_MD5, hashsize=16
000 algorithm IKE hash: id=2, name=OAKLEY_SHA1, hashsize=20
000 algorithm IKE hash: id=4, name=OAKLEY_SHA2_256, hashsize=32
000 algorithm IKE hash: id=6, name=OAKLEY_SHA2_512, hashsize=64
000 algorithm IKE dh group: id=2, name=OAKLEY_GROUP_MODP1024, bits=1024
000 algorithm IKE dh group: id=5, name=OAKLEY_GROUP_MODP1536, bits=1536
000 algorithm IKE dh group: id=14, name=OAKLEY_GROUP_MODP2048, bits=2048
000 algorithm IKE dh group: id=15, name=OAKLEY_GROUP_MODP3072, bits=3072
000 algorithm IKE dh group: id=16, name=OAKLEY_GROUP_MODP4096, bits=4096
000 algorithm IKE dh group: id=17, name=OAKLEY_GROUP_MODP6144, bits=6144
000 algorithm IKE dh group: id=18, name=OAKLEY_GROUP_MODP8192, bits=8192
000  
000 stats db_ops: {curr_cnt, total_cnt, maxsz} :context={0,0,0} trans={0,0,0} attrs={0,0,0} 
000  
000 "westnet--eastnet-ikev2": 192.0.1.0/24===192.1.2.45<192.1.2.45>[@west,S=C]...192.1.2.23<192.1.2.23>[@east,S=C]===192.0.2.0/24; erouted; eroute owner: #2
000 "westnet--eastnet-ikev2":     myip=unset; hisip=unset;
000 "westnet--eastnet-ikev2":   ike_life: 3600s; ipsec_life: 28800s; rekey_margin: 540s; rekey_fuzz: 100%; keyingtries: 3
000 "westnet--eastnet-ikev2":   policy: PSK+ENCRYPT+TUNNEL+PFS+UP+!IKEv1+IKEv2ALLOW+IKEv2Init; prio: 24,24; interface: eth1; 
000 "westnet--eastnet-ikev2":   newest ISAKMP SA: #1; newest IPsec SA: #2; 
000 "westnet--eastnet-ikev2":   IKE algorithm newest: _128-SHA1-MODP2048
000  
000 #2: "westnet--eastnet-ikev2":500 STATE_PARENT_I3 (PARENT SA established); none in -1s; newest IPSEC; eroute owner; nodpd; idle; import:admin initiate
000 #1: "westnet--eastnet-ikev2":500 STATE_PARENT_I3 (PARENT SA established); EVENT_CRYPTO_FAILED in 286s; newest ISAKMP; nodpd; idle; import:admin initiate
000  
west:~# cat /tmp/pluto.log
Plutorun started on Thu Feb 21 21:53:46 GMT 2008
Starting Pluto (Openswan Version 2.5.testing-g43bc1d6c-dirty; Vendor ID OEqjE\177pQ\134kpL) pid:916
Setting NAT-Traversal port-4500 floating to off
   port floating activation criteria nat_t=0/port_float=1
   including NAT-Traversal patch (Version 0.6c) [disabled]
| opening /dev/urandom
using /dev/urandom as source of random entropy
| inserting event EVENT_REINIT_SECRET, timeout in 3600 seconds
| inserting event EVENT_PENDING_PHASE2, timeout in 120 seconds
ike_alg_register_enc(): Activating OAKLEY_TWOFISH_CBC_SSH: Ok (ret=0)
ike_alg_register_enc(): Activating OAKLEY_TWOFISH_CBC: Ok (ret=0)
ike_alg_register_enc(): Activating OAKLEY_SERPENT_CBC: Ok (ret=0)
ike_alg_register_enc(): Activating OAKLEY_AES_CBC: Ok (ret=0)
ike_alg_register_enc(): Activating OAKLEY_BLOWFISH_CBC: Ok (ret=0)
ike_alg_register_hash(): Activating OAKLEY_SHA2_512: Ok (ret=0)
ike_alg_register_hash(): Activating OAKLEY_SHA2_256: Ok (ret=0)
starting up 1 cryptographic helpers
| opening /dev/urandom
using /dev/urandom as source of random entropy
started helper pid=917 (fd:6)
Using KLIPS IPsec interface code on 2.6.18.6
| process 916 listening for PF_KEY_V2 on file descriptor 7
| finish_pfkey_msg: SADB_REGISTER message 1 for AH 
|   02 07 00 02  02 00 00 00  01 00 00 00  94 03 00 00
| pfkey_get: SADB_REGISTER message 1
| AH registered with kernel.
| finish_pfkey_msg: SADB_REGISTER message 2 for ESP 
|   02 07 00 03  02 00 00 00  02 00 00 00  94 03 00 00
| pfkey_get: SADB_REGISTER message 2
| alg_init():memset(0x813ce80, 0, 2016) memset(0x813d660, 0, 2048) 
| kernel_alg_register_pfkey(): SADB_SATYPE_ESP: sadb_msg_len=10 sadb_supported_len=32
| kernel_alg_add():satype=3, exttype=14, alg_id=9
| kernel_alg_register_pfkey(): SADB_SATYPE_ESP: alg[0], exttype=14, satype=3, alg_id=9, alg_ivlen=0, alg_minbits=128, alg_maxbits=128, res=0, ret=1
| kernel_alg_add():satype=3, exttype=14, alg_id=3
| kernel_alg_register_pfkey(): SADB_SATYPE_ESP: alg[1], exttype=14, satype=3, alg_id=3, alg_ivlen=0, alg_minbits=160, alg_maxbits=160, res=0, ret=1
| kernel_alg_add():satype=3, exttype=14, alg_id=2
| kernel_alg_register_pfkey(): SADB_SATYPE_ESP: alg[2], exttype=14, satype=3, alg_id=2, alg_ivlen=0, alg_minbits=128, alg_maxbits=128, res=0, ret=1
| kernel_alg_register_pfkey(): SADB_SATYPE_ESP: sadb_msg_len=10 sadb_supported_len=32
| kernel_alg_add():satype=3, exttype=15, alg_id=3
| kernel_alg_register_pfkey(): SADB_SATYPE_ESP: alg[3], exttype=15, satype=3, alg_id=3, alg_ivlen=64, alg_minbits=192, alg_maxbits=192, res=0, ret=1
| kernel_alg_add():satype=3, exttype=15, alg_id=12
| kernel_alg_register_pfkey(): SADB_SATYPE_ESP: alg[4], exttype=15, satype=3, alg_id=12, alg_ivlen=128, alg_minbits=128, alg_maxbits=256, res=0, ret=1
| kernel_alg_add():satype=3, exttype=15, alg_id=3
| kernel_alg_add(): discarding already setup satype=3, exttype=15, alg_id=3
| kernel_alg_register_pfkey(): SADB_SATYPE_ESP: alg[5], exttype=15, satype=3, alg_id=3, alg_ivlen=64, alg_minbits=168, alg_maxbits=168, res=0, ret=0
| ESP registered with kernel.
| finish_pfkey_msg: SADB_REGISTER message 3 for IPCOMP 
|   02 07 00 0a  02 00 00 00  03 00 00 00  94 03 00 00
| pfkey_get: SADB_REGISTER message 3
| IPCOMP registered with kernel.
| finish_pfkey_msg: SADB_REGISTER message 4 for IPIP 
|   02 07 00 09  02 00 00 00  04 00 00 00  94 03 00 00
| pfkey_get: SADB_REGISTER message 4
| IPIP registered with kernel.
| inserting event EVENT_SHUNT_SCAN, timeout in 120 seconds
Changed path to directory '/tmp/ikev2-05-basic-psk/ipsec.d/cacerts'
Changed path to directory '/tmp/ikev2-05-basic-psk/ipsec.d/aacerts'
Changed path to directory '/tmp/ikev2-05-basic-psk/ipsec.d/ocspcerts'
Changing to directory '/tmp/ikev2-05-basic-psk/ipsec.d/crls'
  loaded crl file 'nic.crl' (642 bytes)
|   file content is not binary ASN.1
|   -----BEGIN X509 CRL-----
|   -----END X509 CRL-----
|   file coded in PEM format
| L0 - certificateList:
|   30 82 01 b2  30 81 9b 30  0d 06 09 2a  86 48 86 f7
|   0d 01 01 04  05 00 30 6c  31 0b 30 09  06 03 55 04
|   06 13 02 43  41 31 10 30  0e 06 03 55  04 08 13 07
|   4f 6e 74 61  72 69 6f 31  11 30 0f 06  03 55 04 0a
|   13 08 4f 70  65 6e 73 77  61 6e 31 18  30 16 06 03
|   55 04 03 13  0f 63 61 2e  6f 70 65 6e  73 77 61 6e
|   2e 6f 72 67  31 1e 30 1c  06 09 2a 86  48 86 f7 0d
|   01 09 01 16  0f 63 61 40  6f 70 65 6e  73 77 61 6e
|   2e 6f 72 67  17 0d 30 34  30 35 32 38  31 36 32 39
|   32 32 5a 17  0d 31 34 30  35 32 36 31  36 32 39 32
|   32 5a 30 0d  06 09 2a 86  48 86 f7 0d  01 01 04 05
|   00 03 82 01  01 00 97 39  db 11 85 33  8e f5 ee fd
|   13 c4 47 62  ab 15 b0 02  39 6e 18 35  55 4a a6 e7
|   a2 15 b7 c8  1b 1e 72 aa  b8 a8 1b 62  28 c1 05 18
|   f0 ad a0 37  ef 98 47 e5  f3 f4 d0 f7  76 7a 93 3f
|   08 ae 21 4d  38 c3 0c fe  e7 49 aa d6  f7 90 6b df
|   ed 88 0a d1  9c 95 97 35  8c d2 e1 db  61 7f ad 72
|   87 f2 f1 fc  a8 9e 0a b4  64 db 46 fc  a5 f1 3e 99
|   22 ff ea 73  09 b5 00 d2  47 fd 08 3a  75 57 01 f5
|   54 4c 21 9e  a5 2a c4 3e  ac c2 b0 fb  f9 7d 26 43
|   38 f0 6d 78  1d 0a f3 87  d5 20 00 07  e6 e6 ef c9
|   42 2c 92 22  d5 18 95 f4  83 44 d7 ee  1d a6 2b 63
|   04 57 c0 cc  48 a6 c1 ee  90 c9 a4 b9  e4 e4 d6 4a
|   ac 1e 20 75  70 0a 0d fd  c8 39 43 8d  f7 78 49 cb
|   a2 b6 5d 90  44 2f 13 5c  a9 eb 91 ca  cf 14 fb bb
|   e2 87 32 c3  0f 39 89 bb  1f 40 a3 03  11 bc a9 c0
|   0e ec 71 66  79 63 71 3d  8c ce 15 03  9e 1b 07 bc
|   0e a1 b1 a3  7d a3
| L1 - tbsCertList:
|   30 81 9b 30  0d 06 09 2a  86 48 86 f7  0d 01 01 04
|   05 00 30 6c  31 0b 30 09  06 03 55 04  06 13 02 43
|   41 31 10 30  0e 06 03 55  04 08 13 07  4f 6e 74 61
|   72 69 6f 31  11 30 0f 06  03 55 04 0a  13 08 4f 70
|   65 6e 73 77  61 6e 31 18  30 16 06 03  55 04 03 13
|   0f 63 61 2e  6f 70 65 6e  73 77 61 6e  2e 6f 72 67
|   31 1e 30 1c  06 09 2a 86  48 86 f7 0d  01 09 01 16
|   0f 63 61 40  6f 70 65 6e  73 77 61 6e  2e 6f 72 67
|   17 0d 30 34  30 35 32 38  31 36 32 39  32 32 5a 17
|   0d 31 34 30  35 32 36 31  36 32 39 32  32 5a
| L2 - signature:
| L3 - algorithmIdentifier:
| L4 - algorithm:
|   'md5WithRSAEncryption'
| L2 - issuer:
|   30 6c 31 0b  30 09 06 03  55 04 06 13  02 43 41 31
|   10 30 0e 06  03 55 04 08  13 07 4f 6e  74 61 72 69
|   6f 31 11 30  0f 06 03 55  04 0a 13 08  4f 70 65 6e
|   73 77 61 6e  31 18 30 16  06 03 55 04  03 13 0f 63
|   61 2e 6f 70  65 6e 73 77  61 6e 2e 6f  72 67 31 1e
|   30 1c 06 09  2a 86 48 86  f7 0d 01 09  01 16 0f 63
|   61 40 6f 70  65 6e 73 77  61 6e 2e 6f  72 67
|   'C=CA, ST=Ontario, O=Openswan, CN=ca.openswan.org, E=ca@openswan.org'
| L2 - thisUpdate:
| L3 - utcTime:
|   'May 28 16:29:22 UTC 2004'
| L2 - nextUpdate:
| L3 - utcTime:
|   'May 26 16:29:22 UTC 2014'
| L1 - signatureAlgorithm:
| L2 - algorithmIdentifier:
| L3 - algorithm:
|   'md5WithRSAEncryption'
| L1 - signatureValue:
|   00 97 39 db  11 85 33 8e  f5 ee fd 13  c4 47 62 ab
|   15 b0 02 39  6e 18 35 55  4a a6 e7 a2  15 b7 c8 1b
|   1e 72 aa b8  a8 1b 62 28  c1 05 18 f0  ad a0 37 ef
|   98 47 e5 f3  f4 d0 f7 76  7a 93 3f 08  ae 21 4d 38
|   c3 0c fe e7  49 aa d6 f7  90 6b df ed  88 0a d1 9c
|   95 97 35 8c  d2 e1 db 61  7f ad 72 87  f2 f1 fc a8
|   9e 0a b4 64  db 46 fc a5  f1 3e 99 22  ff ea 73 09
|   b5 00 d2 47  fd 08 3a 75  57 01 f5 54  4c 21 9e a5
|   2a c4 3e ac  c2 b0 fb f9  7d 26 43 38  f0 6d 78 1d
|   0a f3 87 d5  20 00 07 e6  e6 ef c9 42  2c 92 22 d5
|   18 95 f4 83  44 d7 ee 1d  a6 2b 63 04  57 c0 cc 48
|   a6 c1 ee 90  c9 a4 b9 e4  e4 d6 4a ac  1e 20 75 70
|   0a 0d fd c8  39 43 8d f7  78 49 cb a2  b6 5d 90 44
|   2f 13 5c a9  eb 91 ca cf  14 fb bb e2  87 32 c3 0f
|   39 89 bb 1f  40 a3 03 11  bc a9 c0 0e  ec 71 66 79
|   63 71 3d 8c  ce 15 03 9e  1b 07 bc 0e  a1 b1 a3 7d
|   a3
crl issuer cacert not found for (file:///tmp/ikev2-05-basic-psk/ipsec.d/crls/nic.crl)
  loaded crl file 'crashcrl-3.pem' (690 bytes)
|   file content is not binary ASN.1
|   -----BEGIN X509 CRL-----
|   -----END X509 CRL-----
|   file coded in PEM format
| L0 - certificateList:
|   30 82 01 d5  30 81 be 30  0d 06 09 2a  86 48 86 f7
|   0d 01 01 04  05 00 30 81  8e 31 0b 30  09 06 03 55
|   04 06 13 02  55 53 31 12  30 10 06 03  55 04 08 13
|   09 4d 69 6e  6e 65 73 6f  74 61 31 15  30 13 06 03
|   55 04 07 13  0c 45 64 65  6e 20 50 72  61 69 72 69
|   65 31 1e 30  1c 06 03 55  04 0a 13 15  52 65 61 6c
|   20 54 69 6d  65 20 45 6e  74 65 72 70  72 69 73 65
|   73 31 0c 30  0a 06 03 55  04 0b 13 03  56 50 4e 31
|   26 30 24 06  03 55 04 03  13 1d 52 54  45 20 56 50
|   4e 20 43 65  72 74 69 66  69 63 61 74  65 20 41 75
|   74 68 6f 72  69 74 79 17  0d 30 33 30  39 32 32 32
|   30 30 31 30  35 5a 17 0d  30 34 30 39  32 31 32 30
|   30 31 30 35  5a 30 0d 06  09 2a 86 48  86 f7 0d 01
|   01 04 05 00  03 82 01 01  00 6b 5b ed  2b 0a f7 5d
|   05 54 cc ed  c1 df 2d aa  f2 6c 42 2f  be 5b d3 c2
|   6a 6d 3c 86  cc ed 12 4f  08 d7 6e b6  68 2e 01 c8
|   64 eb 23 17  db c0 0e bd  b8 13 2a c8  ac 71 a3 f3
|   b0 34 6c 29  91 38 e6 42  6e 32 19 e8  f0 a3 6c a3
|   75 24 b3 32  42 0b d5 3d  6b 8c ff 71  3e 04 59 62
|   a4 01 45 13  65 36 78 c3  38 1a 35 8e  7c 4e c7 a5
|   b3 9b 1f 54  98 bc 16 2c  bc cf 3e 5e  9e 0c d5 7b
|   a3 0c 92 38  5d f7 b8 ba  00 63 69 de  06 b4 a7 98
|   30 8d 14 ea  27 7b 6d 85  22 dd 87 dd  8e 84 bd 30
|   db da 30 7e  ae 5d 6e 5c  e9 45 5c a7  a7 90 cb 0c
|   b0 c2 c2 9f  09 f9 e5 dc  74 7b 72 2c  f9 8d d6 be
|   c0 c4 e7 ae  51 7a 65 3c  74 0a ad f4  e8 43 48 68
|   c2 76 f1 c5  94 37 ec 19  c1 e2 e3 f6  09 34 d2 37
|   7a 5c cc 17  3d 1e 02 50  a1 45 f7 38  42 ee 59 32
|   55 9f f3 bc  bf 00 23 9b  86 71 eb 80  e1 46 13 88
|   29 4c 75 5c  36 00 b2 26  9d
| L1 - tbsCertList:
|   30 81 be 30  0d 06 09 2a  86 48 86 f7  0d 01 01 04
|   05 00 30 81  8e 31 0b 30  09 06 03 55  04 06 13 02
|   55 53 31 12  30 10 06 03  55 04 08 13  09 4d 69 6e
|   6e 65 73 6f  74 61 31 15  30 13 06 03  55 04 07 13
|   0c 45 64 65  6e 20 50 72  61 69 72 69  65 31 1e 30
|   1c 06 03 55  04 0a 13 15  52 65 61 6c  20 54 69 6d
|   65 20 45 6e  74 65 72 70  72 69 73 65  73 31 0c 30
|   0a 06 03 55  04 0b 13 03  56 50 4e 31  26 30 24 06
|   03 55 04 03  13 1d 52 54  45 20 56 50  4e 20 43 65
|   72 74 69 66  69 63 61 74  65 20 41 75  74 68 6f 72
|   69 74 79 17  0d 30 33 30  39 32 32 32  30 30 31 30
|   35 5a 17 0d  30 34 30 39  32 31 32 30  30 31 30 35
|   5a
| L2 - signature:
| L3 - algorithmIdentifier:
| L4 - algorithm:
|   'md5WithRSAEncryption'
| L2 - issuer:
|   30 81 8e 31  0b 30 09 06  03 55 04 06  13 02 55 53
|   31 12 30 10  06 03 55 04  08 13 09 4d  69 6e 6e 65
|   73 6f 74 61  31 15 30 13  06 03 55 04  07 13 0c 45
|   64 65 6e 20  50 72 61 69  72 69 65 31  1e 30 1c 06
|   03 55 04 0a  13 15 52 65  61 6c 20 54  69 6d 65 20
|   45 6e 74 65  72 70 72 69  73 65 73 31  0c 30 0a 06
|   03 55 04 0b  13 03 56 50  4e 31 26 30  24 06 03 55
|   04 03 13 1d  52 54 45 20  56 50 4e 20  43 65 72 74
|   69 66 69 63  61 74 65 20  41 75 74 68  6f 72 69 74
|   79
|   'C=US, ST=Minnesota, L=Eden Prairie, O=Real Time Enterprises, OU=VPN, CN=RTE VPN Certificate Authority'
| L2 - thisUpdate:
| L3 - utcTime:
|   'Sep 22 20:01:05 UTC 2003'
| L2 - nextUpdate:
| L3 - utcTime:
|   'Sep 21 20:01:05 UTC 2004'
| L1 - signatureAlgorithm:
| L2 - algorithmIdentifier:
| L3 - algorithm:
|   'md5WithRSAEncryption'
| L1 - signatureValue:
|   00 6b 5b ed  2b 0a f7 5d  05 54 cc ed  c1 df 2d aa
|   f2 6c 42 2f  be 5b d3 c2  6a 6d 3c 86  cc ed 12 4f
|   08 d7 6e b6  68 2e 01 c8  64 eb 23 17  db c0 0e bd
|   b8 13 2a c8  ac 71 a3 f3  b0 34 6c 29  91 38 e6 42
|   6e 32 19 e8  f0 a3 6c a3  75 24 b3 32  42 0b d5 3d
|   6b 8c ff 71  3e 04 59 62  a4 01 45 13  65 36 78 c3
|   38 1a 35 8e  7c 4e c7 a5  b3 9b 1f 54  98 bc 16 2c
|   bc cf 3e 5e  9e 0c d5 7b  a3 0c 92 38  5d f7 b8 ba
|   00 63 69 de  06 b4 a7 98  30 8d 14 ea  27 7b 6d 85
|   22 dd 87 dd  8e 84 bd 30  db da 30 7e  ae 5d 6e 5c
|   e9 45 5c a7  a7 90 cb 0c  b0 c2 c2 9f  09 f9 e5 dc
|   74 7b 72 2c  f9 8d d6 be  c0 c4 e7 ae  51 7a 65 3c
|   74 0a ad f4  e8 43 48 68  c2 76 f1 c5  94 37 ec 19
|   c1 e2 e3 f6  09 34 d2 37  7a 5c cc 17  3d 1e 02 50
|   a1 45 f7 38  42 ee 59 32  55 9f f3 bc  bf 00 23 9b
|   86 71 eb 80  e1 46 13 88  29 4c 75 5c  36 00 b2 26
|   9d
crl issuer cacert not found for (file:///tmp/ikev2-05-basic-psk/ipsec.d/crls/crashcrl-3.pem)
  loaded crl file 'crashcrl-2.pem' (528 bytes)
|   file content is not binary ASN.1
|   -----BEGIN X509 CRL-----
|   -----END X509 CRL-----
|   file coded in PEM format
| L0 - certificateList:
|   30 82 01 5d  30 81 c7 30  0d 06 09 2a  86 48 86 f7
|   0d 01 01 04  05 00 30 81  81 31 0b 30  09 06 03 55
|   04 06 13 02  64 65 31 0b  30 09 06 03  55 04 08 13
|   02 42 57 31  0b 30 09 06  03 55 04 07  13 02 4b 41
|   31 0f 30 0d  06 03 55 04  0a 13 06 41  73 74 61 72
|   6f 31 14 30  12 06 03 55  04 0b 13 0b  44 65 76 65
|   6c 6f 70 6d  65 6e 74 31  0f 30 0d 06  03 55 04 03
|   13 06 74 65  73 74 63 61  31 20 30 1e  06 09 2a 86
|   48 86 f7 0d  01 09 01 16  11 74 65 73  74 63 61 40
|   61 73 74 61  72 6f 2e 63  6f 6d 17 0d  30 34 30 33
|   30 35 31 30  34 37 31 34  5a 17 0d 30  34 30 35 30
|   34 31 30 34  37 31 34 5a  30 14 30 12  02 01 01 17
|   0d 30 34 30  33 30 35 31  30 34 36 32  31 5a 30 0d
|   06 09 2a 86  48 86 f7 0d  01 01 04 05  00 03 81 81
|   00 67 55 be  f3 fd e9 98  ff eb b6 5e  22 3e ae 14
|   0b 36 c6 88  8a 72 7a f1  9c 3d b9 63  6e 4d 6e d1
|   4b 67 89 40  97 ee b5 49  50 5a ce 15  1a 0b e5 c5
|   bc 6e 82 8e  71 0c a7 55  3b 31 88 05  9b 45 50 b0
|   f2 0e ce 01  e5 f2 6a 8d  e2 5d 9b 77  33 b5 94 3c
|   8e f3 1b bf  86 dd 41 f4  34 54 8c b7  4a 77 0e 0f
|   a3 71 97 37  7f 7e 84 85  ef 7b 97 5b  2c 90 ca 97
|   8a c5 1d bd  60 cc ff ab  72 b8 18 24  48 54 fa ab
|   5e
| L1 - tbsCertList:
|   30 81 c7 30  0d 06 09 2a  86 48 86 f7  0d 01 01 04
|   05 00 30 81  81 31 0b 30  09 06 03 55  04 06 13 02
|   64 65 31 0b  30 09 06 03  55 04 08 13  02 42 57 31
|   0b 30 09 06  03 55 04 07  13 02 4b 41  31 0f 30 0d
|   06 03 55 04  0a 13 06 41  73 74 61 72  6f 31 14 30
|   12 06 03 55  04 0b 13 0b  44 65 76 65  6c 6f 70 6d
|   65 6e 74 31  0f 30 0d 06  03 55 04 03  13 06 74 65
|   73 74 63 61  31 20 30 1e  06 09 2a 86  48 86 f7 0d
|   01 09 01 16  11 74 65 73  74 63 61 40  61 73 74 61
|   72 6f 2e 63  6f 6d 17 0d  30 34 30 33  30 35 31 30
|   34 37 31 34  5a 17 0d 30  34 30 35 30  34 31 30 34
|   37 31 34 5a  30 14 30 12  02 01 01 17  0d 30 34 30
|   33 30 35 31  30 34 36 32  31 5a
| L2 - signature:
| L3 - algorithmIdentifier:
| L4 - algorithm:
|   'md5WithRSAEncryption'
| L2 - issuer:
|   30 81 81 31  0b 30 09 06  03 55 04 06  13 02 64 65
|   31 0b 30 09  06 03 55 04  08 13 02 42  57 31 0b 30
|   09 06 03 55  04 07 13 02  4b 41 31 0f  30 0d 06 03
|   55 04 0a 13  06 41 73 74  61 72 6f 31  14 30 12 06
|   03 55 04 0b  13 0b 44 65  76 65 6c 6f  70 6d 65 6e
|   74 31 0f 30  0d 06 03 55  04 03 13 06  74 65 73 74
|   63 61 31 20  30 1e 06 09  2a 86 48 86  f7 0d 01 09
|   01 16 11 74  65 73 74 63  61 40 61 73  74 61 72 6f
|   2e 63 6f 6d
|   'C=de, ST=BW, L=KA, O=Astaro, OU=Development, CN=testca, E=testca@astaro.com'
| L2 - thisUpdate:
| L3 - utcTime:
|   'Mar 05 10:47:14 UTC 2004'
| L2 - nextUpdate:
| L3 - utcTime:
|   'May 04 10:47:14 UTC 2004'
| L2 - revokedCertificates:
| L3 - certList:
| L4 - userCertificate:
|   01
| L4 - revocationDate:
| L5 - utcTime:
|   'Mar 05 10:46:21 UTC 2004'
| L1 - signatureAlgorithm:
| L2 - algorithmIdentifier:
| L3 - algorithm:
|   'md5WithRSAEncryption'
| L1 - signatureValue:
|   00 67 55 be  f3 fd e9 98  ff eb b6 5e  22 3e ae 14
|   0b 36 c6 88  8a 72 7a f1  9c 3d b9 63  6e 4d 6e d1
|   4b 67 89 40  97 ee b5 49  50 5a ce 15  1a 0b e5 c5
|   bc 6e 82 8e  71 0c a7 55  3b 31 88 05  9b 45 50 b0
|   f2 0e ce 01  e5 f2 6a 8d  e2 5d 9b 77  33 b5 94 3c
|   8e f3 1b bf  86 dd 41 f4  34 54 8c b7  4a 77 0e 0f
|   a3 71 97 37  7f 7e 84 85  ef 7b 97 5b  2c 90 ca 97
|   8a c5 1d bd  60 cc ff ab  72 b8 18 24  48 54 fa ab
|   5e
crl issuer cacert not found for (file:///tmp/ikev2-05-basic-psk/ipsec.d/crls/crashcrl-2.pem)
  loaded crl file 'crashcrl-1.pem' (1053 bytes)
|   file content is not binary ASN.1
|   -----BEGIN X509 CRL-----
|   -----END X509 CRL-----
|   file coded in PEM format
| L0 - certificateList:
|   30 82 02 df  30 81 c8 30  0d 06 09 2a  86 48 86 f7
|   0d 01 01 04  05 00 30 81  98 31 0b 30  09 06 03 55
|   04 06 13 02  41 54 31 13  30 11 06 03  55 04 08 13
|   0a 56 6f 72  61 72 6c 62  65 72 67 31  11 30 0f 06
|   03 55 04 07  13 08 4c 75  73 74 65 6e  61 75 31 21
|   30 1f 06 03  55 04 0a 13  18 4e 65 77  4c 6f 67 69
|   63 20 54 65  63 68 6e 6f  6c 6f 67 69  65 73 20 41
|   47 31 18 30  16 06 03 55  04 03 13 0f  63 61 2e 6e
|   65 77 6c 6f  67 69 63 2e  63 6f 6d 31  24 30 22 06
|   09 2a 86 48  86 f7 0d 01  09 01 16 15  61 64 6d 2d
|   63 65 72 74  40 6e 65 77  6c 6f 67 69  63 2e 63 6f
|   6d 17 0d 30  34 30 33 31  38 30 31 33  36 30 37 5a
|   17 0d 30 34  30 34 31 37  30 31 33 36  30 37 5a 30
|   0d 06 09 2a  86 48 86 f7  0d 01 01 04  05 00 03 82
|   02 01 00 a6  e0 db e2 e7  fe 8d 57 81  04 c1 77 cb
|   bd a8 55 09  74 74 4b ce  66 e6 37 d0  3b a1 39 14
|   4a d2 6c 16  81 8f 55 ba  d5 be bd ed  f0 d7 f4 01
|   b1 13 fd 1b  d0 24 ca d5  9b 0e b2 2f  bd f0 76 d6
|   35 27 82 5f  7f c6 d4 7e  67 eb 09 1d  05 99 d9 b9
|   99 3d eb c7  b5 86 4b 85  1a b4 91 ed  40 31 1b 9c
|   6d 62 0b 5d  40 c2 5c 39  66 eb 75 85  15 8c a5 c5
|   35 f0 dc a6  ed 41 6e c3  30 60 f3 89  49 05 27 06
|   75 6d 67 e0  47 46 0e 73  7e 42 00 13  a8 2d 96 08
|   a4 2a 55 cd  ab 46 f0 38  3f 51 f1 65  9c 0f bc c3
|   fb 8e 4d c6  64 a6 6e 46  53 d3 e6 7a  d3 25 bd 8c
|   83 0d 7a 39  11 74 33 2d  9c b9 15 62  63 9d ae c7
|   4c 48 68 73  6c 81 db 05  31 94 f5 88  e5 6c ff 2c
|   bb 5c ea d2  90 6d 40 b7  3c 8a f0 fb  5e cd 7a 3d
|   66 93 19 2c  81 d7 c3 33  91 92 20 9f  5f 38 58 e0
|   4f e3 5f 2c  f2 ec c9 c0  7a 08 fa 73  94 48 b7 5d
|   5b 46 b1 e9  36 ad 38 d5  d0 b3 b7 3b  43 78 37 ad
|   43 6f 6b 53  91 c4 ff b0  76 d9 96 1d  8a 6a 25 9c
|   23 13 0c dd  6b a1 64 b4  0b 45 62 ba  07 b1 4a c0
|   2a 21 81 2a  d4 3d b8 c7  03 84 33 bf  87 3f de 1a
|   ca 60 b6 2c  ec ff b0 92  bd 2e a0 d5  fd 10 3c bb
|   f1 eb 5e 63  2e 99 42 3a  b4 8f a5 71  e6 08 3d e0
|   13 58 2a 68  1b a9 79 18  b3 1c 8e b4  c2 35 bd f2
|   ad a2 a7 d1  dc 4f 41 a7  a0 54 0a 15  15 97 e5 6a
|   41 95 74 f9  71 1d 63 4a  d0 cd 80 50  b1 6d 08 b7
|   e3 36 91 01  fa e2 4b 62  ea 93 32 47  a6 f3 14 88
|   3c 3f fb 0d  cc 38 1b 19  41 26 a5 0f  d0 00 5c b0
|   8f 04 77 30  c8 ce ea c7  6b e8 a5 bc  25 1d a5 4f
|   d2 3d 4b 04  59 44 ba 01  ad f1 09 df  e4 5d a6 61
|   03 53 a9 29  ba 1f be 18  be c8 73 9f  db 08 1a b4
|   4c 71 3c b7  a0 53 ec 41  87 a3 ac 46  57 3d 54 b2
|   4c a6 97 14  6a 8d 75 fa  70 d7 bf c6  5d 91 e6 66
|   02 df 3d
| L1 - tbsCertList:
|   30 81 c8 30  0d 06 09 2a  86 48 86 f7  0d 01 01 04
|   05 00 30 81  98 31 0b 30  09 06 03 55  04 06 13 02
|   41 54 31 13  30 11 06 03  55 04 08 13  0a 56 6f 72
|   61 72 6c 62  65 72 67 31  11 30 0f 06  03 55 04 07
|   13 08 4c 75  73 74 65 6e  61 75 31 21  30 1f 06 03
|   55 04 0a 13  18 4e 65 77  4c 6f 67 69  63 20 54 65
|   63 68 6e 6f  6c 6f 67 69  65 73 20 41  47 31 18 30
|   16 06 03 55  04 03 13 0f  63 61 2e 6e  65 77 6c 6f
|   67 69 63 2e  63 6f 6d 31  24 30 22 06  09 2a 86 48
|   86 f7 0d 01  09 01 16 15  61 64 6d 2d  63 65 72 74
|   40 6e 65 77  6c 6f 67 69  63 2e 63 6f  6d 17 0d 30
|   34 30 33 31  38 30 31 33  36 30 37 5a  17 0d 30 34
|   30 34 31 37  30 31 33 36  30 37 5a
| L2 - signature:
| L3 - algorithmIdentifier:
| L4 - algorithm:
|   'md5WithRSAEncryption'
| L2 - issuer:
|   30 81 98 31  0b 30 09 06  03 55 04 06  13 02 41 54
|   31 13 30 11  06 03 55 04  08 13 0a 56  6f 72 61 72
|   6c 62 65 72  67 31 11 30  0f 06 03 55  04 07 13 08
|   4c 75 73 74  65 6e 61 75  31 21 30 1f  06 03 55 04
|   0a 13 18 4e  65 77 4c 6f  67 69 63 20  54 65 63 68
|   6e 6f 6c 6f  67 69 65 73  20 41 47 31  18 30 16 06
|   03 55 04 03  13 0f 63 61  2e 6e 65 77  6c 6f 67 69
|   63 2e 63 6f  6d 31 24 30  22 06 09 2a  86 48 86 f7
|   0d 01 09 01  16 15 61 64  6d 2d 63 65  72 74 40 6e
|   65 77 6c 6f  67 69 63 2e  63 6f 6d
|   'C=AT, ST=Vorarlberg, L=Lustenau, O=NewLogic Technologies AG, CN=ca.newlogic.com, E=adm-cert@newlogic.com'
| L2 - thisUpdate:
| L3 - utcTime:
|   'Mar 18 01:36:07 UTC 2004'
| L2 - nextUpdate:
| L3 - utcTime:
|   'Apr 17 01:36:07 UTC 2004'
| L1 - signatureAlgorithm:
| L2 - algorithmIdentifier:
| L3 - algorithm:
|   'md5WithRSAEncryption'
| L1 - signatureValue:
|   00 a6 e0 db  e2 e7 fe 8d  57 81 04 c1  77 cb bd a8
|   55 09 74 74  4b ce 66 e6  37 d0 3b a1  39 14 4a d2
|   6c 16 81 8f  55 ba d5 be  bd ed f0 d7  f4 01 b1 13
|   fd 1b d0 24  ca d5 9b 0e  b2 2f bd f0  76 d6 35 27
|   82 5f 7f c6  d4 7e 67 eb  09 1d 05 99  d9 b9 99 3d
|   eb c7 b5 86  4b 85 1a b4  91 ed 40 31  1b 9c 6d 62
|   0b 5d 40 c2  5c 39 66 eb  75 85 15 8c  a5 c5 35 f0
|   dc a6 ed 41  6e c3 30 60  f3 89 49 05  27 06 75 6d
|   67 e0 47 46  0e 73 7e 42  00 13 a8 2d  96 08 a4 2a
|   55 cd ab 46  f0 38 3f 51  f1 65 9c 0f  bc c3 fb 8e
|   4d c6 64 a6  6e 46 53 d3  e6 7a d3 25  bd 8c 83 0d
|   7a 39 11 74  33 2d 9c b9  15 62 63 9d  ae c7 4c 48
|   68 73 6c 81  db 05 31 94  f5 88 e5 6c  ff 2c bb 5c
|   ea d2 90 6d  40 b7 3c 8a  f0 fb 5e cd  7a 3d 66 93
|   19 2c 81 d7  c3 33 91 92  20 9f 5f 38  58 e0 4f e3
|   5f 2c f2 ec  c9 c0 7a 08  fa 73 94 48  b7 5d 5b 46
|   b1 e9 36 ad  38 d5 d0 b3  b7 3b 43 78  37 ad 43 6f
|   6b 53 91 c4  ff b0 76 d9  96 1d 8a 6a  25 9c 23 13
|   0c dd 6b a1  64 b4 0b 45  62 ba 07 b1  4a c0 2a 21
|   81 2a d4 3d  b8 c7 03 84  33 bf 87 3f  de 1a ca 60
|   b6 2c ec ff  b0 92 bd 2e  a0 d5 fd 10  3c bb f1 eb
|   5e 63 2e 99  42 3a b4 8f  a5 71 e6 08  3d e0 13 58
|   2a 68 1b a9  79 18 b3 1c  8e b4 c2 35  bd f2 ad a2
|   a7 d1 dc 4f  41 a7 a0 54  0a 15 15 97  e5 6a 41 95
|   74 f9 71 1d  63 4a d0 cd  80 50 b1 6d  08 b7 e3 36
|   91 01 fa e2  4b 62 ea 93  32 47 a6 f3  14 88 3c 3f
|   fb 0d cc 38  1b 19 41 26  a5 0f d0 00  5c b0 8f 04
|   77 30 c8 ce  ea c7 6b e8  a5 bc 25 1d  a5 4f d2 3d
|   4b 04 59 44  ba 01 ad f1  09 df e4 5d  a6 61 03 53
|   a9 29 ba 1f  be 18 be c8  73 9f db 08  1a b4 4c 71
|   3c b7 a0 53  ec 41 87 a3  ac 46 57 3d  54 b2 4c a6
|   97 14 6a 8d  75 fa 70 d7  bf c6 5d 91  e6 66 02 df
|   3d
crl issuer cacert not found for (file:///tmp/ikev2-05-basic-psk/ipsec.d/crls/crashcrl-1.pem)
| inserting event EVENT_LOG_DAILY, timeout in 7574 seconds
| next event EVENT_SHUNT_SCAN in 120 seconds
! helper 0 waiting on fd: 7
|  
| *received whack message
listening for IKE messages
| found ipsec0 with address 192.1.2.45
| found eth0 with address 192.0.1.254
| found eth1 with address 192.1.2.45
| found eth2 with address 192.9.4.45
| found lo with address 127.0.0.1
| IP interface lo 127.0.0.1 has no matching ipsec* interface -- ignored
| IP interface eth2 192.9.4.45 has no matching ipsec* interface -- ignored
adding interface ipsec0/eth1 192.1.2.45:500
| IP interface eth0 192.0.1.254 has no matching ipsec* interface -- ignored
| could not open /proc/net/if_inet6
loading secrets from "/tmp/ikev2-05-basic-psk/ipsec.secrets"
loaded private key for keyid: PPK_RSA:AQNzGEFs1
| id type added to secret(0x813f1f8) 1: C=ca, ST=Ontario, O=Xelerance, CN=west.xelerance.com, E=testing@xelerance.com
| id type added to secret(0x813f1f8) 1: %any
  could not open private key file '/etc/ipsec.d/private/west.key'
"/tmp/ikev2-05-basic-psk/ipsec.secrets" line 27: error loading RSA private key file
| id type added to secret(0x813f5c8) 1: @west
| id type added to secret(0x813f5c8) 1: @east
| Processing PSK at line 27: passed
| * processed 0 messages from cryptographic helpers 
| next event EVENT_SHUNT_SCAN in 119 seconds
|  
| *received whack message
| started recording whack messages to /var/tmp/ikev2.record 
| * processed 0 messages from cryptographic helpers 
| next event EVENT_SHUNT_SCAN in 119 seconds
|  
| *received whack message
| Added new connection westnet--eastnet-ikev2 with policy PSK+ENCRYPT+TUNNEL+PFS+!IKEv1+IKEv2ALLOW+IKEv2Init
| counting wild cards for @west is 0
| counting wild cards for @east is 0
| connect_to_host_pair: 192.1.2.45:500 192.1.2.23:500 -> hp:none 
added connection description "westnet--eastnet-ikev2"
| 192.0.1.0/24===192.1.2.45<192.1.2.45>[@west,S=C]...192.1.2.23<192.1.2.23>[@east,S=C]===192.0.2.0/24
| ike_life: 3600s; ipsec_life: 28800s; rekey_margin: 540s; rekey_fuzz: 100%; keyingtries: 3; policy: PSK+ENCRYPT+TUNNEL+PFS+!IKEv1+IKEv2ALLOW+IKEv2Init
| * processed 0 messages from cryptographic helpers 
| next event EVENT_SHUNT_SCAN in 119 seconds
|  
| *received whack message
| * processed 0 messages from cryptographic helpers 
| next event EVENT_SHUNT_SCAN in 119 seconds
|  
| *received whack message
listening for IKE messages
| found ipsec0 with address 192.1.2.45
| found eth0 with address 192.0.1.254
| found eth1 with address 192.1.2.45
| found eth2 with address 192.9.4.45
| found lo with address 127.0.0.1
| IP interface lo 127.0.0.1 has no matching ipsec* interface -- ignored
| IP interface eth2 192.9.4.45 has no matching ipsec* interface -- ignored
| IP interface eth0 192.0.1.254 has no matching ipsec* interface -- ignored
| could not open /proc/net/if_inet6
forgetting secrets
loading secrets from "/tmp/ikev2-05-basic-psk/ipsec.secrets"
loaded private key for keyid: PPK_RSA:AQNzGEFs1
| id type added to secret(0x813f4b0) 1: C=ca, ST=Ontario, O=Xelerance, CN=west.xelerance.com, E=testing@xelerance.com
| id type added to secret(0x813f4b0) 1: %any
  could not open private key file '/etc/ipsec.d/private/west.key'
"/tmp/ikev2-05-basic-psk/ipsec.secrets" line 27: error loading RSA private key file
| id type added to secret(0x813f4b0) 1: @west
| id type added to secret(0x813f4b0) 1: @east
| Processing PSK at line 27: passed
| * processed 0 messages from cryptographic helpers 
| next event EVENT_SHUNT_SCAN in 119 seconds
|  
| *received whack message
listening for IKE messages
| found ipsec0 with address 192.1.2.45
| found eth0 with address 192.0.1.254
| found eth1 with address 192.1.2.45
| found eth2 with address 192.9.4.45
| found lo with address 127.0.0.1
| IP interface lo 127.0.0.1 has no matching ipsec* interface -- ignored
| IP interface eth2 192.9.4.45 has no matching ipsec* interface -- ignored
| IP interface eth0 192.0.1.254 has no matching ipsec* interface -- ignored
| could not open /proc/net/if_inet6
forgetting secrets
loading secrets from "/tmp/ikev2-05-basic-psk/ipsec.secrets"
loaded private key for keyid: PPK_RSA:AQNzGEFs1
| id type added to secret(0x813f4b0) 1: C=ca, ST=Ontario, O=Xelerance, CN=west.xelerance.com, E=testing@xelerance.com
| id type added to secret(0x813f4b0) 1: %any
  could not open private key file '/etc/ipsec.d/private/west.key'
"/tmp/ikev2-05-basic-psk/ipsec.secrets" line 27: error loading RSA private key file
| id type added to secret(0x81410c0) 1: @west
| id type added to secret(0x81410c0) 1: @east
| Processing PSK at line 27: passed
| * processed 0 messages from cryptographic helpers 
| next event EVENT_SHUNT_SCAN in 117 seconds
|  
| *received whack message
listening for IKE messages
| found ipsec0 with address 192.1.2.45
| found eth0 with address 192.0.1.254
| found eth1 with address 192.1.2.45
| found eth2 with address 192.9.4.45
| found lo with address 127.0.0.1
| IP interface lo 127.0.0.1 has no matching ipsec* interface -- ignored
| IP interface eth2 192.9.4.45 has no matching ipsec* interface -- ignored
| IP interface eth0 192.0.1.254 has no matching ipsec* interface -- ignored
| could not open /proc/net/if_inet6
forgetting secrets
loading secrets from "/tmp/ikev2-05-basic-psk/ipsec.secrets"
loaded private key for keyid: PPK_RSA:AQNzGEFs1
| id type added to secret(0x8140188) 1: C=ca, ST=Ontario, O=Xelerance, CN=west.xelerance.com, E=testing@xelerance.com
| id type added to secret(0x8140188) 1: %any
  could not open private key file '/etc/ipsec.d/private/west.key'
"/tmp/ikev2-05-basic-psk/ipsec.secrets" line 27: error loading RSA private key file
| id type added to secret(0x8140188) 1: @west
| id type added to secret(0x8140188) 1: @east
| Processing PSK at line 27: passed
| * processed 0 messages from cryptographic helpers 
| next event EVENT_SHUNT_SCAN in 115 seconds
|  
| *received whack message
listening for IKE messages
| found ipsec0 with address 192.1.2.45
| found eth0 with address 192.0.1.254
| found eth1 with address 192.1.2.45
| found eth2 with address 192.9.4.45
| found lo with address 127.0.0.1
| IP interface lo 127.0.0.1 has no matching ipsec* interface -- ignored
| IP interface eth2 192.9.4.45 has no matching ipsec* interface -- ignored
| IP interface eth0 192.0.1.254 has no matching ipsec* interface -- ignored
| could not open /proc/net/if_inet6
forgetting secrets
loading secrets from "/tmp/ikev2-05-basic-psk/ipsec.secrets"
loaded private key for keyid: PPK_RSA:AQNzGEFs1
| id type added to secret(0x8142388) 1: C=ca, ST=Ontario, O=Xelerance, CN=west.xelerance.com, E=testing@xelerance.com
| id type added to secret(0x8142388) 1: %any
  could not open private key file '/etc/ipsec.d/private/west.key'
"/tmp/ikev2-05-basic-psk/ipsec.secrets" line 27: error loading RSA private key file
| id type added to secret(0x8142388) 1: @west
| id type added to secret(0x8142388) 1: @east
| Processing PSK at line 27: passed
| * processed 0 messages from cryptographic helpers 
| next event EVENT_SHUNT_SCAN in 113 seconds
|  
| *received whack message
listening for IKE messages
| found ipsec0 with address 192.1.2.45
| found eth0 with address 192.0.1.254
| found eth1 with address 192.1.2.45
| found eth2 with address 192.9.4.45
| found lo with address 127.0.0.1
| IP interface lo 127.0.0.1 has no matching ipsec* interface -- ignored
| IP interface eth2 192.9.4.45 has no matching ipsec* interface -- ignored
| IP interface eth0 192.0.1.254 has no matching ipsec* interface -- ignored
| could not open /proc/net/if_inet6
forgetting secrets
loading secrets from "/tmp/ikev2-05-basic-psk/ipsec.secrets"
loaded private key for keyid: PPK_RSA:AQNzGEFs1
| id type added to secret(0x8140108) 1: C=ca, ST=Ontario, O=Xelerance, CN=west.xelerance.com, E=testing@xelerance.com
| id type added to secret(0x8140108) 1: %any
  could not open private key file '/etc/ipsec.d/private/west.key'
"/tmp/ikev2-05-basic-psk/ipsec.secrets" line 27: error loading RSA private key file
| id type added to secret(0x8140108) 1: @west
| id type added to secret(0x8140108) 1: @east
| Processing PSK at line 27: passed
| * processed 0 messages from cryptographic helpers 
| next event EVENT_SHUNT_SCAN in 110 seconds
|  
| *received whack message
listening for IKE messages
| found ipsec0 with address 192.1.2.45
| found eth0 with address 192.0.1.254
| found eth1 with address 192.1.2.45
| found eth2 with address 192.9.4.45
| found lo with address 127.0.0.1
| IP interface lo 127.0.0.1 has no matching ipsec* interface -- ignored
| IP interface eth2 192.9.4.45 has no matching ipsec* interface -- ignored
| IP interface eth0 192.0.1.254 has no matching ipsec* interface -- ignored
| could not open /proc/net/if_inet6
forgetting secrets
loading secrets from "/tmp/ikev2-05-basic-psk/ipsec.secrets"
loaded private key for keyid: PPK_RSA:AQNzGEFs1
| id type added to secret(0x8140100) 1: C=ca, ST=Ontario, O=Xelerance, CN=west.xelerance.com, E=testing@xelerance.com
| id type added to secret(0x8140100) 1: %any
  could not open private key file '/etc/ipsec.d/private/west.key'
"/tmp/ikev2-05-basic-psk/ipsec.secrets" line 27: error loading RSA private key file
| id type added to secret(0x8140100) 1: @west
| id type added to secret(0x8140100) 1: @east
| Processing PSK at line 27: passed
| * processed 0 messages from cryptographic helpers 
| next event EVENT_SHUNT_SCAN in 108 seconds
|  
| *received whack message
listening for IKE messages
| found ipsec0 with address 192.1.2.45
| found eth0 with address 192.0.1.254
| found eth1 with address 192.1.2.45
| found eth2 with address 192.9.4.45
| found lo with address 127.0.0.1
| IP interface lo 127.0.0.1 has no matching ipsec* interface -- ignored
| IP interface eth2 192.9.4.45 has no matching ipsec* interface -- ignored
| IP interface eth0 192.0.1.254 has no matching ipsec* interface -- ignored
| could not open /proc/net/if_inet6
forgetting secrets
loading secrets from "/tmp/ikev2-05-basic-psk/ipsec.secrets"
loaded private key for keyid: PPK_RSA:AQNzGEFs1
| id type added to secret(0x8140108) 1: C=ca, ST=Ontario, O=Xelerance, CN=west.xelerance.com, E=testing@xelerance.com
| id type added to secret(0x8140108) 1: %any
  could not open private key file '/etc/ipsec.d/private/west.key'
"/tmp/ikev2-05-basic-psk/ipsec.secrets" line 27: error loading RSA private key file
| id type added to secret(0x8140108) 1: @west
| id type added to secret(0x8140108) 1: @east
| Processing PSK at line 27: passed
| * processed 0 messages from cryptographic helpers 
| next event EVENT_SHUNT_SCAN in 106 seconds
|  
| *received whack message
listening for IKE messages
| found ipsec0 with address 192.1.2.45
| found eth0 with address 192.0.1.254
| found eth1 with address 192.1.2.45
| found eth2 with address 192.9.4.45
| found lo with address 127.0.0.1
| IP interface lo 127.0.0.1 has no matching ipsec* interface -- ignored
| IP interface eth2 192.9.4.45 has no matching ipsec* interface -- ignored
| IP interface eth0 192.0.1.254 has no matching ipsec* interface -- ignored
| could not open /proc/net/if_inet6
forgetting secrets
loading secrets from "/tmp/ikev2-05-basic-psk/ipsec.secrets"
loaded private key for keyid: PPK_RSA:AQNzGEFs1
| id type added to secret(0x8140108) 1: C=ca, ST=Ontario, O=Xelerance, CN=west.xelerance.com, E=testing@xelerance.com
| id type added to secret(0x8140108) 1: %any
  could not open private key file '/etc/ipsec.d/private/west.key'
"/tmp/ikev2-05-basic-psk/ipsec.secrets" line 27: error loading RSA private key file
| id type added to secret(0x8140108) 1: @west
| id type added to secret(0x8140108) 1: @east
| Processing PSK at line 27: passed
| * processed 0 messages from cryptographic helpers 
| next event EVENT_SHUNT_SCAN in 104 seconds
|  
| *received whack message
listening for IKE messages
| found ipsec0 with address 192.1.2.45
| found eth0 with address 192.0.1.254
| found eth1 with address 192.1.2.45
| found eth2 with address 192.9.4.45
| found lo with address 127.0.0.1
| IP interface lo 127.0.0.1 has no matching ipsec* interface -- ignored
| IP interface eth2 192.9.4.45 has no matching ipsec* interface -- ignored
| IP interface eth0 192.0.1.254 has no matching ipsec* interface -- ignored
| could not open /proc/net/if_inet6
forgetting secrets
loading secrets from "/tmp/ikev2-05-basic-psk/ipsec.secrets"
loaded private key for keyid: PPK_RSA:AQNzGEFs1
| id type added to secret(0x8142280) 1: C=ca, ST=Ontario, O=Xelerance, CN=west.xelerance.com, E=testing@xelerance.com
| id type added to secret(0x8142280) 1: %any
  could not open private key file '/etc/ipsec.d/private/west.key'
"/tmp/ikev2-05-basic-psk/ipsec.secrets" line 27: error loading RSA private key file
| id type added to secret(0x8142280) 1: @west
| id type added to secret(0x8142280) 1: @east
| Processing PSK at line 27: passed
| * processed 0 messages from cryptographic helpers 
| next event EVENT_SHUNT_SCAN in 102 seconds
|  
| *received whack message
listening for IKE messages
| found ipsec0 with address 192.1.2.45
| found eth0 with address 192.0.1.254
| found eth1 with address 192.1.2.45
| found eth2 with address 192.9.4.45
| found lo with address 127.0.0.1
| IP interface lo 127.0.0.1 has no matching ipsec* interface -- ignored
| IP interface eth2 192.9.4.45 has no matching ipsec* interface -- ignored
| IP interface eth0 192.0.1.254 has no matching ipsec* interface -- ignored
| could not open /proc/net/if_inet6
forgetting secrets
loading secrets from "/tmp/ikev2-05-basic-psk/ipsec.secrets"
loaded private key for keyid: PPK_RSA:AQNzGEFs1
| id type added to secret(0x81447f0) 1: C=ca, ST=Ontario, O=Xelerance, CN=west.xelerance.com, E=testing@xelerance.com
| id type added to secret(0x81447f0) 1: %any
  could not open private key file '/etc/ipsec.d/private/west.key'
"/tmp/ikev2-05-basic-psk/ipsec.secrets" line 27: error loading RSA private key file
| id type added to secret(0x81447f0) 1: @west
| id type added to secret(0x81447f0) 1: @east
| Processing PSK at line 27: passed
| * processed 0 messages from cryptographic helpers 
| next event EVENT_SHUNT_SCAN in 100 seconds
|  
| *received whack message
listening for IKE messages
| found ipsec0 with address 192.1.2.45
| found eth0 with address 192.0.1.254
| found eth1 with address 192.1.2.45
| found eth2 with address 192.9.4.45
| found lo with address 127.0.0.1
| IP interface lo 127.0.0.1 has no matching ipsec* interface -- ignored
| IP interface eth2 192.9.4.45 has no matching ipsec* interface -- ignored
| IP interface eth0 192.0.1.254 has no matching ipsec* interface -- ignored
| could not open /proc/net/if_inet6
forgetting secrets
loading secrets from "/tmp/ikev2-05-basic-psk/ipsec.secrets"
loaded private key for keyid: PPK_RSA:AQNzGEFs1
| id type added to secret(0x8142280) 1: C=ca, ST=Ontario, O=Xelerance, CN=west.xelerance.com, E=testing@xelerance.com
| id type added to secret(0x8142280) 1: %any
  could not open private key file '/etc/ipsec.d/private/west.key'
"/tmp/ikev2-05-basic-psk/ipsec.secrets" line 27: error loading RSA private key file
| id type added to secret(0x8142280) 1: @west
| id type added to secret(0x8142280) 1: @east
| Processing PSK at line 27: passed
| * processed 0 messages from cryptographic helpers 
| next event EVENT_SHUNT_SCAN in 98 seconds
|  
| *received whack message
listening for IKE messages
| found ipsec0 with address 192.1.2.45
| found eth0 with address 192.0.1.254
| found eth1 with address 192.1.2.45
| found eth2 with address 192.9.4.45
| found lo with address 127.0.0.1
| IP interface lo 127.0.0.1 has no matching ipsec* interface -- ignored
| IP interface eth2 192.9.4.45 has no matching ipsec* interface -- ignored
| IP interface eth0 192.0.1.254 has no matching ipsec* interface -- ignored
| could not open /proc/net/if_inet6
forgetting secrets
loading secrets from "/tmp/ikev2-05-basic-psk/ipsec.secrets"
loaded private key for keyid: PPK_RSA:AQNzGEFs1
| id type added to secret(0x81447f0) 1: C=ca, ST=Ontario, O=Xelerance, CN=west.xelerance.com, E=testing@xelerance.com
| id type added to secret(0x81447f0) 1: %any
  could not open private key file '/etc/ipsec.d/private/west.key'
"/tmp/ikev2-05-basic-psk/ipsec.secrets" line 27: error loading RSA private key file
| id type added to secret(0x81447f0) 1: @west
| id type added to secret(0x81447f0) 1: @east
| Processing PSK at line 27: passed
| * processed 0 messages from cryptographic helpers 
| next event EVENT_SHUNT_SCAN in 96 seconds
|  
| *received whack message
listening for IKE messages
| found ipsec0 with address 192.1.2.45
| found eth0 with address 192.0.1.254
| found eth1 with address 192.1.2.45
| found eth2 with address 192.9.4.45
| found lo with address 127.0.0.1
| IP interface lo 127.0.0.1 has no matching ipsec* interface -- ignored
| IP interface eth2 192.9.4.45 has no matching ipsec* interface -- ignored
| IP interface eth0 192.0.1.254 has no matching ipsec* interface -- ignored
| could not open /proc/net/if_inet6
forgetting secrets
loading secrets from "/tmp/ikev2-05-basic-psk/ipsec.secrets"
loaded private key for keyid: PPK_RSA:AQNzGEFs1
| id type added to secret(0x8142280) 1: C=ca, ST=Ontario, O=Xelerance, CN=west.xelerance.com, E=testing@xelerance.com
| id type added to secret(0x8142280) 1: %any
  could not open private key file '/etc/ipsec.d/private/west.key'
"/tmp/ikev2-05-basic-psk/ipsec.secrets" line 27: error loading RSA private key file
| id type added to secret(0x8142280) 1: @west
| id type added to secret(0x8142280) 1: @east
| Processing PSK at line 27: passed
| * processed 0 messages from cryptographic helpers 
| next event EVENT_SHUNT_SCAN in 94 seconds
|  
| *received whack message
listening for IKE messages
| found ipsec0 with address 192.1.2.45
| found eth0 with address 192.0.1.254
| found eth1 with address 192.1.2.45
| found eth2 with address 192.9.4.45
| found lo with address 127.0.0.1
| IP interface lo 127.0.0.1 has no matching ipsec* interface -- ignored
| IP interface eth2 192.9.4.45 has no matching ipsec* interface -- ignored
| IP interface eth0 192.0.1.254 has no matching ipsec* interface -- ignored
| could not open /proc/net/if_inet6
forgetting secrets
loading secrets from "/tmp/ikev2-05-basic-psk/ipsec.secrets"
loaded private key for keyid: PPK_RSA:AQNzGEFs1
| id type added to secret(0x81480a0) 1: C=ca, ST=Ontario, O=Xelerance, CN=west.xelerance.com, E=testing@xelerance.com
| id type added to secret(0x81480a0) 1: %any
  could not open private key file '/etc/ipsec.d/private/west.key'
"/tmp/ikev2-05-basic-psk/ipsec.secrets" line 27: error loading RSA private key file
| id type added to secret(0x8143ed0) 1: @west
| id type added to secret(0x8143ed0) 1: @east
| Processing PSK at line 27: passed
| * processed 0 messages from cryptographic helpers 
| next event EVENT_SHUNT_SCAN in 92 seconds
|  
| *received whack message
listening for IKE messages
| found ipsec0 with address 192.1.2.45
| found eth0 with address 192.0.1.254
| found eth1 with address 192.1.2.45
| found eth2 with address 192.9.4.45
| found lo with address 127.0.0.1
| IP interface lo 127.0.0.1 has no matching ipsec* interface -- ignored
| IP interface eth2 192.9.4.45 has no matching ipsec* interface -- ignored
| IP interface eth0 192.0.1.254 has no matching ipsec* interface -- ignored
| could not open /proc/net/if_inet6
forgetting secrets
loading secrets from "/tmp/ikev2-05-basic-psk/ipsec.secrets"
loaded private key for keyid: PPK_RSA:AQNzGEFs1
| id type added to secret(0x81447f0) 1: C=ca, ST=Ontario, O=Xelerance, CN=west.xelerance.com, E=testing@xelerance.com
| id type added to secret(0x81447f0) 1: %any
  could not open private key file '/etc/ipsec.d/private/west.key'
"/tmp/ikev2-05-basic-psk/ipsec.secrets" line 27: error loading RSA private key file
| id type added to secret(0x81447f0) 1: @west
| id type added to secret(0x81447f0) 1: @east
| Processing PSK at line 27: passed
| * processed 0 messages from cryptographic helpers 
| next event EVENT_SHUNT_SCAN in 90 seconds
|  
| *received whack message
listening for IKE messages
| found ipsec0 with address 192.1.2.45
| found eth0 with address 192.0.1.254
| found eth1 with address 192.1.2.45
| found eth2 with address 192.9.4.45
| found lo with address 127.0.0.1
| IP interface lo 127.0.0.1 has no matching ipsec* interface -- ignored
| IP interface eth2 192.9.4.45 has no matching ipsec* interface -- ignored
| IP interface eth0 192.0.1.254 has no matching ipsec* interface -- ignored
| could not open /proc/net/if_inet6
forgetting secrets
loading secrets from "/tmp/ikev2-05-basic-psk/ipsec.secrets"
loaded private key for keyid: PPK_RSA:AQNzGEFs1
| id type added to secret(0x81491c0) 1: C=ca, ST=Ontario, O=Xelerance, CN=west.xelerance.com, E=testing@xelerance.com
| id type added to secret(0x81491c0) 1: %any
  could not open private key file '/etc/ipsec.d/private/west.key'
"/tmp/ikev2-05-basic-psk/ipsec.secrets" line 27: error loading RSA private key file
| id type added to secret(0x81491c0) 1: @west
| id type added to secret(0x81491c0) 1: @east
| Processing PSK at line 27: passed
| * processed 0 messages from cryptographic helpers 
| next event EVENT_SHUNT_SCAN in 88 seconds
|  
| *received whack message
listening for IKE messages
| found ipsec0 with address 192.1.2.45
| found eth0 with address 192.0.1.254
| found eth1 with address 192.1.2.45
| found eth2 with address 192.9.4.45
| found lo with address 127.0.0.1
| IP interface lo 127.0.0.1 has no matching ipsec* interface -- ignored
| IP interface eth2 192.9.4.45 has no matching ipsec* interface -- ignored
| IP interface eth0 192.0.1.254 has no matching ipsec* interface -- ignored
| could not open /proc/net/if_inet6
forgetting secrets
loading secrets from "/tmp/ikev2-05-basic-psk/ipsec.secrets"
loaded private key for keyid: PPK_RSA:AQNzGEFs1
| id type added to secret(0x81480a0) 1: C=ca, ST=Ontario, O=Xelerance, CN=west.xelerance.com, E=testing@xelerance.com
| id type added to secret(0x81480a0) 1: %any
  could not open private key file '/etc/ipsec.d/private/west.key'
"/tmp/ikev2-05-basic-psk/ipsec.secrets" line 27: error loading RSA private key file
| id type added to secret(0x81480a0) 1: @west
| id type added to secret(0x81480a0) 1: @east
| Processing PSK at line 27: passed
| * processed 0 messages from cryptographic helpers 
| next event EVENT_SHUNT_SCAN in 86 seconds
|  
| *received whack message
listening for IKE messages
| found ipsec0 with address 192.1.2.45
| found eth0 with address 192.0.1.254
| found eth1 with address 192.1.2.45
| found eth2 with address 192.9.4.45
| found lo with address 127.0.0.1
| IP interface lo 127.0.0.1 has no matching ipsec* interface -- ignored
| IP interface eth2 192.9.4.45 has no matching ipsec* interface -- ignored
| IP interface eth0 192.0.1.254 has no matching ipsec* interface -- ignored
| could not open /proc/net/if_inet6
forgetting secrets
loading secrets from "/tmp/ikev2-05-basic-psk/ipsec.secrets"
loaded private key for keyid: PPK_RSA:AQNzGEFs1
| id type added to secret(0x8147568) 1: C=ca, ST=Ontario, O=Xelerance, CN=west.xelerance.com, E=testing@xelerance.com
| id type added to secret(0x8147568) 1: %any
  could not open private key file '/etc/ipsec.d/private/west.key'
"/tmp/ikev2-05-basic-psk/ipsec.secrets" line 27: error loading RSA private key file
| id type added to secret(0x8147568) 1: @west
| id type added to secret(0x8147568) 1: @east
| Processing PSK at line 27: passed
| * processed 0 messages from cryptographic helpers 
| next event EVENT_SHUNT_SCAN in 83 seconds
|  
| *received whack message
listening for IKE messages
| found ipsec0 with address 192.1.2.45
| found eth0 with address 192.0.1.254
| found eth1 with address 192.1.2.45
| found eth2 with address 192.9.4.45
| found lo with address 127.0.0.1
| IP interface lo 127.0.0.1 has no matching ipsec* interface -- ignored
| IP interface eth2 192.9.4.45 has no matching ipsec* interface -- ignored
| IP interface eth0 192.0.1.254 has no matching ipsec* interface -- ignored
| could not open /proc/net/if_inet6
forgetting secrets
loading secrets from "/tmp/ikev2-05-basic-psk/ipsec.secrets"
loaded private key for keyid: PPK_RSA:AQNzGEFs1
| id type added to secret(0x814a4f8) 1: C=ca, ST=Ontario, O=Xelerance, CN=west.xelerance.com, E=testing@xelerance.com
| id type added to secret(0x814a4f8) 1: %any
  could not open private key file '/etc/ipsec.d/private/west.key'
"/tmp/ikev2-05-basic-psk/ipsec.secrets" line 27: error loading RSA private key file
| id type added to secret(0x81491c0) 1: @west
| id type added to secret(0x81491c0) 1: @east
| Processing PSK at line 27: passed
| * processed 0 messages from cryptographic helpers 
| next event EVENT_SHUNT_SCAN in 81 seconds
|  
| *received whack message
listening for IKE messages
| found ipsec0 with address 192.1.2.45
| found eth0 with address 192.0.1.254
| found eth1 with address 192.1.2.45
| found eth2 with address 192.9.4.45
| found lo with address 127.0.0.1
| IP interface lo 127.0.0.1 has no matching ipsec* interface -- ignored
| IP interface eth2 192.9.4.45 has no matching ipsec* interface -- ignored
| IP interface eth0 192.0.1.254 has no matching ipsec* interface -- ignored
| could not open /proc/net/if_inet6
forgetting secrets
loading secrets from "/tmp/ikev2-05-basic-psk/ipsec.secrets"
loaded private key for keyid: PPK_RSA:AQNzGEFs1
| id type added to secret(0x814b728) 1: C=ca, ST=Ontario, O=Xelerance, CN=west.xelerance.com, E=testing@xelerance.com
| id type added to secret(0x814b728) 1: %any
  could not open private key file '/etc/ipsec.d/private/west.key'
"/tmp/ikev2-05-basic-psk/ipsec.secrets" line 27: error loading RSA private key file
| id type added to secret(0x814a4f8) 1: @west
| id type added to secret(0x814a4f8) 1: @east
| Processing PSK at line 27: passed
| * processed 0 messages from cryptographic helpers 
| next event EVENT_SHUNT_SCAN in 79 seconds
|  
| *received whack message
| processing connection westnet--eastnet-ikev2
| empty esp_info, returning defaults
| creating state object #1 at 0x814c0c0
| processing connection westnet--eastnet-ikev2
| ICOOKIE:  e8 05 90 ca  d2 3a ee 04
| RCOOKIE:  00 00 00 00  00 00 00 00
| state hash entry 5
| inserting state object #1 on chain 5
| inserting event EVENT_SO_DISCARD, timeout in 0 seconds for #1
| processing connection westnet--eastnet-ikev2
| Queuing pending Quick Mode with 192.1.2.23 "westnet--eastnet-ikev2"
"westnet--eastnet-ikev2" #1: initiating v2 parent SA
| no IKE algorithms for this connection 
| 0: w->pcw_dead: 0 w->pcw_work: 0 cnt: 1
| asking helper 0 to do build_kenonce op on seq: 1 (len=2668, pcw_work=1)
| crypto helper write of request: cnt=2668<wlen=2668.  
| inserting event EVENT_CRYPTO_FAILED, timeout in 300 seconds for #1
| * processed 0 messages from cryptographic helpers 
| next event EVENT_SHUNT_SCAN in 76 seconds
! helper 0 read 2664+4/2668 bytesfd: 7
! helper 0 doing build_kenonce op id: 1
! Local DH secret:
!   ae 15 c2 b8  04 32 16 d6  ed 11 47 7a  c6 1e c7 81
!   f0 81 84 df  3b 82 7b e6  98 6f 2a 6f  72 65 db 9a
! Public DH value sent:
!   fa 16 28 78  76 7c 83 55  bd 3d c9 94  b8 f4 6f a7
!   5f a6 91 77  cc 4a eb 65  49 32 2c 03  63 35 ee 02
!   c8 64 ca 5e  2e 6e 54 8d  c3 0f dc a8  a5 33 2d 7f
!   ee 3b 5b a7  7e 87 0f a4  43 86 8a d7  bd bc 62 65
!   a5 da 06 36  d5 67 b7 9d  e5 e5 10 5c  4e f2 55 d9
!   24 ed 20 a5  b9 db 69 7f  4a 7c 3f 32  d5 db 26 50
!   31 a7 5a e2  a8 7a 56 77  72 d0 68 8c  60 e4 12 37
!   21 86 92 35  ff d6 ac 09  ad 1d 80 6f  bf 0e 84 d3
!   55 21 41 5d  76 a9 11 0b  29 d3 0e 8c  f4 36 44 b2
!   0a 6f 35 a9  70 7c f2 5c  66 00 67 a3  83 73 44 15
!   ce a5 41 58  04 c1 06 e2  77 c3 b3 83  b9 1b d0 8a
!   ca 4e 19 c7  f6 13 17 30  ba 2a f0 8c  55 c5 1e 37
!   c9 84 07 68  ae 9c bc ee  68 5c ce eb  d4 be a7 18
!   80 8d 9e e3  52 00 bc 6d  91 87 d6 a8  81 7a a2 0a
!   aa 36 f6 fa  9d 0c 51 e3  bf 63 6b 2b  25 c9 cb 38
!   26 99 1b 03  1d 66 50 ed  9e 71 a3 df  11 77 7b 89
! Generated nonce:
!   6b 98 11 b2  fe e7 5c 89  de 6a 5f 3d  14 83 b6 25
|  
| helper 0 has finished work (cnt now 1)
| helper 0 replies to id: q#1
| calling callback function 0x807591c
| ikev2 parent outI1: calculated ke+nonce, sending I1
| processing connection westnet--eastnet-ikev2
| **emit ISAKMP Message:
|    initiator cookie:
|   e8 05 90 ca  d2 3a ee 04
|    responder cookie:
|   00 00 00 00  00 00 00 00
|    next payload type: ISAKMP_NEXT_v2SA
|    ISAKMP version: IKEv2 version 2.0 (rfc4306)
|    exchange type: ISAKMP_v2_SA_INIT
|    flags: ISAKMP_FLAG_INIT
|    message ID:  00 00 00 00
| ***emit IKEv2 Security Association Payload:
|    next payload type: ISAKMP_NEXT_v2KE
|    critical bit: Payload-Critical
| ****emit IKEv2 Proposal Substructure Payload:
|    next payload type: ISAKMP_NEXT_P
|    prop #: 1
|    proto ID: 1
|    spi size: 0
|    # transforms: 4
| *****emit IKEv2 Transform Substructure Payload:
|    next payload type: ISAKMP_NEXT_T
|    transform type: 1
|    transform ID: 12
| emitting length of IKEv2 Transform Substructure Payload: 8
| *****emit IKEv2 Transform Substructure Payload:
|    next payload type: ISAKMP_NEXT_T
|    transform type: 3
|    transform ID: 2
| emitting length of IKEv2 Transform Substructure Payload: 8
| *****emit IKEv2 Transform Substructure Payload:
|    next payload type: ISAKMP_NEXT_T
|    transform type: 2
|    transform ID: 2
| emitting length of IKEv2 Transform Substructure Payload: 8
| *****emit IKEv2 Transform Substructure Payload:
|    next payload type: ISAKMP_NEXT_NONE
|    transform type: 4
|    transform ID: 14
| emitting length of IKEv2 Transform Substructure Payload: 8
| emitting length of IKEv2 Proposal Substructure Payload: 40
| ****emit IKEv2 Proposal Substructure Payload:
|    next payload type: ISAKMP_NEXT_P
|    prop #: 2
|    proto ID: 1
|    spi size: 0
|    # transforms: 4
| *****emit IKEv2 Transform Substructure Payload:
|    next payload type: ISAKMP_NEXT_T
|    transform type: 1
|    transform ID: 12
| emitting length of IKEv2 Transform Substructure Payload: 8
| *****emit IKEv2 Transform Substructure Payload:
|    next payload type: ISAKMP_NEXT_T
|    transform type: 3
|    transform ID: 2
| emitting length of IKEv2 Transform Substructure Payload: 8
| *****emit IKEv2 Transform Substructure Payload:
|    next payload type: ISAKMP_NEXT_T
|    transform type: 2
|    transform ID: 1
| emitting length of IKEv2 Transform Substructure Payload: 8
| *****emit IKEv2 Transform Substructure Payload:
|    next payload type: ISAKMP_NEXT_NONE
|    transform type: 4
|    transform ID: 14
| emitting length of IKEv2 Transform Substructure Payload: 8
| emitting length of IKEv2 Proposal Substructure Payload: 40
| ****emit IKEv2 Proposal Substructure Payload:
|    next payload type: ISAKMP_NEXT_P
|    prop #: 3
|    proto ID: 1
|    spi size: 0
|    # transforms: 4
| *****emit IKEv2 Transform Substructure Payload:
|    next payload type: ISAKMP_NEXT_T
|    transform type: 1
|    transform ID: 3
| emitting length of IKEv2 Transform Substructure Payload: 8
| *****emit IKEv2 Transform Substructure Payload:
|    next payload type: ISAKMP_NEXT_T
|    transform type: 3
|    transform ID: 2
| emitting length of IKEv2 Transform Substructure Payload: 8
| *****emit IKEv2 Transform Substructure Payload:
|    next payload type: ISAKMP_NEXT_T
|    transform type: 2
|    transform ID: 2
| emitting length of IKEv2 Transform Substructure Payload: 8
| *****emit IKEv2 Transform Substructure Payload:
|    next payload type: ISAKMP_NEXT_NONE
|    transform type: 4
|    transform ID: 14
| emitting length of IKEv2 Transform Substructure Payload: 8
| emitting length of IKEv2 Proposal Substructure Payload: 40
| ****emit IKEv2 Proposal Substructure Payload:
|    next payload type: ISAKMP_NEXT_P
|    prop #: 4
|    proto ID: 1
|    spi size: 0
|    # transforms: 4
| *****emit IKEv2 Transform Substructure Payload:
|    next payload type: ISAKMP_NEXT_T
|    transform type: 1
|    transform ID: 3
| emitting length of IKEv2 Transform Substructure Payload: 8
| *****emit IKEv2 Transform Substructure Payload:
|    next payload type: ISAKMP_NEXT_T
|    transform type: 3
|    transform ID: 2
| emitting length of IKEv2 Transform Substructure Payload: 8
| *****emit IKEv2 Transform Substructure Payload:
|    next payload type: ISAKMP_NEXT_T
|    transform type: 2
|    transform ID: 1
| emitting length of IKEv2 Transform Substructure Payload: 8
| *****emit IKEv2 Transform Substructure Payload:
|    next payload type: ISAKMP_NEXT_NONE
|    transform type: 4
|    transform ID: 14
| emitting length of IKEv2 Transform Substructure Payload: 8
| emitting length of IKEv2 Proposal Substructure Payload: 40
| ****emit IKEv2 Proposal Substructure Payload:
|    next payload type: ISAKMP_NEXT_P
|    prop #: 5
|    proto ID: 1
|    spi size: 0
|    # transforms: 4
| *****emit IKEv2 Transform Substructure Payload:
|    next payload type: ISAKMP_NEXT_T
|    transform type: 1
|    transform ID: 12
| emitting length of IKEv2 Transform Substructure Payload: 8
| *****emit IKEv2 Transform Substructure Payload:
|    next payload type: ISAKMP_NEXT_T
|    transform type: 3
|    transform ID: 2
| emitting length of IKEv2 Transform Substructure Payload: 8
| *****emit IKEv2 Transform Substructure Payload:
|    next payload type: ISAKMP_NEXT_T
|    transform type: 2
|    transform ID: 2
| emitting length of IKEv2 Transform Substructure Payload: 8
| *****emit IKEv2 Transform Substructure Payload:
|    next payload type: ISAKMP_NEXT_NONE
|    transform type: 4
|    transform ID: 5
| emitting length of IKEv2 Transform Substructure Payload: 8
| emitting length of IKEv2 Proposal Substructure Payload: 40
| ****emit IKEv2 Proposal Substructure Payload:
|    next payload type: ISAKMP_NEXT_P
|    prop #: 6
|    proto ID: 1
|    spi size: 0
|    # transforms: 4
| *****emit IKEv2 Transform Substructure Payload:
|    next payload type: ISAKMP_NEXT_T
|    transform type: 1
|    transform ID: 12
| emitting length of IKEv2 Transform Substructure Payload: 8
| *****emit IKEv2 Transform Substructure Payload:
|    next payload type: ISAKMP_NEXT_T
|    transform type: 3
|    transform ID: 2
| emitting length of IKEv2 Transform Substructure Payload: 8
| *****emit IKEv2 Transform Substructure Payload:
|    next payload type: ISAKMP_NEXT_T
|    transform type: 2
|    transform ID: 1
| emitting length of IKEv2 Transform Substructure Payload: 8
| *****emit IKEv2 Transform Substructure Payload:
|    next payload type: ISAKMP_NEXT_NONE
|    transform type: 4
|    transform ID: 5
| emitting length of IKEv2 Transform Substructure Payload: 8
| emitting length of IKEv2 Proposal Substructure Payload: 40
| ****emit IKEv2 Proposal Substructure Payload:
|    next payload type: ISAKMP_NEXT_P
|    prop #: 7
|    proto ID: 1
|    spi size: 0
|    # transforms: 4
| *****emit IKEv2 Transform Substructure Payload:
|    next payload type: ISAKMP_NEXT_T
|    transform type: 1
|    transform ID: 3
| emitting length of IKEv2 Transform Substructure Payload: 8
| *****emit IKEv2 Transform Substructure Payload:
|    next payload type: ISAKMP_NEXT_T
|    transform type: 3
|    transform ID: 2
| emitting length of IKEv2 Transform Substructure Payload: 8
| *****emit IKEv2 Transform Substructure Payload:
|    next payload type: ISAKMP_NEXT_T
|    transform type: 2
|    transform ID: 2
| emitting length of IKEv2 Transform Substructure Payload: 8
| *****emit IKEv2 Transform Substructure Payload:
|    next payload type: ISAKMP_NEXT_NONE
|    transform type: 4
|    transform ID: 5
| emitting length of IKEv2 Transform Substructure Payload: 8
| emitting length of IKEv2 Proposal Substructure Payload: 40
| ****emit IKEv2 Proposal Substructure Payload:
|    next payload type: ISAKMP_NEXT_P
|    prop #: 8
|    proto ID: 1
|    spi size: 0
|    # transforms: 4
| *****emit IKEv2 Transform Substructure Payload:
|    next payload type: ISAKMP_NEXT_T
|    transform type: 1
|    transform ID: 3
| emitting length of IKEv2 Transform Substructure Payload: 8
| *****emit IKEv2 Transform Substructure Payload:
|    next payload type: ISAKMP_NEXT_T
|    transform type: 3
|    transform ID: 2
| emitting length of IKEv2 Transform Substructure Payload: 8
| *****emit IKEv2 Transform Substructure Payload:
|    next payload type: ISAKMP_NEXT_T
|    transform type: 2
|    transform ID: 1
| emitting length of IKEv2 Transform Substructure Payload: 8
| *****emit IKEv2 Transform Substructure Payload:
|    next payload type: ISAKMP_NEXT_NONE
|    transform type: 4
|    transform ID: 5
| emitting length of IKEv2 Transform Substructure Payload: 8
| emitting length of IKEv2 Proposal Substructure Payload: 40
| ****emit IKEv2 Proposal Substructure Payload:
|    next payload type: ISAKMP_NEXT_P
|    prop #: 9
|    proto ID: 1
|    spi size: 0
|    # transforms: 4
| *****emit IKEv2 Transform Substructure Payload:
|    next payload type: ISAKMP_NEXT_T
|    transform type: 1
|    transform ID: 3
| emitting length of IKEv2 Transform Substructure Payload: 8
| *****emit IKEv2 Transform Substructure Payload:
|    next payload type: ISAKMP_NEXT_T
|    transform type: 3
|    transform ID: 2
| emitting length of IKEv2 Transform Substructure Payload: 8
| *****emit IKEv2 Transform Substructure Payload:
|    next payload type: ISAKMP_NEXT_T
|    transform type: 2
|    transform ID: 2
| emitting length of IKEv2 Transform Substructure Payload: 8
| *****emit IKEv2 Transform Substructure Payload:
|    next payload type: ISAKMP_NEXT_NONE
|    transform type: 4
|    transform ID: 2
| emitting length of IKEv2 Transform Substructure Payload: 8
| emitting length of IKEv2 Proposal Substructure Payload: 40
| ****emit IKEv2 Proposal Substructure Payload:
|    next payload type: ISAKMP_NEXT_NONE
|    prop #: 10
|    proto ID: 1
|    spi size: 0
|    # transforms: 4
| *****emit IKEv2 Transform Substructure Payload:
|    next payload type: ISAKMP_NEXT_T
|    transform type: 1
|    transform ID: 3
| emitting length of IKEv2 Transform Substructure Payload: 8
| *****emit IKEv2 Transform Substructure Payload:
|    next payload type: ISAKMP_NEXT_T
|    transform type: 3
|    transform ID: 2
| emitting length of IKEv2 Transform Substructure Payload: 8
| *****emit IKEv2 Transform Substructure Payload:
|    next payload type: ISAKMP_NEXT_T
|    transform type: 2
|    transform ID: 1
| emitting length of IKEv2 Transform Substructure Payload: 8
| *****emit IKEv2 Transform Substructure Payload:
|    next payload type: ISAKMP_NEXT_NONE
|    transform type: 4
|    transform ID: 2
| emitting length of IKEv2 Transform Substructure Payload: 8
| emitting length of IKEv2 Proposal Substructure Payload: 40
| emitting length of IKEv2 Security Association Payload: 404
| ***emit IKEv2 Key Exchange Payload:
|    next payload type: ISAKMP_NEXT_v2Ni
|    transform type: 14
| emitting 256 raw bytes of ikev2 g^x into IKEv2 Key Exchange Payload
| ikev2 g^x  fa 16 28 78  76 7c 83 55  bd 3d c9 94  b8 f4 6f a7
| ikev2 g^x  5f a6 91 77  cc 4a eb 65  49 32 2c 03  63 35 ee 02
| ikev2 g^x  c8 64 ca 5e  2e 6e 54 8d  c3 0f dc a8  a5 33 2d 7f
| ikev2 g^x  ee 3b 5b a7  7e 87 0f a4  43 86 8a d7  bd bc 62 65
| ikev2 g^x  a5 da 06 36  d5 67 b7 9d  e5 e5 10 5c  4e f2 55 d9
| ikev2 g^x  24 ed 20 a5  b9 db 69 7f  4a 7c 3f 32  d5 db 26 50
| ikev2 g^x  31 a7 5a e2  a8 7a 56 77  72 d0 68 8c  60 e4 12 37
| ikev2 g^x  21 86 92 35  ff d6 ac 09  ad 1d 80 6f  bf 0e 84 d3
| ikev2 g^x  55 21 41 5d  76 a9 11 0b  29 d3 0e 8c  f4 36 44 b2
| ikev2 g^x  0a 6f 35 a9  70 7c f2 5c  66 00 67 a3  83 73 44 15
| ikev2 g^x  ce a5 41 58  04 c1 06 e2  77 c3 b3 83  b9 1b d0 8a
| ikev2 g^x  ca 4e 19 c7  f6 13 17 30  ba 2a f0 8c  55 c5 1e 37
| ikev2 g^x  c9 84 07 68  ae 9c bc ee  68 5c ce eb  d4 be a7 18
| ikev2 g^x  80 8d 9e e3  52 00 bc 6d  91 87 d6 a8  81 7a a2 0a
| ikev2 g^x  aa 36 f6 fa  9d 0c 51 e3  bf 63 6b 2b  25 c9 cb 38
| ikev2 g^x  26 99 1b 03  1d 66 50 ed  9e 71 a3 df  11 77 7b 89
| emitting length of IKEv2 Key Exchange Payload: 264
| ***emit IKEv2 Nonce Payload:
|    next payload type: ISAKMP_NEXT_v2V
|    critical bit: Payload-Critical
| emitting 16 raw bytes of IKEv2 nonce into IKEv2 Nonce Payload
| IKEv2 nonce  6b 98 11 b2  fe e7 5c 89  de 6a 5f 3d  14 83 b6 25
| emitting length of IKEv2 Nonce Payload: 20
| ***emit ISAKMP Vendor ID Payload:
|    next payload type: ISAKMP_NEXT_NONE
| emitting 12 raw bytes of Vendor ID into ISAKMP Vendor ID Payload
| Vendor ID  4f 45 71 6a  45 7f 70 51  5c 6b 70 4c
| emitting length of ISAKMP Vendor ID Payload: 16
| emitting length of ISAKMP Message: 732
| sending 732 bytes for ikev2_parent_outI1_tail through eth1:500 to 192.1.2.23:500 (using #1)
|   e8 05 90 ca  d2 3a ee 04  00 00 00 00  00 00 00 00
|   21 20 22 08  00 00 00 00  00 00 02 dc  22 80 01 94
|   02 00 00 28  01 01 00 04  03 00 00 08  01 00 00 0c
|   03 00 00 08  03 00 00 02  03 00 00 08  02 00 00 02
|   00 00 00 08  04 00 00 0e  02 00 00 28  02 01 00 04
|   03 00 00 08  01 00 00 0c  03 00 00 08  03 00 00 02
|   03 00 00 08  02 00 00 01  00 00 00 08  04 00 00 0e
|   02 00 00 28  03 01 00 04  03 00 00 08  01 00 00 03
|   03 00 00 08  03 00 00 02  03 00 00 08  02 00 00 02
|   00 00 00 08  04 00 00 0e  02 00 00 28  04 01 00 04
|   03 00 00 08  01 00 00 03  03 00 00 08  03 00 00 02
|   03 00 00 08  02 00 00 01  00 00 00 08  04 00 00 0e
|   02 00 00 28  05 01 00 04  03 00 00 08  01 00 00 0c
|   03 00 00 08  03 00 00 02  03 00 00 08  02 00 00 02
|   00 00 00 08  04 00 00 05  02 00 00 28  06 01 00 04
|   03 00 00 08  01 00 00 0c  03 00 00 08  03 00 00 02
|   03 00 00 08  02 00 00 01  00 00 00 08  04 00 00 05
|   02 00 00 28  07 01 00 04  03 00 00 08  01 00 00 03
|   03 00 00 08  03 00 00 02  03 00 00 08  02 00 00 02
|   00 00 00 08  04 00 00 05  02 00 00 28  08 01 00 04
|   03 00 00 08  01 00 00 03  03 00 00 08  03 00 00 02
|   03 00 00 08  02 00 00 01  00 00 00 08  04 00 00 05
|   02 00 00 28  09 01 00 04  03 00 00 08  01 00 00 03
|   03 00 00 08  03 00 00 02  03 00 00 08  02 00 00 02
|   00 00 00 08  04 00 00 02  00 00 00 28  0a 01 00 04
|   03 00 00 08  01 00 00 03  03 00 00 08  03 00 00 02
|   03 00 00 08  02 00 00 01  00 00 00 08  04 00 00 02
|   28 00 01 08  00 0e 00 00  fa 16 28 78  76 7c 83 55
|   bd 3d c9 94  b8 f4 6f a7  5f a6 91 77  cc 4a eb 65
|   49 32 2c 03  63 35 ee 02  c8 64 ca 5e  2e 6e 54 8d
|   c3 0f dc a8  a5 33 2d 7f  ee 3b 5b a7  7e 87 0f a4
|   43 86 8a d7  bd bc 62 65  a5 da 06 36  d5 67 b7 9d
|   e5 e5 10 5c  4e f2 55 d9  24 ed 20 a5  b9 db 69 7f
|   4a 7c 3f 32  d5 db 26 50  31 a7 5a e2  a8 7a 56 77
|   72 d0 68 8c  60 e4 12 37  21 86 92 35  ff d6 ac 09
|   ad 1d 80 6f  bf 0e 84 d3  55 21 41 5d  76 a9 11 0b
|   29 d3 0e 8c  f4 36 44 b2  0a 6f 35 a9  70 7c f2 5c
|   66 00 67 a3  83 73 44 15  ce a5 41 58  04 c1 06 e2
|   77 c3 b3 83  b9 1b d0 8a  ca 4e 19 c7  f6 13 17 30
|   ba 2a f0 8c  55 c5 1e 37  c9 84 07 68  ae 9c bc ee
|   68 5c ce eb  d4 be a7 18  80 8d 9e e3  52 00 bc 6d
|   91 87 d6 a8  81 7a a2 0a  aa 36 f6 fa  9d 0c 51 e3
|   bf 63 6b 2b  25 c9 cb 38  26 99 1b 03  1d 66 50 ed
|   9e 71 a3 df  11 77 7b 89  2b 80 00 14  6b 98 11 b2
|   fe e7 5c 89  de 6a 5f 3d  14 83 b6 25  00 00 00 10
|   4f 45 71 6a  45 7f 70 51  5c 6b 70 4c
| inserting event EVENT_RETRANSMIT, timeout in 10 seconds for #1
| complete v2 state transition with STF_OK
"westnet--eastnet-ikev2" #1: transition from state STATE_IKEv2_START to state STATE_PARENT_I1
"westnet--eastnet-ikev2" #1: STATE_PARENT_I1: sent v2I1, expected v2R1
| * processed 1 messages from cryptographic helpers 
| next event EVENT_SHUNT_SCAN in 76 seconds
|  
| *received 372 bytes from 192.1.2.23:500 on eth1 (port=500)
|   e8 05 90 ca  d2 3a ee 04  cc da 96 3d  aa 0f fc 9f
|   21 20 22 20  00 00 00 00  00 00 01 74  22 80 00 2c
|   00 00 00 28  01 01 00 04  03 00 00 08  01 00 00 0c
|   03 00 00 08  03 00 00 02  03 00 00 08  02 00 00 02
|   00 00 00 08  04 00 00 0e  28 00 01 08  00 0e 00 00
|   50 92 aa f6  39 24 85 8a  ef c2 9a 4c  8e 7c 85 17
|   1f 4a 76 46  6a e2 02 0b  5a 92 73 32  48 e9 1e e9
|   03 83 c2 2f  10 7c 3e e5  8a 33 11 d7  81 a8 ba 5a
|   d9 44 db f9  70 f1 34 66  f7 da 2e 05  d0 74 39 35
|   83 4a 27 b6  58 54 93 2a  19 27 d2 c2  fa bf 86 d9
|   4e 20 2a 26  ae 43 5a 01  e8 fd 1d 76  85 9d 82 2c
|   94 b7 cf 24  3d 6a fc 16  26 64 83 a1  e7 e1 95 db
|   61 35 62 08  83 84 cd 17  b5 4e 47 8c  90 b0 d0 fa
|   01 2b d4 c5  bc 2e 28 0c  ae 69 fb 0a  3c e7 a6 b1
|   09 1d ef 3f  11 79 13 82  34 e0 46 79  30 2a 73 4b
|   4c ed 15 1b  da e6 3f 1f  33 05 68 2c  01 92 1a 47
|   4f a2 2a 3f  4c 62 99 73  8b 47 be 3e  d5 ba ea 6c
|   a8 d5 b4 2e  31 d9 24 3c  23 be 3a d2  13 5d e9 6b
|   d7 c5 f9 ea  f0 0a b0 56  eb a2 38 2b  2d 30 11 a5
|   22 6d bd 34  89 e2 bd 2f  7e 73 0f 15  20 1b 5f 33
|   9b e3 b4 6d  4c 32 e1 b8  80 5b a1 25  d7 1a 5b 9b
|   2b 80 00 14  1d 2e ea bc  d0 50 3f 27  63 ea 99 08
|   de fa b8 f4  00 00 00 10  4f 45 71 6a  45 7f 70 51
|   5c 6b 70 4c
| **parse ISAKMP Message:
|    initiator cookie:
|   e8 05 90 ca  d2 3a ee 04
|    responder cookie:
|   cc da 96 3d  aa 0f fc 9f
|    next payload type: ISAKMP_NEXT_v2SA
|    ISAKMP version: IKEv2 version 2.0 (rfc4306)
|    exchange type: ISAKMP_v2_SA_INIT
|    flags: ISAKMP_FLAG_RESPONSE
|    message ID:  00 00 00 00
|    length: 372
|  processing version=2.0 packet with exchange type=ISAKMP_v2_SA_INIT (34)
| ICOOKIE:  e8 05 90 ca  d2 3a ee 04
| RCOOKIE:  cc da 96 3d  aa 0f fc 9f
| state hash entry 18
| v2 state object not found
| ICOOKIE:  e8 05 90 ca  d2 3a ee 04
| RCOOKIE:  00 00 00 00  00 00 00 00
| state hash entry 5
| v2 peer and cookies match on #1
| v2 state object #1 found, in STATE_PARENT_I1
| ICOOKIE:  e8 05 90 ca  d2 3a ee 04
| RCOOKIE:  00 00 00 00  00 00 00 00
| state hash entry 5
| ICOOKIE:  e8 05 90 ca  d2 3a ee 04
| RCOOKIE:  cc da 96 3d  aa 0f fc 9f
| state hash entry 18
| inserting state object #1 on chain 18
| inserting event EVENT_SO_DISCARD, timeout in 0 seconds for #1
| ***parse IKEv2 Security Association Payload:
|    next payload type: ISAKMP_NEXT_v2KE
|    critical bit: Payload-Critical
|    length: 44
| processing payload: ISAKMP_NEXT_v2SA (len=44) 
| ***parse IKEv2 Key Exchange Payload:
|    next payload type: ISAKMP_NEXT_v2Ni
|    length: 264
|    transform type: 14
| processing payload: ISAKMP_NEXT_v2KE (len=264) 
| ***parse IKEv2 Nonce Payload:
|    next payload type: ISAKMP_NEXT_v2V
|    critical bit: Payload-Critical
|    length: 20
| processing payload: ISAKMP_NEXT_v2Ni (len=20) 
| ***parse IKEv2 Vendor ID Payload:
|    next payload type: ISAKMP_NEXT_NONE
|    critical bit: Payload-Non-Critical
|    length: 16
| processing payload: ISAKMP_NEXT_v2V (len=16) 
| ikev2 parent inR1: calculating g^{xy} in order to send I2
| DH public value received:
|   50 92 aa f6  39 24 85 8a  ef c2 9a 4c  8e 7c 85 17
|   1f 4a 76 46  6a e2 02 0b  5a 92 73 32  48 e9 1e e9
|   03 83 c2 2f  10 7c 3e e5  8a 33 11 d7  81 a8 ba 5a
|   d9 44 db f9  70 f1 34 66  f7 da 2e 05  d0 74 39 35
|   83 4a 27 b6  58 54 93 2a  19 27 d2 c2  fa bf 86 d9
|   4e 20 2a 26  ae 43 5a 01  e8 fd 1d 76  85 9d 82 2c
|   94 b7 cf 24  3d 6a fc 16  26 64 83 a1  e7 e1 95 db
|   61 35 62 08  83 84 cd 17  b5 4e 47 8c  90 b0 d0 fa
|   01 2b d4 c5  bc 2e 28 0c  ae 69 fb 0a  3c e7 a6 b1
|   09 1d ef 3f  11 79 13 82  34 e0 46 79  30 2a 73 4b
|   4c ed 15 1b  da e6 3f 1f  33 05 68 2c  01 92 1a 47
|   4f a2 2a 3f  4c 62 99 73  8b 47 be 3e  d5 ba ea 6c
|   a8 d5 b4 2e  31 d9 24 3c  23 be 3a d2  13 5d e9 6b
|   d7 c5 f9 ea  f0 0a b0 56  eb a2 38 2b  2d 30 11 a5
|   22 6d bd 34  89 e2 bd 2f  7e 73 0f 15  20 1b 5f 33
|   9b e3 b4 6d  4c 32 e1 b8  80 5b a1 25  d7 1a 5b 9b
| ****parse IKEv2 Proposal Substructure Payload:
|    next payload type: ISAKMP_NEXT_NONE
|    length: 40
|    prop #: 1
|    proto ID: 1
|    spi size: 0
|    # transforms: 4
| *****parse IKEv2 Transform Substructure Payload:
|    next payload type: ISAKMP_NEXT_T
|    length: 8
|    transform type: 1
|    transform ID: 12
| *****parse IKEv2 Transform Substructure Payload:
|    next payload type: ISAKMP_NEXT_T
|    length: 8
|    transform type: 3
|    transform ID: 2
| *****parse IKEv2 Transform Substructure Payload:
|    next payload type: ISAKMP_NEXT_T
|    length: 8
|    transform type: 2
|    transform ID: 2
| *****parse IKEv2 Transform Substructure Payload:
|    next payload type: ISAKMP_NEXT_NONE
|    length: 8
|    transform type: 4
|    transform ID: 14
| calculating skeyseed using prf=prf-hmac-sha1 integ=auth-hmac-sha1-96 cipherkey=aes-cbc
| 0: w->pcw_dead: 0 w->pcw_work: 0 cnt: 1
| asking helper 0 to do compute dh(v2) op on seq: 2 (len=2668, pcw_work=1)
| crypto helper write of request: cnt=2668<wlen=2668.  
| inserting event EVENT_CRYPTO_FAILED, timeout in 300 seconds for #1
| complete v2 state transition with STF_SUSPEND
| * processed 0 messages from cryptographic helpers 
| next event EVENT_SHUNT_SCAN in 76 seconds
! helper 0 read 2664+4/2668 bytesfd: 7
! helper 0 doing compute dh(v2) op id: 2
! long term secret:   ae 15 c2 b8  04 32 16 d6  ed 11 47 7a  c6 1e c7 81
! long term secret:   f0 81 84 df  3b 82 7b e6  98 6f 2a 6f  72 65 db 9a
! calc_dh_shared(): time elapsed (OAKLEY_GROUP_MODP2048): 5195 usec
! DH shared-secret:
!   42 40 ea 40  74 7d 6d db  b0 af 17 d5  5d 18 f8 27
!   b0 ec 74 27  06 f8 49 30  0d 50 ea e5  a2 2a 37 f1
!   a2 11 cc 92  6f 46 4a a5  7e de b3 2f  5f bb e2 87
!   e9 9b bc 61  ae ae 8e a1  b2 a6 d9 51  42 3e 91 21
!   c1 9e ac 30  8a a3 10 ea  dc bf 5f df  98 a3 50 fa
!   90 00 8e 6f  3d 52 b6 01  ad d1 70 96  bb 40 5c a1
!   f3 3a c4 6b  5b 8e a7 1c  6b cf bb b6  95 13 20 5b
!   90 f0 49 72  be 57 2d aa  ed 16 00 8a  d7 1f 3e 75
!   24 a7 96 77  20 27 e1 66  2b 75 85 03  3c 42 73 b2
!   a0 a7 e4 07  2d fa 25 3f  8f d0 0f d3  12 b9 cc 8a
!   74 37 78 53  06 83 a4 19  1c 86 40 ff  5f 7b 77 de
!   00 03 2a a8  6e 15 be 5f  0a ac 8a c5  cc 28 47 45
!   a8 fe c6 17  08 b5 a4 f5  4d bb a7 ec  1a 38 de 99
!   fe eb 92 20  46 7c 95 86  4a d3 21 1c  96 c1 bc ab
!   4d 1b ce 1a  0b f6 25 25  4e 41 0f 20  4d b6 00 51
!   ab 23 82 c4  1f 04 86 6c  b7 6c 45 ae  59 ee 5d c2
! calculating skeyseed using prf=prf-hmac-sha1 integ=auth-hmac-sha1-96 cipherkey=16
! Input to SKEYSEED:   6b 98 11 b2  fe e7 5c 89  de 6a 5f 3d  14 83 b6 25
! Input to SKEYSEED:   1d 2e ea bc  d0 50 3f 27  63 ea 99 08  de fa b8 f4
! PRF+ input
! Ni  6b 98 11 b2  fe e7 5c 89  de 6a 5f 3d  14 83 b6 25
! Nr  1d 2e ea bc  d0 50 3f 27  63 ea 99 08  de fa b8 f4
! SPIi  e8 05 90 ca  d2 3a ee 04
! SPIr  cc da 96 3d  aa 0f fc 9f
! prf+[1]:  f5 96 f7 ec  7e 04 ea 1e  fa 91 5b 39  cc 65 95 cc
! prf+[1]:  92 53 86 0c
! prf+[2]:  01 96 d5 4d  59 35 3a 31  9a cb 8f 6a  01 a2 99 f2
! prf+[2]:  6b 4f d5 3d
! prf+[3]:  5c 29 cb e7  b3 78 f0 68  f5 88 43 1e  60 df 39 81
! prf+[3]:  f7 4d 56 3d
! prf+[4]:  d7 27 15 9e  4e d2 97 27  40 e3 ae 1e  de 9d f9 81
! prf+[4]:  0b f7 fa a1
! prf+[5]:  a8 34 7a 6e  b4 57 b8 0a  15 03 5c 08  0a 40 34 78
! prf+[5]:  af 08 e7 2a
! prf+[6]:  28 55 9f a8  74 91 ab 52  ec 9f 64 da  18 b0 54 eb
! prf+[6]:  b8 59 68 dc
! prf+[7]:  66 60 31 2f  52 a6 e5 66  dd 1c f2 57  2c c8 5a ed
! prf+[7]:  cd 2c 0a 21
! shared:    42 40 ea 40  74 7d 6d db  b0 af 17 d5  5d 18 f8 27
! shared:    b0 ec 74 27  06 f8 49 30  0d 50 ea e5  a2 2a 37 f1
! shared:    a2 11 cc 92  6f 46 4a a5  7e de b3 2f  5f bb e2 87
! shared:    e9 9b bc 61  ae ae 8e a1  b2 a6 d9 51  42 3e 91 21
! shared:    c1 9e ac 30  8a a3 10 ea  dc bf 5f df  98 a3 50 fa
! shared:    90 00 8e 6f  3d 52 b6 01  ad d1 70 96  bb 40 5c a1
! shared:    f3 3a c4 6b  5b 8e a7 1c  6b cf bb b6  95 13 20 5b
! shared:    90 f0 49 72  be 57 2d aa  ed 16 00 8a  d7 1f 3e 75
! shared:    24 a7 96 77  20 27 e1 66  2b 75 85 03  3c 42 73 b2
! shared:    a0 a7 e4 07  2d fa 25 3f  8f d0 0f d3  12 b9 cc 8a
! shared:    74 37 78 53  06 83 a4 19  1c 86 40 ff  5f 7b 77 de
! shared:    00 03 2a a8  6e 15 be 5f  0a ac 8a c5  cc 28 47 45
! shared:    a8 fe c6 17  08 b5 a4 f5  4d bb a7 ec  1a 38 de 99
! shared:    fe eb 92 20  46 7c 95 86  4a d3 21 1c  96 c1 bc ab
! shared:    4d 1b ce 1a  0b f6 25 25  4e 41 0f 20  4d b6 00 51
! shared:    ab 23 82 c4  1f 04 86 6c  b7 6c 45 ae  59 ee 5d c2
! skeyseed:  bf b0 a0 a3  cb dc 6d b6  86 df 21 2e  15 b9 5b 76
! skeyseed:  a8 ac 03 c0
! SK_d:  f5 96 f7 ec  7e 04 ea 1e  fa 91 5b 39  cc 65 95 cc
! SK_d:  92 53 86 0c
! SK_ai:  01 96 d5 4d  59 35 3a 31  9a cb 8f 6a  01 a2 99 f2
! SK_ai:  6b 4f d5 3d
! SK_ar:  5c 29 cb e7  b3 78 f0 68  f5 88 43 1e  60 df 39 81
! SK_ar:  f7 4d 56 3d
! SK_ei:  d7 27 15 9e  4e d2 97 27  40 e3 ae 1e  de 9d f9 81
! SK_er:  0b f7 fa a1  a8 34 7a 6e  b4 57 b8 0a  15 03 5c 08
! SK_pi:  0a 40 34 78  af 08 e7 2a  28 55 9f a8  74 91 ab 52
! SK_pi:  ec 9f 64 da
! SK_pr:  18 b0 54 eb  b8 59 68 dc  66 60 31 2f  52 a6 e5 66
! SK_pr:  dd 1c f2 57
|  
| helper 0 has finished work (cnt now 1)
| helper 0 replies to id: q#2
| calling callback function 0x8076e2e
| ikev2 parent inR1outI1: calculating g^{xy}, sending I2
| processing connection westnet--eastnet-ikev2
| duplicating state object #1
| creating state object #2 at 0x814dd68
| ICOOKIE:  e8 05 90 ca  d2 3a ee 04
| RCOOKIE:  cc da 96 3d  aa 0f fc 9f
| state hash entry 18
| inserting state object #2 on chain 18
| inserting event EVENT_SO_DISCARD, timeout in 0 seconds for #2
| **emit ISAKMP Message:
|    initiator cookie:
|   e8 05 90 ca  d2 3a ee 04
|    responder cookie:
|   cc da 96 3d  aa 0f fc 9f
|    next payload type: ISAKMP_NEXT_v2E
|    ISAKMP version: IKEv2 version 2.0 (rfc4306)
|    exchange type: ISAKMP_v2_AUTH
|    flags: ISAKMP_FLAG_INIT
|    message ID:  00 00 00 01
| ***emit IKEv2 Encryption Payload:
|    next payload type: ISAKMP_NEXT_v2IDi
|    critical bit: Payload-Critical
| emitting 16 zero bytes of iv into IKEv2 Encryption Payload
| IKEv2 thinking whether to send my certificate:
|  my policy has no RSASIG, the policy is : PSK+ENCRYPT+TUNNEL+PFS+UP+!IKEv1+IKEv2ALLOW+IKEv2Init
|  sendcert: CERT_ALWAYSSEND and I did not get a certificate request 
|  so do not send cert.
| I did not send a certificate because digital signatures are not being used. (PSK)
| *****emit IKEv2 Identification Payload:
|    next payload type: ISAKMP_NEXT_v2AUTH
|    id_type: ID_FQDN
| emitting 4 raw bytes of my identity into IKEv2 Identification Payload
| my identity  77 65 73 74
| emitting length of IKEv2 Identification Payload: 12
| idhash calc pi  0a 40 34 78  af 08 e7 2a  28 55 9f a8  74 91 ab 52
| idhash calc pi  ec 9f 64 da
| idhash calc I2  02 00 00 00  77 65 73 74
| *****emit IKEv2 Authentication Payload:
|    next payload type: ISAKMP_NEXT_v2SA
|    auth method: v2_AUTH_SHARED
| started looking for secret for @west->@east of kind PPK_PSK
| actually looking for secret for @west->@east of kind PPK_PSK
| line 27: key type PPK_PSK(@west) to type PPK_PSK 
| 1: compared key @east to @west / @east -> 2
| 2: compared key @west to @west / @east -> 6
| line 27: match=6 
| best_match 0>6 best=0x814a4f8 (line=27)
| line 8: key type PPK_PSK(@west) to type PPK_RSA 
| concluding with best_match=6 best=0x814a4f8 (lineno=27)
| negotiated prf: oakley_sha hash length: 20
| inner prf ouput  32 1f 3f cb  b0 71 c5 e9  cf fb 04 98  9e 4d 6e e6
| inner prf ouput  e1 34 7b 93
| inputs to hash1 (first packet)
|   e8 05 90 ca  d2 3a ee 04  00 00 00 00  00 00 00 00
|   21 20 22 08  00 00 00 00  00 00 02 dc  22 80 01 94
|   02 00 00 28  01 01 00 04  03 00 00 08  01 00 00 0c
|   03 00 00 08  03 00 00 02  03 00 00 08  02 00 00 02
|   00 00 00 08  04 00 00 0e  02 00 00 28  02 01 00 04
|   03 00 00 08  01 00 00 0c  03 00 00 08  03 00 00 02
|   03 00 00 08  02 00 00 01  00 00 00 08  04 00 00 0e
|   02 00 00 28  03 01 00 04  03 00 00 08  01 00 00 03
|   03 00 00 08  03 00 00 02  03 00 00 08  02 00 00 02
|   00 00 00 08  04 00 00 0e  02 00 00 28  04 01 00 04
|   03 00 00 08  01 00 00 03  03 00 00 08  03 00 00 02
|   03 00 00 08  02 00 00 01  00 00 00 08  04 00 00 0e
|   02 00 00 28  05 01 00 04  03 00 00 08  01 00 00 0c
|   03 00 00 08  03 00 00 02  03 00 00 08  02 00 00 02
|   00 00 00 08  04 00 00 05  02 00 00 28  06 01 00 04
|   03 00 00 08  01 00 00 0c  03 00 00 08  03 00 00 02
|   03 00 00 08  02 00 00 01  00 00 00 08  04 00 00 05
|   02 00 00 28  07 01 00 04  03 00 00 08  01 00 00 03
|   03 00 00 08  03 00 00 02  03 00 00 08  02 00 00 02
|   00 00 00 08  04 00 00 05  02 00 00 28  08 01 00 04
|   03 00 00 08  01 00 00 03  03 00 00 08  03 00 00 02
|   03 00 00 08  02 00 00 01  00 00 00 08  04 00 00 05
|   02 00 00 28  09 01 00 04  03 00 00 08  01 00 00 03
|   03 00 00 08  03 00 00 02  03 00 00 08  02 00 00 02
|   00 00 00 08  04 00 00 02  00 00 00 28  0a 01 00 04
|   03 00 00 08  01 00 00 03  03 00 00 08  03 00 00 02
|   03 00 00 08  02 00 00 01  00 00 00 08  04 00 00 02
|   28 00 01 08  00 0e 00 00  fa 16 28 78  76 7c 83 55
|   bd 3d c9 94  b8 f4 6f a7  5f a6 91 77  cc 4a eb 65
|   49 32 2c 03  63 35 ee 02  c8 64 ca 5e  2e 6e 54 8d
|   c3 0f dc a8  a5 33 2d 7f  ee 3b 5b a7  7e 87 0f a4
|   43 86 8a d7  bd bc 62 65  a5 da 06 36  d5 67 b7 9d
|   e5 e5 10 5c  4e f2 55 d9  24 ed 20 a5  b9 db 69 7f
|   4a 7c 3f 32  d5 db 26 50  31 a7 5a e2  a8 7a 56 77
|   72 d0 68 8c  60 e4 12 37  21 86 92 35  ff d6 ac 09
|   ad 1d 80 6f  bf 0e 84 d3  55 21 41 5d  76 a9 11 0b
|   29 d3 0e 8c  f4 36 44 b2  0a 6f 35 a9  70 7c f2 5c
|   66 00 67 a3  83 73 44 15  ce a5 41 58  04 c1 06 e2
|   77 c3 b3 83  b9 1b d0 8a  ca 4e 19 c7  f6 13 17 30
|   ba 2a f0 8c  55 c5 1e 37  c9 84 07 68  ae 9c bc ee
|   68 5c ce eb  d4 be a7 18  80 8d 9e e3  52 00 bc 6d
|   91 87 d6 a8  81 7a a2 0a  aa 36 f6 fa  9d 0c 51 e3
|   bf 63 6b 2b  25 c9 cb 38  26 99 1b 03  1d 66 50 ed
|   9e 71 a3 df  11 77 7b 89  2b 80 00 14  6b 98 11 b2
|   fe e7 5c 89  de 6a 5f 3d  14 83 b6 25  00 00 00 10
|   4f 45 71 6a  45 7f 70 51  5c 6b 70 4c
| inputs to hash2 (responder nonce)
|   1d 2e ea bc  d0 50 3f 27  63 ea 99 08  de fa b8 f4
| idhash  a6 8a 92 85  35 78 1a 40  37 d0 15 e3  94 1a ae 58
| idhash  41 e8 5e c1
| PSK auth octets  ad 69 56 f3  ec 93 3b 29  21 d1 7a 87  2c cb 92 a5
| PSK auth octets  7b 57 91 ea
| emitting 20 raw bytes of PSK auth into IKEv2 Authentication Payload
| PSK auth  ad 69 56 f3  ec 93 3b 29  21 d1 7a 87  2c cb 92 a5
| PSK auth  7b 57 91 ea
| emitting length of IKEv2 Authentication Payload: 28
| empty esp_info, returning defaults
| *****emit IKEv2 Security Association Payload:
|    next payload type: ISAKMP_NEXT_v2TSi
|    critical bit: Payload-Critical
| generate SPI:  79 ac bc 7a
| ******emit IKEv2 Proposal Substructure Payload:
|    next payload type: ISAKMP_NEXT_P
|    prop #: 1
|    proto ID: 3
|    spi size: 4
|    # transforms: 3
| emitting 4 raw bytes of our spi into IKEv2 Proposal Substructure Payload
| our spi  79 ac bc 7a
| *******emit IKEv2 Transform Substructure Payload:
|    next payload type: ISAKMP_NEXT_T
|    transform type: 1
|    transform ID: 12
| emitting length of IKEv2 Transform Substructure Payload: 8
| *******emit IKEv2 Transform Substructure Payload:
|    next payload type: ISAKMP_NEXT_T
|    transform type: 3
|    transform ID: 2
| emitting length of IKEv2 Transform Substructure Payload: 8
| *******emit IKEv2 Transform Substructure Payload:
|    next payload type: ISAKMP_NEXT_NONE
|    transform type: 5
|    transform ID: 0
| emitting length of IKEv2 Transform Substructure Payload: 8
| emitting length of IKEv2 Proposal Substructure Payload: 36
| ******emit IKEv2 Proposal Substructure Payload:
|    next payload type: ISAKMP_NEXT_P
|    prop #: 2
|    proto ID: 3
|    spi size: 4
|    # transforms: 3
| emitting 4 raw bytes of our spi into IKEv2 Proposal Substructure Payload
| our spi  79 ac bc 7a
| *******emit IKEv2 Transform Substructure Payload:
|    next payload type: ISAKMP_NEXT_T
|    transform type: 1
|    transform ID: 12
| emitting length of IKEv2 Transform Substructure Payload: 8
| *******emit IKEv2 Transform Substructure Payload:
|    next payload type: ISAKMP_NEXT_T
|    transform type: 3
|    transform ID: 2
| emitting length of IKEv2 Transform Substructure Payload: 8
| *******emit IKEv2 Transform Substructure Payload:
|    next payload type: ISAKMP_NEXT_NONE
|    transform type: 5
|    transform ID: 0
| emitting length of IKEv2 Transform Substructure Payload: 8
| emitting length of IKEv2 Proposal Substructure Payload: 36
| ******emit IKEv2 Proposal Substructure Payload:
|    next payload type: ISAKMP_NEXT_P
|    prop #: 3
|    proto ID: 3
|    spi size: 4
|    # transforms: 3
| emitting 4 raw bytes of our spi into IKEv2 Proposal Substructure Payload
| our spi  79 ac bc 7a
| *******emit IKEv2 Transform Substructure Payload:
|    next payload type: ISAKMP_NEXT_T
|    transform type: 1
|    transform ID: 3
| emitting length of IKEv2 Transform Substructure Payload: 8
| *******emit IKEv2 Transform Substructure Payload:
|    next payload type: ISAKMP_NEXT_T
|    transform type: 3
|    transform ID: 2
| emitting length of IKEv2 Transform Substructure Payload: 8
| *******emit IKEv2 Transform Substructure Payload:
|    next payload type: ISAKMP_NEXT_NONE
|    transform type: 5
|    transform ID: 0
| emitting length of IKEv2 Transform Substructure Payload: 8
| emitting length of IKEv2 Proposal Substructure Payload: 36
| ******emit IKEv2 Proposal Substructure Payload:
|    next payload type: ISAKMP_NEXT_NONE
|    prop #: 4
|    proto ID: 3
|    spi size: 4
|    # transforms: 3
| emitting 4 raw bytes of our spi into IKEv2 Proposal Substructure Payload
| our spi  79 ac bc 7a
| *******emit IKEv2 Transform Substructure Payload:
|    next payload type: ISAKMP_NEXT_T
|    transform type: 1
|    transform ID: 3
| emitting length of IKEv2 Transform Substructure Payload: 8
| *******emit IKEv2 Transform Substructure Payload:
|    next payload type: ISAKMP_NEXT_T
|    transform type: 3
|    transform ID: 2
| emitting length of IKEv2 Transform Substructure Payload: 8
| *******emit IKEv2 Transform Substructure Payload:
|    next payload type: ISAKMP_NEXT_NONE
|    transform type: 5
|    transform ID: 0
| emitting length of IKEv2 Transform Substructure Payload: 8
| emitting length of IKEv2 Proposal Substructure Payload: 36
| emitting length of IKEv2 Security Association Payload: 148
| *****emit IKEv2 Traffic Selectors:
|    next payload type: ISAKMP_NEXT_v2TSr
|    number of TS: 1
| ******emit IKEv2 Traffic Selectors:
|    TS type: ID_IPV4_ADDR_RANGE
|    IP Protocol ID: 0
|    start port: 0
|    end port: 65535
| emitting 4 raw bytes of ipv4 low into IKEv2 Traffic Selectors
| ipv4 low  c0 00 01 00
| emitting 4 raw bytes of ipv4 high into IKEv2 Traffic Selectors
| ipv4 high  c0 00 01 ff
| emitting length of IKEv2 Traffic Selectors: 16
| emitting length of IKEv2 Traffic Selectors: 24
| *****emit IKEv2 Traffic Selectors:
|    next payload type: ISAKMP_NEXT_NONE
|    number of TS: 1
| ******emit IKEv2 Traffic Selectors:
|    TS type: ID_IPV4_ADDR_RANGE
|    IP Protocol ID: 0
|    start port: 0
|    end port: 65535
| emitting 4 raw bytes of ipv4 low into IKEv2 Traffic Selectors
| ipv4 low  c0 00 02 00
| emitting 4 raw bytes of ipv4 high into IKEv2 Traffic Selectors
| ipv4 high  c0 00 02 ff
| emitting length of IKEv2 Traffic Selectors: 16
| emitting length of IKEv2 Traffic Selectors: 24
| emitting 4 raw bytes of padding and length into cleartext
| padding and length  00 01 02 03
| emitting 12 zero bytes of 96-bits of truncated HMAC into IKEv2 Encryption Payload
| emitting length of IKEv2 Encryption Payload: 272
| emitting length of ISAKMP Message: 300
| data before encryption:
|   27 00 00 0c  02 00 00 00  77 65 73 74  21 00 00 1c
|   02 00 00 00  ad 69 56 f3  ec 93 3b 29  21 d1 7a 87
|   2c cb 92 a5  7b 57 91 ea  2c 80 00 94  02 00 00 24
|   01 03 04 03  79 ac bc 7a  03 00 00 08  01 00 00 0c
|   03 00 00 08  03 00 00 02  00 00 00 08  05 00 00 00
|   02 00 00 24  02 03 04 03  79 ac bc 7a  03 00 00 08
|   01 00 00 0c  03 00 00 08  03 00 00 02  00 00 00 08
|   05 00 00 00  02 00 00 24  03 03 04 03  79 ac bc 7a
|   03 00 00 08  01 00 00 03  03 00 00 08  03 00 00 02
|   00 00 00 08  05 00 00 00  00 00 00 24  04 03 04 03
|   79 ac bc 7a  03 00 00 08  01 00 00 03  03 00 00 08
|   03 00 00 02  00 00 00 08  05 00 00 00  2d 00 00 18
|   01 00 00 00  07 00 00 10  00 00 ff ff  c0 00 01 00
|   c0 00 01 ff  00 00 00 18  01 00 00 00  07 00 00 10
|   00 00 ff ff  c0 00 02 00  c0 00 02 ff  00 01 02 03
| data after encryption:
|   59 4a 80 f2  31 64 64 1f  a3 a4 b1 fe  ab 9f 8c 2e
|   61 12 72 ec  68 7f 47 15  89 c9 d7 f1  12 d3 d1 38
|   19 50 25 24  f2 1a 6e 76  30 f0 be f0  8a ff 35 7f
|   a2 e7 be 50  bc 54 7c ec  77 b8 d7 68  13 03 04 36
|   2c dc cb ae  00 c6 f6 8d  88 5f 70 ce  65 ac 6b f0
|   60 4a e6 18  2e db 70 5b  20 15 47 7d  b6 1f 62 4f
|   96 e9 8a 65  b4 b2 51 be  53 27 83 89  f2 a5 22 69
|   81 f1 b0 07  40 eb 64 28  3f 40 d1 65  28 84 c7 93
|   44 2d 87 8e  4e 95 6b ba  b8 7c f1 00  dd d4 34 3a
|   14 ec 78 fb  f4 51 2b 4d  f1 ca 9b 8b  eb ed 19 89
|   c7 22 d5 45  57 55 d4 0e  ee 4d 6e f8  63 c7 3a 5a
|   93 2e 00 fa  b2 d7 eb 08  ff 9c d7 a8  28 6e 87 94
|   be 47 02 b0  5b ee 48 8a  05 bb f8 e2  46 53 b8 bc
|   11 45 cc 9a  da 77 b8 01  22 37 c8 a3  58 0c 95 4a
|   8c 02 dd 0a  58 4c d9 fb  fc 4d 55 b2  4c eb 66 ea
| data being hmac:  e8 05 90 ca  d2 3a ee 04  cc da 96 3d  aa 0f fc 9f
| data being hmac:  2e 20 23 08  00 00 00 01  00 00 01 2c  23 80 01 10
| data being hmac:  87 95 00 af  38 2a 57 82  05 39 66 01  b9 96 95 ce
| data being hmac:  59 4a 80 f2  31 64 64 1f  a3 a4 b1 fe  ab 9f 8c 2e
| data being hmac:  61 12 72 ec  68 7f 47 15  89 c9 d7 f1  12 d3 d1 38
| data being hmac:  19 50 25 24  f2 1a 6e 76  30 f0 be f0  8a ff 35 7f
| data being hmac:  a2 e7 be 50  bc 54 7c ec  77 b8 d7 68  13 03 04 36
| data being hmac:  2c dc cb ae  00 c6 f6 8d  88 5f 70 ce  65 ac 6b f0
| data being hmac:  60 4a e6 18  2e db 70 5b  20 15 47 7d  b6 1f 62 4f
| data being hmac:  96 e9 8a 65  b4 b2 51 be  53 27 83 89  f2 a5 22 69
| data being hmac:  81 f1 b0 07  40 eb 64 28  3f 40 d1 65  28 84 c7 93
| data being hmac:  44 2d 87 8e  4e 95 6b ba  b8 7c f1 00  dd d4 34 3a
| data being hmac:  14 ec 78 fb  f4 51 2b 4d  f1 ca 9b 8b  eb ed 19 89
| data being hmac:  c7 22 d5 45  57 55 d4 0e  ee 4d 6e f8  63 c7 3a 5a
| data being hmac:  93 2e 00 fa  b2 d7 eb 08  ff 9c d7 a8  28 6e 87 94
| data being hmac:  be 47 02 b0  5b ee 48 8a  05 bb f8 e2  46 53 b8 bc
| data being hmac:  11 45 cc 9a  da 77 b8 01  22 37 c8 a3  58 0c 95 4a
| data being hmac:  8c 02 dd 0a  58 4c d9 fb  fc 4d 55 b2  4c eb 66 ea
| out calculated auth:
|   56 aa 2a fb  fb d9 73 78  94 20 de 27
| complete v2 state transition with STF_OK
"westnet--eastnet-ikev2" #2: transition from state STATE_PARENT_I1 to state STATE_PARENT_I2
"westnet--eastnet-ikev2" #2: STATE_PARENT_I2: sent v2I2, expected v2R2 {auth=IKEv2 cipher=aes_128 integ=sha1 prf=oakley_sha group=modp2048}
| sending reply packet to 192.1.2.23:500 (from port 500)
| sending 300 bytes for STATE_PARENT_I1 through eth1:500 to 192.1.2.23:500 (using #2)
|   e8 05 90 ca  d2 3a ee 04  cc da 96 3d  aa 0f fc 9f
|   2e 20 23 08  00 00 00 01  00 00 01 2c  23 80 01 10
|   87 95 00 af  38 2a 57 82  05 39 66 01  b9 96 95 ce
|   59 4a 80 f2  31 64 64 1f  a3 a4 b1 fe  ab 9f 8c 2e
|   61 12 72 ec  68 7f 47 15  89 c9 d7 f1  12 d3 d1 38
|   19 50 25 24  f2 1a 6e 76  30 f0 be f0  8a ff 35 7f
|   a2 e7 be 50  bc 54 7c ec  77 b8 d7 68  13 03 04 36
|   2c dc cb ae  00 c6 f6 8d  88 5f 70 ce  65 ac 6b f0
|   60 4a e6 18  2e db 70 5b  20 15 47 7d  b6 1f 62 4f
|   96 e9 8a 65  b4 b2 51 be  53 27 83 89  f2 a5 22 69
|   81 f1 b0 07  40 eb 64 28  3f 40 d1 65  28 84 c7 93
|   44 2d 87 8e  4e 95 6b ba  b8 7c f1 00  dd d4 34 3a
|   14 ec 78 fb  f4 51 2b 4d  f1 ca 9b 8b  eb ed 19 89
|   c7 22 d5 45  57 55 d4 0e  ee 4d 6e f8  63 c7 3a 5a
|   93 2e 00 fa  b2 d7 eb 08  ff 9c d7 a8  28 6e 87 94
|   be 47 02 b0  5b ee 48 8a  05 bb f8 e2  46 53 b8 bc
|   11 45 cc 9a  da 77 b8 01  22 37 c8 a3  58 0c 95 4a
|   8c 02 dd 0a  58 4c d9 fb  fc 4d 55 b2  4c eb 66 ea
|   56 aa 2a fb  fb d9 73 78  94 20 de 27
| * processed 1 messages from cryptographic helpers 
| next event EVENT_SHUNT_SCAN in 76 seconds
|  
| *received 204 bytes from 192.1.2.23:500 on eth1 (port=500)
|   e8 05 90 ca  d2 3a ee 04  cc da 96 3d  aa 0f fc 9f
|   2e 20 23 20  00 00 00 01  00 00 00 cc  24 80 00 b0
|   98 52 d4 19  22 48 de dd  31 96 05 86  68 ec 29 8e
|   1e 66 04 ae  99 bf 7b 22  10 be 34 89  2d ff aa 79
|   82 48 8f 40  df 3e 4d 22  04 ac b7 5b  da 45 f3 ed
|   45 c1 40 bd  d3 31 6e 7a  cb 96 8b e2  9c 82 b8 ca
|   67 77 f2 ef  65 1b c7 87  50 51 e3 8e  35 55 1a 68
|   ca 95 cf f5  a4 45 0b 7e  65 65 3d 96  b7 95 9e 9e
|   8f 8c 27 dc  63 7b ea 9b  dd b0 1f ec  13 61 d3 94
|   7b 49 30 42  29 fa eb 70  15 b9 5f 28  e5 6a a6 83
|   a9 3d 17 04  e8 04 b1 1f  70 31 82 6b  4b 78 ce 74
|   21 4b 88 ca  c7 5f 96 84  05 21 58 bf  4b 18 da ab
|   b4 5e 34 4c  13 d6 87 4f  3a bd 87 b6
| **parse ISAKMP Message:
|    initiator cookie:
|   e8 05 90 ca  d2 3a ee 04
|    responder cookie:
|   cc da 96 3d  aa 0f fc 9f
|    next payload type: ISAKMP_NEXT_v2E
|    ISAKMP version: IKEv2 version 2.0 (rfc4306)
|    exchange type: ISAKMP_v2_AUTH
|    flags: ISAKMP_FLAG_RESPONSE
|    message ID:  00 00 00 01
|    length: 204
|  processing version=2.0 packet with exchange type=ISAKMP_v2_AUTH (35)
| ICOOKIE:  e8 05 90 ca  d2 3a ee 04
| RCOOKIE:  cc da 96 3d  aa 0f fc 9f
| state hash entry 18
| v2 peer, cookies and msgid match on #2
| v2 state object #2 found, in STATE_PARENT_I2
| ***parse IKEv2 Encryption Payload:
|    next payload type: ISAKMP_NEXT_v2IDr
|    critical bit: Payload-Critical
|    length: 176
| processing payload: ISAKMP_NEXT_v2E (len=176) 
| ikev2 parent inR2: calculating g^{xy} in order to decrypt I2
| data being hmac:  e8 05 90 ca  d2 3a ee 04  cc da 96 3d  aa 0f fc 9f
| data being hmac:  2e 20 23 20  00 00 00 01  00 00 00 cc  24 80 00 b0
| data being hmac:  98 52 d4 19  22 48 de dd  31 96 05 86  68 ec 29 8e
| data being hmac:  1e 66 04 ae  99 bf 7b 22  10 be 34 89  2d ff aa 79
| data being hmac:  82 48 8f 40  df 3e 4d 22  04 ac b7 5b  da 45 f3 ed
| data being hmac:  45 c1 40 bd  d3 31 6e 7a  cb 96 8b e2  9c 82 b8 ca
| data being hmac:  67 77 f2 ef  65 1b c7 87  50 51 e3 8e  35 55 1a 68
| data being hmac:  ca 95 cf f5  a4 45 0b 7e  65 65 3d 96  b7 95 9e 9e
| data being hmac:  8f 8c 27 dc  63 7b ea 9b  dd b0 1f ec  13 61 d3 94
| data being hmac:  7b 49 30 42  29 fa eb 70  15 b9 5f 28  e5 6a a6 83
| data being hmac:  a9 3d 17 04  e8 04 b1 1f  70 31 82 6b  4b 78 ce 74
| data being hmac:  21 4b 88 ca  c7 5f 96 84  05 21 58 bf  4b 18 da ab
| R2 calculated auth:  b4 5e 34 4c  13 d6 87 4f  3a bd 87 b6
| R2  provided  auth:  b4 5e 34 4c  13 d6 87 4f  3a bd 87 b6
| authenticator matched
| data before decryption:
|   1e 66 04 ae  99 bf 7b 22  10 be 34 89  2d ff aa 79
|   82 48 8f 40  df 3e 4d 22  04 ac b7 5b  da 45 f3 ed
|   45 c1 40 bd  d3 31 6e 7a  cb 96 8b e2  9c 82 b8 ca
|   67 77 f2 ef  65 1b c7 87  50 51 e3 8e  35 55 1a 68
|   ca 95 cf f5  a4 45 0b 7e  65 65 3d 96  b7 95 9e 9e
|   8f 8c 27 dc  63 7b ea 9b  dd b0 1f ec  13 61 d3 94
|   7b 49 30 42  29 fa eb 70  15 b9 5f 28  e5 6a a6 83
|   a9 3d 17 04  e8 04 b1 1f  70 31 82 6b  4b 78 ce 74
|   21 4b 88 ca  c7 5f 96 84  05 21 58 bf  4b 18 da ab
| decrypted payload:  27 00 00 0c  02 00 00 00  65 61 73 74  21 00 00 1c
| decrypted payload:  02 00 00 00  a1 be 03 d7  3e 62 4c 0f  37 f0 90 7c
| decrypted payload:  bf 7b 8a 88  44 46 ca c4  2c 80 00 28  00 00 00 24
| decrypted payload:  01 03 04 03  b3 74 a8 93  03 00 00 08  01 00 00 0c
| decrypted payload:  03 00 00 08  03 00 00 02  00 00 00 08  05 00 00 00
| decrypted payload:  2d 00 00 18  01 00 00 00  07 00 00 10  00 00 ff ff
| decrypted payload:  c0 00 01 00  c0 00 01 ff  00 00 00 18  01 00 00 00
| decrypted payload:  07 00 00 10  00 00 ff ff  c0 00 02 00  c0 00 02 ff
| decrypted payload:  00 01 02 03  04 05 06 07  08 09 0a 0b  0c 0d 0e 0f
| striping 16 bytes as pad
| **parse IKEv2 Identification Payload:
|    next payload type: ISAKMP_NEXT_v2AUTH
|    length: 12
|    id_type: ID_FQDN
| processing payload: ISAKMP_NEXT_v2IDr (len=12) 
| **parse IKEv2 Authentication Payload:
|    next payload type: ISAKMP_NEXT_v2SA
|    length: 28
|    auth method: v2_AUTH_SHARED
| processing payload: ISAKMP_NEXT_v2AUTH (len=28) 
| **parse IKEv2 Security Association Payload:
|    next payload type: ISAKMP_NEXT_v2TSi
|    critical bit: Payload-Critical
|    length: 40
| processing payload: ISAKMP_NEXT_v2SA (len=40) 
| **parse IKEv2 Traffic Selectors:
|    next payload type: ISAKMP_NEXT_v2TSr
|    length: 24
|    number of TS: 1
| processing payload: ISAKMP_NEXT_v2TSi (len=24) 
| **parse IKEv2 Traffic Selectors:
|    next payload type: ISAKMP_NEXT_NONE
|    length: 24
|    number of TS: 1
| processing payload: ISAKMP_NEXT_v2TSr (len=24) 
packet from 192.1.2.23:500: IKEv2 mode peer ID is ID_FQDN: '@east'
| idhash verify pr  18 b0 54 eb  b8 59 68 dc  66 60 31 2f  52 a6 e5 66
| idhash verify pr  dd 1c f2 57
| idhash auth R2  02 00 00 00  65 61 73 74
| started looking for secret for @west->@east of kind PPK_PSK
| actually looking for secret for @west->@east of kind PPK_PSK
| line 27: key type PPK_PSK(@west) to type PPK_PSK 
| 1: compared key @east to @west / @east -> 2
| 2: compared key @west to @west / @east -> 6
| line 27: match=6 
| best_match 0>6 best=0x814a4f8 (line=27)
| line 8: key type PPK_PSK(@west) to type PPK_RSA 
| concluding with best_match=6 best=0x814a4f8 (lineno=27)
| negotiated prf: oakley_sha hash length: 20
| inner prf ouput  32 1f 3f cb  b0 71 c5 e9  cf fb 04 98  9e 4d 6e e6
| inner prf ouput  e1 34 7b 93
| inputs to hash1 (first packet)
|   e8 05 90 ca  d2 3a ee 04  cc da 96 3d  aa 0f fc 9f
|   21 20 22 20  00 00 00 00  00 00 01 74  22 80 00 2c
|   00 00 00 28  01 01 00 04  03 00 00 08  01 00 00 0c
|   03 00 00 08  03 00 00 02  03 00 00 08  02 00 00 02
|   00 00 00 08  04 00 00 0e  28 00 01 08  00 0e 00 00
|   50 92 aa f6  39 24 85 8a  ef c2 9a 4c  8e 7c 85 17
|   1f 4a 76 46  6a e2 02 0b  5a 92 73 32  48 e9 1e e9
|   03 83 c2 2f  10 7c 3e e5  8a 33 11 d7  81 a8 ba 5a
|   d9 44 db f9  70 f1 34 66  f7 da 2e 05  d0 74 39 35
|   83 4a 27 b6  58 54 93 2a  19 27 d2 c2  fa bf 86 d9
|   4e 20 2a 26  ae 43 5a 01  e8 fd 1d 76  85 9d 82 2c
|   94 b7 cf 24  3d 6a fc 16  26 64 83 a1  e7 e1 95 db
|   61 35 62 08  83 84 cd 17  b5 4e 47 8c  90 b0 d0 fa
|   01 2b d4 c5  bc 2e 28 0c  ae 69 fb 0a  3c e7 a6 b1
|   09 1d ef 3f  11 79 13 82  34 e0 46 79  30 2a 73 4b
|   4c ed 15 1b  da e6 3f 1f  33 05 68 2c  01 92 1a 47
|   4f a2 2a 3f  4c 62 99 73  8b 47 be 3e  d5 ba ea 6c
|   a8 d5 b4 2e  31 d9 24 3c  23 be 3a d2  13 5d e9 6b
|   d7 c5 f9 ea  f0 0a b0 56  eb a2 38 2b  2d 30 11 a5
|   22 6d bd 34  89 e2 bd 2f  7e 73 0f 15  20 1b 5f 33
|   9b e3 b4 6d  4c 32 e1 b8  80 5b a1 25  d7 1a 5b 9b
|   2b 80 00 14  1d 2e ea bc  d0 50 3f 27  63 ea 99 08
|   de fa b8 f4  00 00 00 10  4f 45 71 6a  45 7f 70 51
|   5c 6b 70 4c
| inputs to hash2 (initiator nonce)
|   6b 98 11 b2  fe e7 5c 89  de 6a 5f 3d  14 83 b6 25
| idhash  93 60 42 65  bf c3 7e 83  f4 b1 fb 55  07 9d fb f9
| idhash  46 bc 66 64
| Received PSK auth octets
|   a1 be 03 d7  3e 62 4c 0f  37 f0 90 7c  bf 7b 8a 88
|   44 46 ca c4
| Calculated PSK auth octets
|   a1 be 03 d7  3e 62 4c 0f  37 f0 90 7c  bf 7b 8a 88
|   44 46 ca c4
| empty esp_info, returning defaults
| ***parse IKEv2 Proposal Substructure Payload:
|    next payload type: ISAKMP_NEXT_NONE
|    length: 36
|    prop #: 1
|    proto ID: 3
|    spi size: 4
|    # transforms: 3
| parsing 4 raw bytes of IKEv2 Proposal Substructure Payload into CHILD SA SPI
| CHILD SA SPI  b3 74 a8 93
| SPI received: b374a893
| ****parse IKEv2 Transform Substructure Payload:
|    next payload type: ISAKMP_NEXT_T
|    length: 8
|    transform type: 1
|    transform ID: 12
| ****parse IKEv2 Transform Substructure Payload:
|    next payload type: ISAKMP_NEXT_T
|    length: 8
|    transform type: 3
|    transform ID: 2
| ****parse IKEv2 Transform Substructure Payload:
|    next payload type: ISAKMP_NEXT_NONE
|    length: 8
|    transform type: 5
|    transform ID: 0
| kernel_alg_esp_info():transid=12, auth=2, ei=0x812b6b4, enckeylen=16, authkeylen=20, encryptalg=12, authalg=3
| prf+[0]:  07 6b 0e 42  e0 43 31 94  b9 97 43 b9  c6 54 95 12
| prf+[0]:  15 f4 2f 7e
| prf+[1]:  46 be 45 19  09 8c 8f c3  31 82 96 f9  c6 2c cd 19
| prf+[1]:  8e f1 14 da
| prf+[2]:  b0 af 93 f9  c5 b0 b8 1b  3b ec 3b 0b  19 44 96 e1
| prf+[2]:  f3 c4 09 63
| prf+[3]:  4d 30 f9 cb  46 b8 c7 41  eb c5 f3 8c  ab 07 f4 15
| prf+[3]:  71 15 e0 19
| our  keymat  07 6b 0e 42  e0 43 31 94  b9 97 43 b9  c6 54 95 12
| our  keymat  15 f4 2f 7e  46 be 45 19  09 8c 8f c3  31 82 96 f9
| our  keymat  c6 2c cd 19
| peer keymat  8e f1 14 da  b0 af 93 f9  c5 b0 b8 1b  3b ec 3b 0b
| peer keymat  19 44 96 e1  f3 c4 09 63  4d 30 f9 cb  46 b8 c7 41
| peer keymat  eb c5 f3 8c
| install_ipsec_sa() for #2: inbound and outbound
| route owner of "westnet--eastnet-ikev2" unrouted: NULL; eroute owner: NULL
| could_route called for westnet--eastnet-ikev2 (kind=CK_PERMANENT)
| pfkey_lib_debug:pfkey_msg_hdr_build: 
| pfkey_lib_debug:pfkey_msg_hdr_build: on_entry &pfkey_ext=0p0xbf6fc720 pfkey_ext=0p0xbf6fd814 *pfkey_ext=0p(nil). 
| pfkey_lib_debug:pfkey_msg_hdr_build: on_exit &pfkey_ext=0p0xbf6fc720 pfkey_ext=0p0xbf6fd814 *pfkey_ext=0p0x814e538. 
| pfkey_lib_debug:pfkey_sa_build: spi=00001001 replay=0 sa_state=1 auth=0 encrypt=0 flags=0 
| pfkey_lib_debug:pfkey_address_build: exttype=5 proto=0 prefixlen=0 
| pfkey_lib_debug:pfkey_address_build: found address family AF_INET. 
| pfkey_lib_debug:pfkey_address_build: found address=192.1.2.45:0. 
| pfkey_lib_debug:pfkey_address_build: successful created len: 3. 
| pfkey_lib_debug:pfkey_address_build: exttype=6 proto=0 prefixlen=0 
| pfkey_lib_debug:pfkey_address_build: found address family AF_INET. 
| pfkey_lib_debug:pfkey_address_build: found address=192.1.2.23:0. 
| pfkey_lib_debug:pfkey_address_build: successful created len: 3. 
| pfkey_lib_debug:pfkey_msg_build: pfkey_msg=0p0x814ea80 allocated 88 bytes, &(extensions[0])=0p0xbf6fd814 
| pfkey_lib_debug:pfkey_msg_build: copying 24 bytes from extensions[1] (type=1) 
| pfkey_lib_debug:pfkey_msg_build: copying 24 bytes from extensions[5] (type=5) 
| pfkey_lib_debug:pfkey_msg_build: copying 24 bytes from extensions[6] (type=6) 
| pfkey_lib_debug:pfkey_msg_build: extensions permitted=78001ffb, seen=00000063, required=00000063. 
| pfkey_lib_debug:pfkey_msg_parse: parsing message ver=2, type=3(add), errno=0, satype=9(IPIP), len=11, res=0, seq=5, pid=916. 
| pfkey_lib_debug:pfkey_msg_parse: satype 9(IPIP) conversion to proto gives 4 for msg_type 3(add). 
| pfkey_lib_debug:pfkey_msg_parse: remain=9 
| pfkey_lib_debug:pfkey_msg_parse: extensions permitted=78001ffb, required=00000063. 
| pfkey_lib_debug:pfkey_msg_parse: parsing ext type=1(security-association) remain=9. 
| pfkey_lib_debug:pfkey_msg_parse: remain=9 ext_type=1(security-association) ext_len=3 parsing ext 0p0x814ea90 with parser pfkey_sa_parse. 
| pfkey_lib_debug:pfkey_sa_parse: successfully found len=3 exttype=1(security-association) spi=00001001 replay=0 state=1 auth=0 encrypt=0 flags=0 ref=0. 
| pfkey_lib_debug:pfkey_msg_parse: Extension 1(security-association) parsed. 
| pfkey_lib_debug:pfkey_msg_parse: parsing ext type=5(source-address) remain=6. 
| pfkey_lib_debug:pfkey_msg_parse: remain=6 ext_type=5(source-address) ext_len=3 parsing ext 0p0x814eaa8 with parser pfkey_address_parse. 
| pfkey_lib_debug:pfkey_address_parse: found exttype=5(source-address) family=2(AF_INET) address=192.1.2.45 proto=0 port=0. 
| pfkey_lib_debug:pfkey_address_parse: successful. 
| pfkey_lib_debug:pfkey_msg_parse: Extension 5(source-address) parsed. 
| pfkey_lib_debug:pfkey_msg_parse: parsing ext type=6(destination-address) remain=3. 
| pfkey_lib_debug:pfkey_msg_parse: remain=3 ext_type=6(destination-address) ext_len=3 parsing ext 0p0x814eac0 with parser pfkey_address_parse. 
| pfkey_lib_debug:pfkey_address_parse: found exttype=6(destination-address) family=2(AF_INET) address=192.1.2.23 proto=0 port=0. 
| pfkey_lib_debug:pfkey_address_parse: successful. 
| pfkey_lib_debug:pfkey_msg_parse: Extension 6(destination-address) parsed. 
| pfkey_lib_debug:pfkey_msg_parse: extensions permitted=78001ffb, seen=00000063, required=00000063. 
| finish_pfkey_msg: SADB_ADD message 5 for Add SA tun.1001@192.1.2.23
|   02 03 00 09  0b 00 00 00  05 00 00 00  94 03 00 00
|   03 00 01 00  00 00 10 01  00 01 00 00  00 00 00 00
|   00 00 00 00  00 00 00 00  03 00 05 00  00 00 00 00
|   02 00 00 00  c0 01 02 2d  00 00 00 00  00 00 00 00
|   03 00 06 00  00 00 00 00  02 00 00 00  c0 01 02 17
|   00 00 00 00  00 00 00 00
| pfkey_get: SADB_ADD message 5
| pfkey_lib_debug:pfkey_msg_parse: parsing message ver=2, type=3(add), errno=0, satype=9(IPIP), len=11, res=0, seq=5, pid=916. 
| pfkey_lib_debug:pfkey_msg_parse: satype 9(IPIP) conversion to proto gives 4 for msg_type 3(add). 
| pfkey_lib_debug:pfkey_msg_parse: remain=9 
| pfkey_lib_debug:pfkey_msg_parse: extensions permitted=78001ffb, required=00000063. 
| pfkey_lib_debug:pfkey_msg_parse: parsing ext type=1(security-association) remain=9. 
| pfkey_lib_debug:pfkey_msg_parse: remain=9 ext_type=1(security-association) ext_len=3 parsing ext 0p0xbf6fc824 with parser pfkey_sa_parse. 
| pfkey_lib_debug:pfkey_sa_parse: successfully found len=3 exttype=1(security-association) spi=00001001 replay=0 state=1 auth=0 encrypt=0 flags=0 ref=3. 
| pfkey_lib_debug:pfkey_msg_parse: Extension 1(security-association) parsed. 
| pfkey_lib_debug:pfkey_msg_parse: parsing ext type=5(source-address) remain=6. 
| pfkey_lib_debug:pfkey_msg_parse: remain=6 ext_type=5(source-address) ext_len=3 parsing ext 0p0xbf6fc83c with parser pfkey_address_parse. 
| pfkey_lib_debug:pfkey_address_parse: found exttype=5(source-address) family=2(AF_INET) address=192.1.2.45 proto=0 port=0. 
| pfkey_lib_debug:pfkey_address_parse: successful. 
| pfkey_lib_debug:pfkey_msg_parse: Extension 5(source-address) parsed. 
| pfkey_lib_debug:pfkey_msg_parse: parsing ext type=6(destination-address) remain=3. 
| pfkey_lib_debug:pfkey_msg_parse: remain=3 ext_type=6(destination-address) ext_len=3 parsing ext 0p0xbf6fc854 with parser pfkey_address_parse. 
| pfkey_lib_debug:pfkey_address_parse: found exttype=6(destination-address) family=2(AF_INET) address=192.1.2.23 proto=0 port=0. 
| pfkey_lib_debug:pfkey_address_parse: successful. 
| pfkey_lib_debug:pfkey_msg_parse: Extension 6(destination-address) parsed. 
| pfkey_lib_debug:pfkey_msg_parse: extensions permitted=78001ffb, seen=00000063, required=00000063. 
| added tunnel with ref=0
| recorded ref=0 as refhim
| looking for alg with transid: 12 keylen: 128 auth: 2 
| checking transid: 11 keylen: 0 auth: 1 
| checking transid: 11 keylen: 0 auth: 2 
| checking transid: 2 keylen: 8 auth: 0 
| checking transid: 2 keylen: 8 auth: 1 
| checking transid: 2 keylen: 8 auth: 2 
| checking transid: 3 keylen: 24 auth: 0 
| checking transid: 3 keylen: 24 auth: 1 
| checking transid: 3 keylen: 24 auth: 2 
| checking transid: 12 keylen: 16 auth: 0 
| checking transid: 12 keylen: 16 auth: 1 
| checking transid: 12 keylen: 16 auth: 2 
| pfkey_lib_debug:pfkey_msg_hdr_build: 
| pfkey_lib_debug:pfkey_msg_hdr_build: on_entry &pfkey_ext=0p0xbf6fc720 pfkey_ext=0p0xbf6fd814 *pfkey_ext=0p(nil). 
| pfkey_lib_debug:pfkey_msg_hdr_build: on_exit &pfkey_ext=0p0xbf6fc720 pfkey_ext=0p0xbf6fd814 *pfkey_ext=0p0x814e538. 
| pfkey_lib_debug:pfkey_sa_build: spi=b374a893 replay=64 sa_state=1 auth=3 encrypt=12 flags=0 
| pfkey_lib_debug:pfkey_address_build: exttype=5 proto=0 prefixlen=0 
| pfkey_lib_debug:pfkey_address_build: found address family AF_INET. 
| pfkey_lib_debug:pfkey_address_build: found address=192.1.2.45:0. 
| pfkey_lib_debug:pfkey_address_build: successful created len: 3. 
| pfkey_lib_debug:pfkey_address_build: exttype=6 proto=0 prefixlen=0 
| pfkey_lib_debug:pfkey_address_build: found address family AF_INET. 
| pfkey_lib_debug:pfkey_address_build: found address=192.1.2.23:0. 
| pfkey_lib_debug:pfkey_address_build: successful created len: 3. 
| pfkey_lib_debug:pfkey_key_build: 
| pfkey_lib_debug:pfkey_key_build: 
| pfkey_lib_debug:pfkey_msg_build: pfkey_msg=0p0x814eaa8 allocated 144 bytes, &(extensions[0])=0p0xbf6fd814 
| pfkey_lib_debug:pfkey_msg_build: copying 24 bytes from extensions[1] (type=1) 
| pfkey_lib_debug:pfkey_msg_build: copying 24 bytes from extensions[5] (type=5) 
| pfkey_lib_debug:pfkey_msg_build: copying 24 bytes from extensions[6] (type=6) 
| pfkey_lib_debug:pfkey_msg_build: copying 32 bytes from extensions[8] (type=8) 
| pfkey_lib_debug:pfkey_msg_build: copying 24 bytes from extensions[9] (type=9) 
| pfkey_lib_debug:pfkey_msg_build: extensions permitted=78001ffb, seen=00000363, required=00000063. 
| pfkey_lib_debug:pfkey_msg_parse: parsing message ver=2, type=3(add), errno=0, satype=3(ESP), len=18, res=0, seq=6, pid=916. 
| pfkey_lib_debug:pfkey_msg_parse: satype 3(ESP) conversion to proto gives 50 for msg_type 3(add). 
| pfkey_lib_debug:pfkey_msg_parse: remain=16 
| pfkey_lib_debug:pfkey_msg_parse: extensions permitted=78001ffb, required=00000063. 
| pfkey_lib_debug:pfkey_msg_parse: parsing ext type=1(security-association) remain=16. 
| pfkey_lib_debug:pfkey_msg_parse: remain=16 ext_type=1(security-association) ext_len=3 parsing ext 0p0x814eab8 with parser pfkey_sa_parse. 
| pfkey_lib_debug:pfkey_sa_parse: successfully found len=3 exttype=1(security-association) spi=b374a893 replay=64 state=1 auth=3 encrypt=12 flags=0 ref=0. 
| pfkey_lib_debug:pfkey_msg_parse: Extension 1(security-association) parsed. 
| pfkey_lib_debug:pfkey_msg_parse: parsing ext type=5(source-address) remain=13. 
| pfkey_lib_debug:pfkey_msg_parse: remain=13 ext_type=5(source-address) ext_len=3 parsing ext 0p0x814ead0 with parser pfkey_address_parse. 
| pfkey_lib_debug:pfkey_address_parse: found exttype=5(source-address) family=2(AF_INET) address=192.1.2.45 proto=0 port=0. 
| pfkey_lib_debug:pfkey_address_parse: successful. 
| pfkey_lib_debug:pfkey_msg_parse: Extension 5(source-address) parsed. 
| pfkey_lib_debug:pfkey_msg_parse: parsing ext type=6(destination-address) remain=10. 
| pfkey_lib_debug:pfkey_msg_parse: remain=10 ext_type=6(destination-address) ext_len=3 parsing ext 0p0x814eae8 with parser pfkey_address_parse. 
| pfkey_lib_debug:pfkey_address_parse: found exttype=6(destination-address) family=2(AF_INET) address=192.1.2.23 proto=0 port=0. 
| pfkey_lib_debug:pfkey_address_parse: successful. 
| pfkey_lib_debug:pfkey_msg_parse: Extension 6(destination-address) parsed. 
| pfkey_lib_debug:pfkey_msg_parse: parsing ext type=8(authentication-key) remain=7. 
| pfkey_lib_debug:pfkey_msg_parse: remain=7 ext_type=8(authentication-key) ext_len=4 parsing ext 0p0x814eb00 with parser pfkey_key_parse. 
| pfkey_lib_debug:pfkey_key_parse: success, found len=4 exttype=8(authentication-key) bits=160 reserved=0. 
| pfkey_lib_debug:pfkey_msg_parse: Extension 8(authentication-key) parsed. 
| pfkey_lib_debug:pfkey_msg_parse: parsing ext type=9(cipher-key) remain=3. 
| pfkey_lib_debug:pfkey_msg_parse: remain=3 ext_type=9(cipher-key) ext_len=3 parsing ext 0p0x814eb20 with parser pfkey_key_parse. 
| pfkey_lib_debug:pfkey_key_parse: success, found len=3 exttype=9(cipher-key) bits=128 reserved=0. 
| pfkey_lib_debug:pfkey_msg_parse: Extension 9(cipher-key) parsed. 
| pfkey_lib_debug:pfkey_msg_parse: extensions permitted=78001ffb, seen=00000363, required=00000063. 
| finish_pfkey_msg: SADB_ADD message 6 for Add SA esp.b374a893@192.1.2.23
|   02 03 00 03  12 00 00 00  06 00 00 00  94 03 00 00
|   03 00 01 00  b3 74 a8 93  40 01 03 0c  00 00 00 00
|   00 00 00 00  00 00 00 00  03 00 05 00  00 00 00 00
|   02 00 00 00  c0 01 02 2d  00 00 00 00  00 00 00 00
|   03 00 06 00  00 00 00 00  02 00 00 00  c0 01 02 17
|   00 00 00 00  00 00 00 00  04 00 08 00  a0 00 00 00
|   19 44 96 e1  f3 c4 09 63  4d 30 f9 cb  46 b8 c7 41
|   eb c5 f3 8c  00 00 00 00  03 00 09 00  80 00 00 00
|   8e f1 14 da  b0 af 93 f9  c5 b0 b8 1b  3b ec 3b 0b
| pfkey_get: SADB_ADD message 6
| pfkey_lib_debug:pfkey_msg_parse: parsing message ver=2, type=3(add), errno=0, satype=3(ESP), len=11, res=0, seq=6, pid=916. 
| pfkey_lib_debug:pfkey_msg_parse: satype 3(ESP) conversion to proto gives 50 for msg_type 3(add). 
| pfkey_lib_debug:pfkey_msg_parse: remain=9 
| pfkey_lib_debug:pfkey_msg_parse: extensions permitted=78001ffb, required=00000063. 
| pfkey_lib_debug:pfkey_msg_parse: parsing ext type=1(security-association) remain=9. 
| pfkey_lib_debug:pfkey_msg_parse: remain=9 ext_type=1(security-association) ext_len=3 parsing ext 0p0xbf6fc824 with parser pfkey_sa_parse. 
| pfkey_lib_debug:pfkey_sa_parse: successfully found len=3 exttype=1(security-association) spi=b374a893 replay=64 state=1 auth=3 encrypt=12 flags=0 ref=4. 
| pfkey_lib_debug:pfkey_msg_parse: Extension 1(security-association) parsed. 
| pfkey_lib_debug:pfkey_msg_parse: parsing ext type=5(source-address) remain=6. 
| pfkey_lib_debug:pfkey_msg_parse: remain=6 ext_type=5(source-address) ext_len=3 parsing ext 0p0xbf6fc83c with parser pfkey_address_parse. 
| pfkey_lib_debug:pfkey_address_parse: found exttype=5(source-address) family=2(AF_INET) address=192.1.2.45 proto=0 port=0. 
| pfkey_lib_debug:pfkey_address_parse: successful. 
| pfkey_lib_debug:pfkey_msg_parse: Extension 5(source-address) parsed. 
| pfkey_lib_debug:pfkey_msg_parse: parsing ext type=6(destination-address) remain=3. 
| pfkey_lib_debug:pfkey_msg_parse: remain=3 ext_type=6(destination-address) ext_len=3 parsing ext 0p0xbf6fc854 with parser pfkey_address_parse. 
| pfkey_lib_debug:pfkey_address_parse: found exttype=6(destination-address) family=2(AF_INET) address=192.1.2.23 proto=0 port=0. 
| pfkey_lib_debug:pfkey_address_parse: successful. 
| pfkey_lib_debug:pfkey_msg_parse: Extension 6(destination-address) parsed. 
| pfkey_lib_debug:pfkey_msg_parse: extensions permitted=78001ffb, seen=00000063, required=00000063. 
| grouping unk0.b374a893@192.1.2.23 (ref=0) and unk0.1001@192.1.2.23 (ref=0)
| pfkey_lib_debug:pfkey_msg_hdr_build: 
| pfkey_lib_debug:pfkey_msg_hdr_build: on_entry &pfkey_ext=0p0xbf6fd7d0 pfkey_ext=0p0xbf6fd824 *pfkey_ext=0p(nil). 
| pfkey_lib_debug:pfkey_msg_hdr_build: on_exit &pfkey_ext=0p0xbf6fd7d0 pfkey_ext=0p0xbf6fd824 *pfkey_ext=0p0x814e538. 
| pfkey_lib_debug:pfkey_sa_build: spi=00001001 replay=0 sa_state=0 auth=0 encrypt=0 flags=0 
| pfkey_lib_debug:pfkey_address_build: exttype=6 proto=0 prefixlen=0 
| pfkey_lib_debug:pfkey_address_build: found address family AF_INET. 
| pfkey_lib_debug:pfkey_address_build: found address=192.1.2.23:0. 
| pfkey_lib_debug:pfkey_address_build: successful created len: 3. 
| pfkey_lib_debug:pfkey_x_satype_build: 
| pfkey_lib_debug:pfkey_sa_build: spi=b374a893 replay=0 sa_state=0 auth=0 encrypt=0 flags=0 
| pfkey_lib_debug:pfkey_address_build: exttype=20 proto=0 prefixlen=0 
| pfkey_lib_debug:pfkey_address_build: found address family AF_INET. 
| pfkey_lib_debug:pfkey_address_build: found address=192.1.2.23:0. 
| pfkey_lib_debug:pfkey_address_build: successful created len: 3. 
| pfkey_lib_debug:pfkey_msg_build: pfkey_msg=0p0x814ea80 allocated 120 bytes, &(extensions[0])=0p0xbf6fd824 
| pfkey_lib_debug:pfkey_msg_build: copying 24 bytes from extensions[1] (type=1) 
| pfkey_lib_debug:pfkey_msg_build: copying 24 bytes from extensions[6] (type=6) 
| pfkey_lib_debug:pfkey_msg_build: copying 8 bytes from extensions[18] (type=18) 
| pfkey_lib_debug:pfkey_msg_build: copying 24 bytes from extensions[19] (type=19) 
| pfkey_lib_debug:pfkey_msg_build: copying 24 bytes from extensions[20] (type=20) 
| pfkey_lib_debug:pfkey_msg_build: extensions permitted=001c0043, seen=001c0043, required=00000043. 
| pfkey_lib_debug:pfkey_msg_parse: parsing message ver=2, type=13(x-groupsa), errno=0, satype=9(IPIP), len=15, res=0, seq=7, pid=916. 
| pfkey_lib_debug:pfkey_msg_parse: satype 9(IPIP) conversion to proto gives 4 for msg_type 13(x-groupsa). 
| pfkey_lib_debug:pfkey_msg_parse: remain=13 
| pfkey_lib_debug:pfkey_msg_parse: extensions permitted=001c0043, required=00000043. 
| pfkey_lib_debug:pfkey_msg_parse: parsing ext type=1(security-association) remain=13. 
| pfkey_lib_debug:pfkey_msg_parse: remain=13 ext_type=1(security-association) ext_len=3 parsing ext 0p0x814ea90 with parser pfkey_sa_parse. 
| pfkey_lib_debug:pfkey_sa_parse: successfully found len=3 exttype=1(security-association) spi=00001001 replay=0 state=0 auth=0 encrypt=0 flags=0 ref=0. 
| pfkey_lib_debug:pfkey_msg_parse: Extension 1(security-association) parsed. 
| pfkey_lib_debug:pfkey_msg_parse: parsing ext type=6(destination-address) remain=10. 
| pfkey_lib_debug:pfkey_msg_parse: remain=10 ext_type=6(destination-address) ext_len=3 parsing ext 0p0x814eaa8 with parser pfkey_address_parse. 
| pfkey_lib_debug:pfkey_address_parse: found exttype=6(destination-address) family=2(AF_INET) address=192.1.2.23 proto=0 port=0. 
| pfkey_lib_debug:pfkey_address_parse: successful. 
| pfkey_lib_debug:pfkey_msg_parse: Extension 6(destination-address) parsed. 
| pfkey_lib_debug:pfkey_msg_parse: parsing ext type=18(X-satype2) remain=7. 
| pfkey_lib_debug:pfkey_msg_parse: remain=7 ext_type=18(X-satype2) ext_len=1 parsing ext 0p0x814eac0 with parser pfkey_x_satype_parse. 
| pfkey_lib_debug:pfkey_x_satype_parse: enter 
| pfkey_lib_debug:pfkey_x_satype_parse: len=1 ext=18(X-satype2) satype=3(ESP) res=0,0,0. 
| pfkey_lib_debug:pfkey_msg_parse: Extension 18(X-satype2) parsed. 
| pfkey_lib_debug:pfkey_msg_parse: parsing ext type=19(X-security-association) remain=6. 
| pfkey_lib_debug:pfkey_msg_parse: remain=6 ext_type=19(X-security-association) ext_len=3 parsing ext 0p0x814eac8 with parser pfkey_sa_parse. 
| pfkey_lib_debug:pfkey_sa_parse: successfully found len=3 exttype=19(X-security-association) spi=b374a893 replay=0 state=0 auth=0 encrypt=0 flags=0 ref=0. 
| pfkey_lib_debug:pfkey_msg_parse: Extension 19(X-security-association) parsed. 
| pfkey_lib_debug:pfkey_msg_parse: parsing ext type=20(X-destination-address2) remain=3. 
| pfkey_lib_debug:pfkey_msg_parse: remain=3 ext_type=20(X-destination-address2) ext_len=3 parsing ext 0p0x814eae0 with parser pfkey_address_parse. 
| pfkey_lib_debug:pfkey_address_parse: found exttype=20(X-destination-address2) family=2(AF_INET) address=192.1.2.23 proto=0 port=0. 
| pfkey_lib_debug:pfkey_address_parse: successful. 
| pfkey_lib_debug:pfkey_msg_parse: Extension 20(X-destination-address2) parsed. 
| pfkey_lib_debug:pfkey_msg_parse: extensions permitted=001c0043, seen=001c0043, required=00000043. 
| finish_pfkey_msg: K_SADB_X_GRPSA message 7 for group unk0.1001@192.1.2.23
|   02 0d 00 09  0f 00 00 00  07 00 00 00  94 03 00 00
|   03 00 01 00  00 00 10 01  00 00 00 00  00 00 00 00
|   00 00 00 00  00 00 00 00  03 00 06 00  00 00 00 00
|   02 00 00 00  c0 01 02 17  00 00 00 00  00 00 00 00
|   01 00 12 00  03 00 00 00  03 00 13 00  b3 74 a8 93
|   00 00 00 00  00 00 00 00  00 00 00 00  00 00 00 00
|   03 00 14 00  00 00 00 00  02 00 00 00  c0 01 02 17
|   00 00 00 00  00 00 00 00
| pfkey_get: K_SADB_X_GRPSA message 7
| set up outoing SA, ref=0/4294901761
| pfkey_lib_debug:pfkey_msg_hdr_build: 
| pfkey_lib_debug:pfkey_msg_hdr_build: on_entry &pfkey_ext=0p0xbf6fc720 pfkey_ext=0p0xbf6fd814 *pfkey_ext=0p(nil). 
| pfkey_lib_debug:pfkey_msg_hdr_build: on_exit &pfkey_ext=0p0xbf6fc720 pfkey_ext=0p0xbf6fd814 *pfkey_ext=0p0x814e538. 
| pfkey_lib_debug:pfkey_sa_build: spi=00001002 replay=0 sa_state=1 auth=0 encrypt=0 flags=0 
| pfkey_lib_debug:pfkey_address_build: exttype=5 proto=0 prefixlen=0 
| pfkey_lib_debug:pfkey_address_build: found address family AF_INET. 
| pfkey_lib_debug:pfkey_address_build: found address=192.1.2.23:0. 
| pfkey_lib_debug:pfkey_address_build: successful created len: 3. 
| pfkey_lib_debug:pfkey_address_build: exttype=6 proto=0 prefixlen=0 
| pfkey_lib_debug:pfkey_address_build: found address family AF_INET. 
| pfkey_lib_debug:pfkey_address_build: found address=192.1.2.45:0. 
| pfkey_lib_debug:pfkey_address_build: successful created len: 3. 
| pfkey_lib_debug:pfkey_msg_build: pfkey_msg=0p0x814ea60 allocated 88 bytes, &(extensions[0])=0p0xbf6fd814 
| pfkey_lib_debug:pfkey_msg_build: copying 24 bytes from extensions[1] (type=1) 
| pfkey_lib_debug:pfkey_msg_build: copying 24 bytes from extensions[5] (type=5) 
| pfkey_lib_debug:pfkey_msg_build: copying 24 bytes from extensions[6] (type=6) 
| pfkey_lib_debug:pfkey_msg_build: extensions permitted=78001ffb, seen=00000063, required=00000063. 
| pfkey_lib_debug:pfkey_msg_parse: parsing message ver=2, type=3(add), errno=0, satype=9(IPIP), len=11, res=0, seq=8, pid=916. 
| pfkey_lib_debug:pfkey_msg_parse: satype 9(IPIP) conversion to proto gives 4 for msg_type 3(add). 
| pfkey_lib_debug:pfkey_msg_parse: remain=9 
| pfkey_lib_debug:pfkey_msg_parse: extensions permitted=78001ffb, required=00000063. 
| pfkey_lib_debug:pfkey_msg_parse: parsing ext type=1(security-association) remain=9. 
| pfkey_lib_debug:pfkey_msg_parse: remain=9 ext_type=1(security-association) ext_len=3 parsing ext 0p0x814ea70 with parser pfkey_sa_parse. 
| pfkey_lib_debug:pfkey_sa_parse: successfully found len=3 exttype=1(security-association) spi=00001002 replay=0 state=1 auth=0 encrypt=0 flags=0 ref=0. 
| pfkey_lib_debug:pfkey_msg_parse: Extension 1(security-association) parsed. 
| pfkey_lib_debug:pfkey_msg_parse: parsing ext type=5(source-address) remain=6. 
| pfkey_lib_debug:pfkey_msg_parse: remain=6 ext_type=5(source-address) ext_len=3 parsing ext 0p0x814ea88 with parser pfkey_address_parse. 
| pfkey_lib_debug:pfkey_address_parse: found exttype=5(source-address) family=2(AF_INET) address=192.1.2.23 proto=0 port=0. 
| pfkey_lib_debug:pfkey_address_parse: successful. 
| pfkey_lib_debug:pfkey_msg_parse: Extension 5(source-address) parsed. 
| pfkey_lib_debug:pfkey_msg_parse: parsing ext type=6(destination-address) remain=3. 
| pfkey_lib_debug:pfkey_msg_parse: remain=3 ext_type=6(destination-address) ext_len=3 parsing ext 0p0x814eaa0 with parser pfkey_address_parse. 
| pfkey_lib_debug:pfkey_address_parse: found exttype=6(destination-address) family=2(AF_INET) address=192.1.2.45 proto=0 port=0. 
| pfkey_lib_debug:pfkey_address_parse: successful. 
| pfkey_lib_debug:pfkey_msg_parse: Extension 6(destination-address) parsed. 
| pfkey_lib_debug:pfkey_msg_parse: extensions permitted=78001ffb, seen=00000063, required=00000063. 
| finish_pfkey_msg: SADB_ADD message 8 for Add SA tun.1002@192.1.2.23
|   02 03 00 09  0b 00 00 00  08 00 00 00  94 03 00 00
|   03 00 01 00  00 00 10 02  00 01 00 00  00 00 00 00
|   00 00 00 00  00 00 00 00  03 00 05 00  00 00 00 00
|   02 00 00 00  c0 01 02 17  00 00 00 00  00 00 00 00
|   03 00 06 00  00 00 00 00  02 00 00 00  c0 01 02 2d
|   00 00 00 00  00 00 00 00
| pfkey_get: SADB_ADD message 8
| pfkey_lib_debug:pfkey_msg_parse: parsing message ver=2, type=3(add), errno=0, satype=9(IPIP), len=11, res=0, seq=8, pid=916. 
| pfkey_lib_debug:pfkey_msg_parse: satype 9(IPIP) conversion to proto gives 4 for msg_type 3(add). 
| pfkey_lib_debug:pfkey_msg_parse: remain=9 
| pfkey_lib_debug:pfkey_msg_parse: extensions permitted=78001ffb, required=00000063. 
| pfkey_lib_debug:pfkey_msg_parse: parsing ext type=1(security-association) remain=9. 
| pfkey_lib_debug:pfkey_msg_parse: remain=9 ext_type=1(security-association) ext_len=3 parsing ext 0p0xbf6fc824 with parser pfkey_sa_parse. 
| pfkey_lib_debug:pfkey_sa_parse: successfully found len=3 exttype=1(security-association) spi=00001002 replay=0 state=1 auth=0 encrypt=0 flags=1 ref=5. 
| pfkey_lib_debug:pfkey_msg_parse: Extension 1(security-association) parsed. 
| pfkey_lib_debug:pfkey_msg_parse: parsing ext type=5(source-address) remain=6. 
| pfkey_lib_debug:pfkey_msg_parse: remain=6 ext_type=5(source-address) ext_len=3 parsing ext 0p0xbf6fc83c with parser pfkey_address_parse. 
| pfkey_lib_debug:pfkey_address_parse: found exttype=5(source-address) family=2(AF_INET) address=192.1.2.23 proto=0 port=0. 
| pfkey_lib_debug:pfkey_address_parse: successful. 
| pfkey_lib_debug:pfkey_msg_parse: Extension 5(source-address) parsed. 
| pfkey_lib_debug:pfkey_msg_parse: parsing ext type=6(destination-address) remain=3. 
| pfkey_lib_debug:pfkey_msg_parse: remain=3 ext_type=6(destination-address) ext_len=3 parsing ext 0p0xbf6fc854 with parser pfkey_address_parse. 
| pfkey_lib_debug:pfkey_address_parse: found exttype=6(destination-address) family=2(AF_INET) address=192.1.2.45 proto=0 port=0. 
| pfkey_lib_debug:pfkey_address_parse: successful. 
| pfkey_lib_debug:pfkey_msg_parse: Extension 6(destination-address) parsed. 
| pfkey_lib_debug:pfkey_msg_parse: extensions permitted=78001ffb, seen=00000063, required=00000063. 
| added tunnel with ref=0
| looking for alg with transid: 12 keylen: 128 auth: 2 
| checking transid: 11 keylen: 0 auth: 1 
| checking transid: 11 keylen: 0 auth: 2 
| checking transid: 2 keylen: 8 auth: 0 
| checking transid: 2 keylen: 8 auth: 1 
| checking transid: 2 keylen: 8 auth: 2 
| checking transid: 3 keylen: 24 auth: 0 
| checking transid: 3 keylen: 24 auth: 1 
| checking transid: 3 keylen: 24 auth: 2 
| checking transid: 12 keylen: 16 auth: 0 
| checking transid: 12 keylen: 16 auth: 1 
| checking transid: 12 keylen: 16 auth: 2 
| pfkey_lib_debug:pfkey_msg_hdr_build: 
| pfkey_lib_debug:pfkey_msg_hdr_build: on_entry &pfkey_ext=0p0xbf6fc720 pfkey_ext=0p0xbf6fd814 *pfkey_ext=0p(nil). 
| pfkey_lib_debug:pfkey_msg_hdr_build: on_exit &pfkey_ext=0p0xbf6fc720 pfkey_ext=0p0xbf6fd814 *pfkey_ext=0p0x814e538. 
| pfkey_lib_debug:pfkey_sa_build: spi=79acbc7a replay=64 sa_state=1 auth=3 encrypt=12 flags=0 
| pfkey_lib_debug:pfkey_address_build: exttype=5 proto=0 prefixlen=0 
| pfkey_lib_debug:pfkey_address_build: found address family AF_INET. 
| pfkey_lib_debug:pfkey_address_build: found address=192.1.2.23:0. 
| pfkey_lib_debug:pfkey_address_build: successful created len: 3. 
| pfkey_lib_debug:pfkey_address_build: exttype=6 proto=0 prefixlen=0 
| pfkey_lib_debug:pfkey_address_build: found address family AF_INET. 
| pfkey_lib_debug:pfkey_address_build: found address=192.1.2.45:0. 
| pfkey_lib_debug:pfkey_address_build: successful created len: 3. 
| pfkey_lib_debug:pfkey_key_build: 
| pfkey_lib_debug:pfkey_key_build: 
| pfkey_lib_debug:pfkey_msg_build: pfkey_msg=0p0x814eaa8 allocated 144 bytes, &(extensions[0])=0p0xbf6fd814 
| pfkey_lib_debug:pfkey_msg_build: copying 24 bytes from extensions[1] (type=1) 
| pfkey_lib_debug:pfkey_msg_build: copying 24 bytes from extensions[5] (type=5) 
| pfkey_lib_debug:pfkey_msg_build: copying 24 bytes from extensions[6] (type=6) 
| pfkey_lib_debug:pfkey_msg_build: copying 32 bytes from extensions[8] (type=8) 
| pfkey_lib_debug:pfkey_msg_build: copying 24 bytes from extensions[9] (type=9) 
| pfkey_lib_debug:pfkey_msg_build: extensions permitted=78001ffb, seen=00000363, required=00000063. 
| pfkey_lib_debug:pfkey_msg_parse: parsing message ver=2, type=3(add), errno=0, satype=3(ESP), len=18, res=0, seq=9, pid=916. 
| pfkey_lib_debug:pfkey_msg_parse: satype 3(ESP) conversion to proto gives 50 for msg_type 3(add). 
| pfkey_lib_debug:pfkey_msg_parse: remain=16 
| pfkey_lib_debug:pfkey_msg_parse: extensions permitted=78001ffb, required=00000063. 
| pfkey_lib_debug:pfkey_msg_parse: parsing ext type=1(security-association) remain=16. 
| pfkey_lib_debug:pfkey_msg_parse: remain=16 ext_type=1(security-association) ext_len=3 parsing ext 0p0x814eab8 with parser pfkey_sa_parse. 
| pfkey_lib_debug:pfkey_sa_parse: successfully found len=3 exttype=1(security-association) spi=79acbc7a replay=64 state=1 auth=3 encrypt=12 flags=0 ref=0. 
| pfkey_lib_debug:pfkey_msg_parse: Extension 1(security-association) parsed. 
| pfkey_lib_debug:pfkey_msg_parse: parsing ext type=5(source-address) remain=13. 
| pfkey_lib_debug:pfkey_msg_parse: remain=13 ext_type=5(source-address) ext_len=3 parsing ext 0p0x814ead0 with parser pfkey_address_parse. 
| pfkey_lib_debug:pfkey_address_parse: found exttype=5(source-address) family=2(AF_INET) address=192.1.2.23 proto=0 port=0. 
| pfkey_lib_debug:pfkey_address_parse: successful. 
| pfkey_lib_debug:pfkey_msg_parse: Extension 5(source-address) parsed. 
| pfkey_lib_debug:pfkey_msg_parse: parsing ext type=6(destination-address) remain=10. 
| pfkey_lib_debug:pfkey_msg_parse: remain=10 ext_type=6(destination-address) ext_len=3 parsing ext 0p0x814eae8 with parser pfkey_address_parse. 
| pfkey_lib_debug:pfkey_address_parse: found exttype=6(destination-address) family=2(AF_INET) address=192.1.2.45 proto=0 port=0. 
| pfkey_lib_debug:pfkey_address_parse: successful. 
| pfkey_lib_debug:pfkey_msg_parse: Extension 6(destination-address) parsed. 
| pfkey_lib_debug:pfkey_msg_parse: parsing ext type=8(authentication-key) remain=7. 
| pfkey_lib_debug:pfkey_msg_parse: remain=7 ext_type=8(authentication-key) ext_len=4 parsing ext 0p0x814eb00 with parser pfkey_key_parse. 
| pfkey_lib_debug:pfkey_key_parse: success, found len=4 exttype=8(authentication-key) bits=160 reserved=0. 
| pfkey_lib_debug:pfkey_msg_parse: Extension 8(authentication-key) parsed. 
| pfkey_lib_debug:pfkey_msg_parse: parsing ext type=9(cipher-key) remain=3. 
| pfkey_lib_debug:pfkey_msg_parse: remain=3 ext_type=9(cipher-key) ext_len=3 parsing ext 0p0x814eb20 with parser pfkey_key_parse. 
| pfkey_lib_debug:pfkey_key_parse: success, found len=3 exttype=9(cipher-key) bits=128 reserved=0. 
| pfkey_lib_debug:pfkey_msg_parse: Extension 9(cipher-key) parsed. 
| pfkey_lib_debug:pfkey_msg_parse: extensions permitted=78001ffb, seen=00000363, required=00000063. 
| finish_pfkey_msg: SADB_ADD message 9 for Add SA esp.79acbc7a@192.1.2.45
|   02 03 00 03  12 00 00 00  09 00 00 00  94 03 00 00
|   03 00 01 00  79 ac bc 7a  40 01 03 0c  00 00 00 00
|   00 00 00 00  00 00 00 00  03 00 05 00  00 00 00 00
|   02 00 00 00  c0 01 02 17  00 00 00 00  00 00 00 00
|   03 00 06 00  00 00 00 00  02 00 00 00  c0 01 02 2d
|   00 00 00 00  00 00 00 00  04 00 08 00  a0 00 00 00
|   15 f4 2f 7e  46 be 45 19  09 8c 8f c3  31 82 96 f9
|   c6 2c cd 19  00 00 00 00  03 00 09 00  80 00 00 00
|   07 6b 0e 42  e0 43 31 94  b9 97 43 b9  c6 54 95 12
| pfkey_get: SADB_ADD message 9
| pfkey_lib_debug:pfkey_msg_parse: parsing message ver=2, type=3(add), errno=0, satype=3(ESP), len=11, res=0, seq=9, pid=916. 
| pfkey_lib_debug:pfkey_msg_parse: satype 3(ESP) conversion to proto gives 50 for msg_type 3(add). 
| pfkey_lib_debug:pfkey_msg_parse: remain=9 
| pfkey_lib_debug:pfkey_msg_parse: extensions permitted=78001ffb, required=00000063. 
| pfkey_lib_debug:pfkey_msg_parse: parsing ext type=1(security-association) remain=9. 
| pfkey_lib_debug:pfkey_msg_parse: remain=9 ext_type=1(security-association) ext_len=3 parsing ext 0p0xbf6fc824 with parser pfkey_sa_parse. 
| pfkey_lib_debug:pfkey_sa_parse: successfully found len=3 exttype=1(security-association) spi=79acbc7a replay=64 state=1 auth=3 encrypt=12 flags=1 ref=6. 
| pfkey_lib_debug:pfkey_msg_parse: Extension 1(security-association) parsed. 
| pfkey_lib_debug:pfkey_msg_parse: parsing ext type=5(source-address) remain=6. 
| pfkey_lib_debug:pfkey_msg_parse: remain=6 ext_type=5(source-address) ext_len=3 parsing ext 0p0xbf6fc83c with parser pfkey_address_parse. 
| pfkey_lib_debug:pfkey_address_parse: found exttype=5(source-address) family=2(AF_INET) address=192.1.2.23 proto=0 port=0. 
| pfkey_lib_debug:pfkey_address_parse: successful. 
| pfkey_lib_debug:pfkey_msg_parse: Extension 5(source-address) parsed. 
| pfkey_lib_debug:pfkey_msg_parse: parsing ext type=6(destination-address) remain=3. 
| pfkey_lib_debug:pfkey_msg_parse: remain=3 ext_type=6(destination-address) ext_len=3 parsing ext 0p0xbf6fc854 with parser pfkey_address_parse. 
| pfkey_lib_debug:pfkey_address_parse: found exttype=6(destination-address) family=2(AF_INET) address=192.1.2.45 proto=0 port=0. 
| pfkey_lib_debug:pfkey_address_parse: successful. 
| pfkey_lib_debug:pfkey_msg_parse: Extension 6(destination-address) parsed. 
| pfkey_lib_debug:pfkey_msg_parse: extensions permitted=78001ffb, seen=00000063, required=00000063. 
| add inbound eroute 192.0.2.0/24:0 --0-> 192.0.1.0/24:0 => tun.1002@192.1.2.45 (raw_eroute)
| pfkey_lib_debug:pfkey_msg_hdr_build: 
| pfkey_lib_debug:pfkey_msg_hdr_build: on_entry &pfkey_ext=0p0xbf6fd5f0 pfkey_ext=0p0xbf6fd6cc *pfkey_ext=0p(nil). 
| pfkey_lib_debug:pfkey_msg_hdr_build: on_exit &pfkey_ext=0p0xbf6fd5f0 pfkey_ext=0p0xbf6fd6cc *pfkey_ext=0p0x814e538. 
| pfkey_lib_debug:pfkey_sa_build: spi=00001002 replay=0 sa_state=0 auth=0 encrypt=0 flags=8 
| pfkey_lib_debug:pfkey_address_build: exttype=5 proto=0 prefixlen=0 
| pfkey_lib_debug:pfkey_address_build: found address family AF_INET. 
| pfkey_lib_debug:pfkey_address_build: found address=192.1.2.23:0. 
| pfkey_lib_debug:pfkey_address_build: successful created len: 3. 
| pfkey_lib_debug:pfkey_address_build: exttype=6 proto=0 prefixlen=0 
| pfkey_lib_debug:pfkey_address_build: found address family AF_INET. 
| pfkey_lib_debug:pfkey_address_build: found address=192.1.2.45:0. 
| pfkey_lib_debug:pfkey_address_build: successful created len: 3. 
| pfkey_lib_debug:pfkey_address_build: exttype=21 proto=0 prefixlen=0 
| pfkey_lib_debug:pfkey_address_build: found address family AF_INET. 
| pfkey_lib_debug:pfkey_address_build: found address=192.0.2.0:0. 
| pfkey_lib_debug:pfkey_address_build: successful created len: 3. 
| pfkey_lib_debug:pfkey_address_build: exttype=22 proto=0 prefixlen=0 
| pfkey_lib_debug:pfkey_address_build: found address family AF_INET. 
| pfkey_lib_debug:pfkey_address_build: found address=192.0.1.0:0. 
| pfkey_lib_debug:pfkey_address_build: successful created len: 3. 
| pfkey_lib_debug:pfkey_address_build: exttype=23 proto=0 prefixlen=0 
| pfkey_lib_debug:pfkey_address_build: found address family AF_INET. 
| pfkey_lib_debug:pfkey_address_build: found address=255.255.255.0:0. 
| pfkey_lib_debug:pfkey_address_build: successful created len: 3. 
| pfkey_lib_debug:pfkey_address_build: exttype=24 proto=0 prefixlen=0 
| pfkey_lib_debug:pfkey_address_build: found address family AF_INET. 
| pfkey_lib_debug:pfkey_address_build: found address=255.255.255.0:0. 
| pfkey_lib_debug:pfkey_address_build: successful created len: 3. 
| pfkey_lib_debug:pfkey_msg_build: pfkey_msg=0p0x814eae0 allocated 184 bytes, &(extensions[0])=0p0xbf6fd6cc 
| pfkey_lib_debug:pfkey_msg_build: copying 24 bytes from extensions[1] (type=1) 
| pfkey_lib_debug:pfkey_msg_build: copying 24 bytes from extensions[5] (type=5) 
| pfkey_lib_debug:pfkey_msg_build: copying 24 bytes from extensions[6] (type=6) 
| pfkey_lib_debug:pfkey_msg_build: copying 24 bytes from extensions[21] (type=21) 
| pfkey_lib_debug:pfkey_msg_build: copying 24 bytes from extensions[22] (type=22) 
| pfkey_lib_debug:pfkey_msg_build: copying 24 bytes from extensions[23] (type=23) 
| pfkey_lib_debug:pfkey_msg_build: copying 24 bytes from extensions[24] (type=24) 
| pfkey_lib_debug:pfkey_msg_build: extensions permitted=05e00c63, seen=01e00063, required=01e00043. 
| pfkey_lib_debug:pfkey_msg_parse: parsing message ver=2, type=14(x-addflow(eroute)), errno=0, satype=9(IPIP), len=23, res=0, seq=10, pid=916. 
| pfkey_lib_debug:pfkey_msg_parse: satype 9(IPIP) conversion to proto gives 4 for msg_type 14(x-addflow(eroute)). 
| pfkey_lib_debug:pfkey_msg_parse: remain=21 
| pfkey_lib_debug:pfkey_msg_parse: extensions permitted=05e00c63, required=01e00043. 
| pfkey_lib_debug:pfkey_msg_parse: parsing ext type=1(security-association) remain=21. 
| pfkey_lib_debug:pfkey_msg_parse: remain=21 ext_type=1(security-association) ext_len=3 parsing ext 0p0x814eaf0 with parser pfkey_sa_parse. 
| pfkey_lib_debug:pfkey_sa_parse: successfully found len=3 exttype=1(security-association) spi=00001002 replay=0 state=0 auth=0 encrypt=0 flags=8 ref=0. 
| pfkey_lib_debug:pfkey_msg_parse: Extension 1(security-association) parsed. 
| pfkey_lib_debug:pfkey_msg_parse: parsing ext type=5(source-address) remain=18. 
| pfkey_lib_debug:pfkey_msg_parse: remain=18 ext_type=5(source-address) ext_len=3 parsing ext 0p0x814eb08 with parser pfkey_address_parse. 
| pfkey_lib_debug:pfkey_address_parse: found exttype=5(source-address) family=2(AF_INET) address=192.1.2.23 proto=0 port=0. 
| pfkey_lib_debug:pfkey_address_parse: successful. 
| pfkey_lib_debug:pfkey_msg_parse: Extension 5(source-address) parsed. 
| pfkey_lib_debug:pfkey_msg_parse: parsing ext type=6(destination-address) remain=15. 
| pfkey_lib_debug:pfkey_msg_parse: remain=15 ext_type=6(destination-address) ext_len=3 parsing ext 0p0x814eb20 with parser pfkey_address_parse. 
| pfkey_lib_debug:pfkey_address_parse: found exttype=6(destination-address) family=2(AF_INET) address=192.1.2.45 proto=0 port=0. 
| pfkey_lib_debug:pfkey_address_parse: successful. 
| pfkey_lib_debug:pfkey_msg_parse: Extension 6(destination-address) parsed. 
| pfkey_lib_debug:pfkey_msg_parse: parsing ext type=21(X-source-flow-address) remain=12. 
| pfkey_lib_debug:pfkey_msg_parse: remain=12 ext_type=21(X-source-flow-address) ext_len=3 parsing ext 0p0x814eb38 with parser pfkey_address_parse. 
| pfkey_lib_debug:pfkey_address_parse: found exttype=21(X-source-flow-address) family=2(AF_INET) address=192.0.2.0 proto=0 port=0. 
| pfkey_lib_debug:pfkey_address_parse: successful. 
| pfkey_lib_debug:pfkey_msg_parse: Extension 21(X-source-flow-address) parsed. 
| pfkey_lib_debug:pfkey_msg_parse: parsing ext type=22(X-dest-flow-address) remain=9. 
| pfkey_lib_debug:pfkey_msg_parse: remain=9 ext_type=22(X-dest-flow-address) ext_len=3 parsing ext 0p0x814eb50 with parser pfkey_address_parse. 
| pfkey_lib_debug:pfkey_address_parse: found exttype=22(X-dest-flow-address) family=2(AF_INET) address=192.0.1.0 proto=0 port=0. 
| pfkey_lib_debug:pfkey_address_parse: successful. 
| pfkey_lib_debug:pfkey_msg_parse: Extension 22(X-dest-flow-address) parsed. 
| pfkey_lib_debug:pfkey_msg_parse: parsing ext type=23(X-source-mask) remain=6. 
| pfkey_lib_debug:pfkey_msg_parse: remain=6 ext_type=23(X-source-mask) ext_len=3 parsing ext 0p0x814eb68 with parser pfkey_address_parse. 
| pfkey_lib_debug:pfkey_address_parse: found exttype=23(X-source-mask) family=2(AF_INET) address=255.255.255.0 proto=0 port=0. 
| pfkey_lib_debug:pfkey_address_parse: successful. 
| pfkey_lib_debug:pfkey_msg_parse: Extension 23(X-source-mask) parsed. 
| pfkey_lib_debug:pfkey_msg_parse: parsing ext type=24(X-dest-mask) remain=3. 
| pfkey_lib_debug:pfkey_msg_parse: remain=3 ext_type=24(X-dest-mask) ext_len=3 parsing ext 0p0x814eb80 with parser pfkey_address_parse. 
| pfkey_lib_debug:pfkey_address_parse: found exttype=24(X-dest-mask) family=2(AF_INET) address=255.255.255.0 proto=0 port=0. 
| pfkey_lib_debug:pfkey_address_parse: successful. 
| pfkey_lib_debug:pfkey_msg_parse: Extension 24(X-dest-mask) parsed. 
| pfkey_lib_debug:pfkey_msg_parse: extensions permitted=05e00c63, seen=01e00063, required=01e00043. 
| finish_pfkey_msg: K_SADB_X_ADDFLOW message 10 for flow tun.1002@192.1.2.45
|   02 0e 00 09  17 00 00 00  0a 00 00 00  94 03 00 00
|   03 00 01 00  00 00 10 02  00 00 00 00  08 00 00 00
|   00 00 00 00  00 00 00 00  03 00 05 00  00 00 00 00
|   02 00 00 00  c0 01 02 17  00 00 00 00  00 00 00 00
|   03 00 06 00  00 00 00 00  02 00 00 00  c0 01 02 2d
|   00 00 00 00  00 00 00 00  03 00 15 00  00 00 00 00
|   02 00 00 00  c0 00 02 00  88 ad 07 08  b8 b0 07 08
|   03 00 16 00  00 00 00 00  02 00 00 00  c0 00 01 00
|   c8 91 07 08  48 af 07 08  03 00 17 00  00 00 00 00
|   02 00 00 00  ff ff ff 00  02 00 00 00  0a 00 00 00
|   03 00 18 00  00 00 00 00  02 00 00 00  ff ff ff 00
|   5a d6 6f bf  98 d6 6f bf
| pfkey_get: K_SADB_X_ADDFLOW message 10
| raw_eroute result=1 
| grouping unk0.79acbc7a@192.1.2.45 (ref=0) and unk0.1002@192.1.2.45 (ref=0)
| pfkey_lib_debug:pfkey_msg_hdr_build: 
| pfkey_lib_debug:pfkey_msg_hdr_build: on_entry &pfkey_ext=0p0xbf6fd7d0 pfkey_ext=0p0xbf6fd824 *pfkey_ext=0p(nil). 
| pfkey_lib_debug:pfkey_msg_hdr_build: on_exit &pfkey_ext=0p0xbf6fd7d0 pfkey_ext=0p0xbf6fd824 *pfkey_ext=0p0x814e538. 
| pfkey_lib_debug:pfkey_sa_build: spi=00001002 replay=0 sa_state=0 auth=0 encrypt=0 flags=0 
| pfkey_lib_debug:pfkey_address_build: exttype=6 proto=0 prefixlen=0 
| pfkey_lib_debug:pfkey_address_build: found address family AF_INET. 
| pfkey_lib_debug:pfkey_address_build: found address=192.1.2.45:0. 
| pfkey_lib_debug:pfkey_address_build: successful created len: 3. 
| pfkey_lib_debug:pfkey_x_satype_build: 
| pfkey_lib_debug:pfkey_sa_build: spi=79acbc7a replay=0 sa_state=0 auth=0 encrypt=0 flags=0 
| pfkey_lib_debug:pfkey_address_build: exttype=20 proto=0 prefixlen=0 
| pfkey_lib_debug:pfkey_address_build: found address family AF_INET. 
| pfkey_lib_debug:pfkey_address_build: found address=192.1.2.45:0. 
| pfkey_lib_debug:pfkey_address_build: successful created len: 3. 
| pfkey_lib_debug:pfkey_msg_build: pfkey_msg=0p0x814ea80 allocated 120 bytes, &(extensions[0])=0p0xbf6fd824 
| pfkey_lib_debug:pfkey_msg_build: copying 24 bytes from extensions[1] (type=1) 
| pfkey_lib_debug:pfkey_msg_build: copying 24 bytes from extensions[6] (type=6) 
| pfkey_lib_debug:pfkey_msg_build: copying 8 bytes from extensions[18] (type=18) 
| pfkey_lib_debug:pfkey_msg_build: copying 24 bytes from extensions[19] (type=19) 
| pfkey_lib_debug:pfkey_msg_build: copying 24 bytes from extensions[20] (type=20) 
| pfkey_lib_debug:pfkey_msg_build: extensions permitted=001c0043, seen=001c0043, required=00000043. 
| pfkey_lib_debug:pfkey_msg_parse: parsing message ver=2, type=13(x-groupsa), errno=0, satype=9(IPIP), len=15, res=0, seq=11, pid=916. 
| pfkey_lib_debug:pfkey_msg_parse: satype 9(IPIP) conversion to proto gives 4 for msg_type 13(x-groupsa). 
| pfkey_lib_debug:pfkey_msg_parse: remain=13 
| pfkey_lib_debug:pfkey_msg_parse: extensions permitted=001c0043, required=00000043. 
| pfkey_lib_debug:pfkey_msg_parse: parsing ext type=1(security-association) remain=13. 
| pfkey_lib_debug:pfkey_msg_parse: remain=13 ext_type=1(security-association) ext_len=3 parsing ext 0p0x814ea90 with parser pfkey_sa_parse. 
| pfkey_lib_debug:pfkey_sa_parse: successfully found len=3 exttype=1(security-association) spi=00001002 replay=0 state=0 auth=0 encrypt=0 flags=0 ref=0. 
| pfkey_lib_debug:pfkey_msg_parse: Extension 1(security-association) parsed. 
| pfkey_lib_debug:pfkey_msg_parse: parsing ext type=6(destination-address) remain=10. 
| pfkey_lib_debug:pfkey_msg_parse: remain=10 ext_type=6(destination-address) ext_len=3 parsing ext 0p0x814eaa8 with parser pfkey_address_parse. 
| pfkey_lib_debug:pfkey_address_parse: found exttype=6(destination-address) family=2(AF_INET) address=192.1.2.45 proto=0 port=0. 
| pfkey_lib_debug:pfkey_address_parse: successful. 
| pfkey_lib_debug:pfkey_msg_parse: Extension 6(destination-address) parsed. 
| pfkey_lib_debug:pfkey_msg_parse: parsing ext type=18(X-satype2) remain=7. 
| pfkey_lib_debug:pfkey_msg_parse: remain=7 ext_type=18(X-satype2) ext_len=1 parsing ext 0p0x814eac0 with parser pfkey_x_satype_parse. 
| pfkey_lib_debug:pfkey_x_satype_parse: enter 
| pfkey_lib_debug:pfkey_x_satype_parse: len=1 ext=18(X-satype2) satype=3(ESP) res=0,0,0. 
| pfkey_lib_debug:pfkey_msg_parse: Extension 18(X-satype2) parsed. 
| pfkey_lib_debug:pfkey_msg_parse: parsing ext type=19(X-security-association) remain=6. 
| pfkey_lib_debug:pfkey_msg_parse: remain=6 ext_type=19(X-security-association) ext_len=3 parsing ext 0p0x814eac8 with parser pfkey_sa_parse. 
| pfkey_lib_debug:pfkey_sa_parse: successfully found len=3 exttype=19(X-security-association) spi=79acbc7a replay=0 state=0 auth=0 encrypt=0 flags=0 ref=0. 
| pfkey_lib_debug:pfkey_msg_parse: Extension 19(X-security-association) parsed. 
| pfkey_lib_debug:pfkey_msg_parse: parsing ext type=20(X-destination-address2) remain=3. 
| pfkey_lib_debug:pfkey_msg_parse: remain=3 ext_type=20(X-destination-address2) ext_len=3 parsing ext 0p0x814eae0 with parser pfkey_address_parse. 
| pfkey_lib_debug:pfkey_address_parse: found exttype=20(X-destination-address2) family=2(AF_INET) address=192.1.2.45 proto=0 port=0. 
| pfkey_lib_debug:pfkey_address_parse: successful. 
| pfkey_lib_debug:pfkey_msg_parse: Extension 20(X-destination-address2) parsed. 
| pfkey_lib_debug:pfkey_msg_parse: extensions permitted=001c0043, seen=001c0043, required=00000043. 
| finish_pfkey_msg: K_SADB_X_GRPSA message 11 for group unk0.1002@192.1.2.45
|   02 0d 00 09  0f 00 00 00  0b 00 00 00  94 03 00 00
|   03 00 01 00  00 00 10 02  00 00 00 00  00 00 00 00
|   00 00 00 00  00 00 00 00  03 00 06 00  00 00 00 00
|   02 00 00 00  c0 01 02 2d  00 00 00 00  00 00 00 00
|   01 00 12 00  03 00 00 00  03 00 13 00  79 ac bc 7a
|   00 00 00 00  00 00 00 00  00 00 00 00  00 00 00 00
|   03 00 14 00  00 00 00 00  02 00 00 00  c0 01 02 2d
|   00 00 00 00  00 00 00 00
| pfkey_get: K_SADB_X_GRPSA message 11
| set up incoming SA, ref=0/4294901761
| sr for #2: unrouted
| route owner of "westnet--eastnet-ikev2" unrouted: NULL; eroute owner: NULL
| route_and_eroute with c: westnet--eastnet-ikev2 (next: none) ero:null esr:{(nil)} ro:null rosr:{(nil)} and state: 2
| eroute_connection add eroute 192.0.1.0/24:0 --0-> 192.0.2.0/24:0 => tun.1001@192.1.2.23 (raw_eroute)
| pfkey_lib_debug:pfkey_msg_hdr_build: 
| pfkey_lib_debug:pfkey_msg_hdr_build: on_entry &pfkey_ext=0p0xbf6fd670 pfkey_ext=0p0xbf6fd74c *pfkey_ext=0p(nil). 
| pfkey_lib_debug:pfkey_msg_hdr_build: on_exit &pfkey_ext=0p0xbf6fd670 pfkey_ext=0p0xbf6fd74c *pfkey_ext=0p0x814e538. 
| pfkey_lib_debug:pfkey_sa_build: spi=00001001 replay=0 sa_state=0 auth=0 encrypt=0 flags=0 
| pfkey_lib_debug:pfkey_address_build: exttype=5 proto=0 prefixlen=0 
| pfkey_lib_debug:pfkey_address_build: found address family AF_INET. 
| pfkey_lib_debug:pfkey_address_build: found address=192.1.2.45:0. 
| pfkey_lib_debug:pfkey_address_build: successful created len: 3. 
| pfkey_lib_debug:pfkey_address_build: exttype=6 proto=0 prefixlen=0 
| pfkey_lib_debug:pfkey_address_build: found address family AF_INET. 
| pfkey_lib_debug:pfkey_address_build: found address=192.1.2.23:0. 
| pfkey_lib_debug:pfkey_address_build: successful created len: 3. 
| pfkey_lib_debug:pfkey_address_build: exttype=21 proto=0 prefixlen=0 
| pfkey_lib_debug:pfkey_address_build: found address family AF_INET. 
| pfkey_lib_debug:pfkey_address_build: found address=192.0.1.0:0. 
| pfkey_lib_debug:pfkey_address_build: successful created len: 3. 
| pfkey_lib_debug:pfkey_address_build: exttype=22 proto=0 prefixlen=0 
| pfkey_lib_debug:pfkey_address_build: found address family AF_INET. 
| pfkey_lib_debug:pfkey_address_build: found address=192.0.2.0:0. 
| pfkey_lib_debug:pfkey_address_build: successful created len: 3. 
| pfkey_lib_debug:pfkey_address_build: exttype=23 proto=0 prefixlen=0 
| pfkey_lib_debug:pfkey_address_build: found address family AF_INET. 
| pfkey_lib_debug:pfkey_address_build: found address=255.255.255.0:0. 
| pfkey_lib_debug:pfkey_address_build: successful created len: 3. 
| pfkey_lib_debug:pfkey_address_build: exttype=24 proto=0 prefixlen=0 
| pfkey_lib_debug:pfkey_address_build: found address family AF_INET. 
| pfkey_lib_debug:pfkey_address_build: found address=255.255.255.0:0. 
| pfkey_lib_debug:pfkey_address_build: successful created len: 3. 
| pfkey_lib_debug:pfkey_msg_build: pfkey_msg=0p0x814eae0 allocated 184 bytes, &(extensions[0])=0p0xbf6fd74c 
| pfkey_lib_debug:pfkey_msg_build: copying 24 bytes from extensions[1] (type=1) 
| pfkey_lib_debug:pfkey_msg_build: copying 24 bytes from extensions[5] (type=5) 
| pfkey_lib_debug:pfkey_msg_build: copying 24 bytes from extensions[6] (type=6) 
| pfkey_lib_debug:pfkey_msg_build: copying 24 bytes from extensions[21] (type=21) 
| pfkey_lib_debug:pfkey_msg_build: copying 24 bytes from extensions[22] (type=22) 
| pfkey_lib_debug:pfkey_msg_build: copying 24 bytes from extensions[23] (type=23) 
| pfkey_lib_debug:pfkey_msg_build: copying 24 bytes from extensions[24] (type=24) 
| pfkey_lib_debug:pfkey_msg_build: extensions permitted=05e00c63, seen=01e00063, required=01e00043. 
| pfkey_lib_debug:pfkey_msg_parse: parsing message ver=2, type=14(x-addflow(eroute)), errno=0, satype=9(IPIP), len=23, res=0, seq=12, pid=916. 
| pfkey_lib_debug:pfkey_msg_parse: satype 9(IPIP) conversion to proto gives 4 for msg_type 14(x-addflow(eroute)). 
| pfkey_lib_debug:pfkey_msg_parse: remain=21 
| pfkey_lib_debug:pfkey_msg_parse: extensions permitted=05e00c63, required=01e00043. 
| pfkey_lib_debug:pfkey_msg_parse: parsing ext type=1(security-association) remain=21. 
| pfkey_lib_debug:pfkey_msg_parse: remain=21 ext_type=1(security-association) ext_len=3 parsing ext 0p0x814eaf0 with parser pfkey_sa_parse. 
| pfkey_lib_debug:pfkey_sa_parse: successfully found len=3 exttype=1(security-association) spi=00001001 replay=0 state=0 auth=0 encrypt=0 flags=0 ref=0. 
| pfkey_lib_debug:pfkey_msg_parse: Extension 1(security-association) parsed. 
| pfkey_lib_debug:pfkey_msg_parse: parsing ext type=5(source-address) remain=18. 
| pfkey_lib_debug:pfkey_msg_parse: remain=18 ext_type=5(source-address) ext_len=3 parsing ext 0p0x814eb08 with parser pfkey_address_parse. 
| pfkey_lib_debug:pfkey_address_parse: found exttype=5(source-address) family=2(AF_INET) address=192.1.2.45 proto=0 port=0. 
| pfkey_lib_debug:pfkey_address_parse: successful. 
| pfkey_lib_debug:pfkey_msg_parse: Extension 5(source-address) parsed. 
| pfkey_lib_debug:pfkey_msg_parse: parsing ext type=6(destination-address) remain=15. 
| pfkey_lib_debug:pfkey_msg_parse: remain=15 ext_type=6(destination-address) ext_len=3 parsing ext 0p0x814eb20 with parser pfkey_address_parse. 
| pfkey_lib_debug:pfkey_address_parse: found exttype=6(destination-address) family=2(AF_INET) address=192.1.2.23 proto=0 port=0. 
| pfkey_lib_debug:pfkey_address_parse: successful. 
| pfkey_lib_debug:pfkey_msg_parse: Extension 6(destination-address) parsed. 
| pfkey_lib_debug:pfkey_msg_parse: parsing ext type=21(X-source-flow-address) remain=12. 
| pfkey_lib_debug:pfkey_msg_parse: remain=12 ext_type=21(X-source-flow-address) ext_len=3 parsing ext 0p0x814eb38 with parser pfkey_address_parse. 
| pfkey_lib_debug:pfkey_address_parse: found exttype=21(X-source-flow-address) family=2(AF_INET) address=192.0.1.0 proto=0 port=0. 
| pfkey_lib_debug:pfkey_address_parse: successful. 
| pfkey_lib_debug:pfkey_msg_parse: Extension 21(X-source-flow-address) parsed. 
| pfkey_lib_debug:pfkey_msg_parse: parsing ext type=22(X-dest-flow-address) remain=9. 
| pfkey_lib_debug:pfkey_msg_parse: remain=9 ext_type=22(X-dest-flow-address) ext_len=3 parsing ext 0p0x814eb50 with parser pfkey_address_parse. 
| pfkey_lib_debug:pfkey_address_parse: found exttype=22(X-dest-flow-address) family=2(AF_INET) address=192.0.2.0 proto=0 port=0. 
| pfkey_lib_debug:pfkey_address_parse: successful. 
| pfkey_lib_debug:pfkey_msg_parse: Extension 22(X-dest-flow-address) parsed. 
| pfkey_lib_debug:pfkey_msg_parse: parsing ext type=23(X-source-mask) remain=6. 
| pfkey_lib_debug:pfkey_msg_parse: remain=6 ext_type=23(X-source-mask) ext_len=3 parsing ext 0p0x814eb68 with parser pfkey_address_parse. 
| pfkey_lib_debug:pfkey_address_parse: found exttype=23(X-source-mask) family=2(AF_INET) address=255.255.255.0 proto=0 port=0. 
| pfkey_lib_debug:pfkey_address_parse: successful. 
| pfkey_lib_debug:pfkey_msg_parse: Extension 23(X-source-mask) parsed. 
| pfkey_lib_debug:pfkey_msg_parse: parsing ext type=24(X-dest-mask) remain=3. 
| pfkey_lib_debug:pfkey_msg_parse: remain=3 ext_type=24(X-dest-mask) ext_len=3 parsing ext 0p0x814eb80 with parser pfkey_address_parse. 
| pfkey_lib_debug:pfkey_address_parse: found exttype=24(X-dest-mask) family=2(AF_INET) address=255.255.255.0 proto=0 port=0. 
| pfkey_lib_debug:pfkey_address_parse: successful. 
| pfkey_lib_debug:pfkey_msg_parse: Extension 24(X-dest-mask) parsed. 
| pfkey_lib_debug:pfkey_msg_parse: extensions permitted=05e00c63, seen=01e00063, required=01e00043. 
| finish_pfkey_msg: K_SADB_X_ADDFLOW message 12 for flow tun.1001@192.1.2.23
|   02 0e 00 09  17 00 00 00  0c 00 00 00  94 03 00 00
|   03 00 01 00  00 00 10 01  00 00 00 00  00 00 00 00
|   00 00 00 00  00 00 00 00  03 00 05 00  00 00 00 00
|   02 00 00 00  c0 01 02 2d  00 00 00 00  00 00 00 00
|   03 00 06 00  00 00 00 00  02 00 00 00  c0 01 02 17
|   00 00 00 00  00 00 00 00  03 00 15 00  00 00 00 00
|   02 00 00 00  c0 00 01 00  c8 91 07 08  48 af 07 08
|   03 00 16 00  00 00 00 00  02 00 00 00  c0 00 02 00
|   88 ad 07 08  b8 b0 07 08  03 00 17 00  00 00 00 00
|   02 00 00 00  ff ff ff 00  02 00 00 00  0a 00 00 00
|   03 00 18 00  00 00 00 00  02 00 00 00  ff ff ff 00
|   da d6 6f bf  18 d7 6f bf
| pfkey_get: K_SADB_X_ADDFLOW message 12
| raw_eroute result=1 
| command executing up-client
| executing up-client: 2>&1 PLUTO_VERB='up-client' PLUTO_VERSION='2.0' PLUTO_CONNECTION='westnet--eastnet-ikev2' PLUTO_INTERFACE='ipsec0' PLUTO_NEXT_HOP='192.1.2.23' PLUTO_ME='192.1.2.45' PLUTO_MY_ID='@west' PLUTO_MY_CLIENT='192.0.1.0/24' PLUTO_MY_CLIENT_NET='192.0.1.0' PLUTO_MY_CLIENT_MASK='255.255.255.0' PLUTO_MY_PORT='0' PLUTO_MY_PROTOCOL='0' PLUTO_PEER='192.1.2.23' PLUTO_PEER_ID='@east' PLUTO_PEER_CLIENT='192.0.2.0/24' PLUTO_PEER_CLIENT_NET='192.0.2.0' PLUTO_PEER_CLIENT_MASK='255.255.255.0' PLUTO_PEER_PORT='0' PLUTO_PEER_PROTOCOL='0' PLUTO_PEER_CA='' PLUTO_STACK='klips' PLUTO_CONN_POLICY='PSK+ENCRYPT+TUNNEL+PFS+UP+!IKEv1+IKEv2ALLOW+IKEv2Init' PLUTO_XAUTH_USERNAME=''  ipsec _updown
| route_and_eroute: firewall_notified: true
| command executing prepare-client
| executing prepare-client: 2>&1 PLUTO_VERB='prepare-client' PLUTO_VERSION='2.0' PLUTO_CONNECTION='westnet--eastnet-ikev2' PLUTO_INTERFACE='ipsec0' PLUTO_NEXT_HOP='192.1.2.23' PLUTO_ME='192.1.2.45' PLUTO_MY_ID='@west' PLUTO_MY_CLIENT='192.0.1.0/24' PLUTO_MY_CLIENT_NET='192.0.1.0' PLUTO_MY_CLIENT_MASK='255.255.255.0' PLUTO_MY_PORT='0' PLUTO_MY_PROTOCOL='0' PLUTO_PEER='192.1.2.23' PLUTO_PEER_ID='@east' PLUTO_PEER_CLIENT='192.0.2.0/24' PLUTO_PEER_CLIENT_NET='192.0.2.0' PLUTO_PEER_CLIENT_MASK='255.255.255.0' PLUTO_PEER_PORT='0' PLUTO_PEER_PROTOCOL='0' PLUTO_PEER_CA='' PLUTO_STACK='klips' PLUTO_CONN_POLICY='PSK+ENCRYPT+TUNNEL+PFS+UP+!IKEv1+IKEv2ALLOW+IKEv2Init' PLUTO_XAUTH_USERNAME=''  ipsec _updown
| command executing route-client
| executing route-client: 2>&1 PLUTO_VERB='route-client' PLUTO_VERSION='2.0' PLUTO_CONNECTION='westnet--eastnet-ikev2' PLUTO_INTERFACE='ipsec0' PLUTO_NEXT_HOP='192.1.2.23' PLUTO_ME='192.1.2.45' PLUTO_MY_ID='@west' PLUTO_MY_CLIENT='192.0.1.0/24' PLUTO_MY_CLIENT_NET='192.0.1.0' PLUTO_MY_CLIENT_MASK='255.255.255.0' PLUTO_MY_PORT='0' PLUTO_MY_PROTOCOL='0' PLUTO_PEER='192.1.2.23' PLUTO_PEER_ID='@east' PLUTO_PEER_CLIENT='192.0.2.0/24' PLUTO_PEER_CLIENT_NET='192.0.2.0' PLUTO_PEER_CLIENT_MASK='255.255.255.0' PLUTO_PEER_PORT='0' PLUTO_PEER_PROTOCOL='0' PLUTO_PEER_CA='' PLUTO_STACK='klips' PLUTO_CONN_POLICY='PSK+ENCRYPT+TUNNEL+PFS+UP+!IKEv1+IKEv2ALLOW+IKEv2Init' PLUTO_XAUTH_USERNAME=''  ipsec _updown
| route_and_eroute: instance "westnet--eastnet-ikev2", setting eroute_owner {spd=0x8140368,sr=0x8140368} to #2 (was #0) (newest_ipsec_sa=#2)
| complete v2 state transition with STF_OK
"westnet--eastnet-ikev2" #2: transition from state STATE_PARENT_I2 to state STATE_PARENT_I3
"westnet--eastnet-ikev2" #2: negotiated tunnel [192.0.1.0,192.0.1.255] -> [192.0.2.0,192.0.2.255]
"westnet--eastnet-ikev2" #2: STATE_PARENT_I3: PARENT SA established tunnel mode {ESP=>0xb374a893 <0x79acbc7a xfrm=AES_128-HMAC_SHA1 NATOA=none NATD=none DPD=none}
| releasing whack for #2 (sock=15)
| releasing whack for #1 (sock=14)
| * processed 0 messages from cryptographic helpers 
| next event EVENT_SHUNT_SCAN in 76 seconds
|  
| *received whack message
| * processed 0 messages from cryptographic helpers 
| next event EVENT_SHUNT_SCAN in 62 seconds
west:~# : ==== tuc ====
west:~# if [ -f /tmp/core ]; then echo CORE FOUND; mv /tmp/core /var/tmp; fi
west:~# : ==== end ====
west:~# ipsec setup stop
IPSEC EVENT: KLIPS device ipsec0 shut down.
ipsec_setup: Stopping Openswan IPsec...
west:~# kill `cat /var/run/klogd.pid`; cat /tmp/klog.log
klogd 1.3-3#33.1, log source = /proc/kmsg started.
<5>Linux version 2.6.18.6 (antony@cyclops) (gcc version 4.1.2 20061115 (prerelease) (Debian 4.1.1-21)) #1 Mon Jan 14 16:26:00 EST 2008
<7>On node 0 totalpages: 8192
<7>  DMA zone: 8192 pages, LIFO batch:1
<4>Built 1 zonelists.  Total pages: 8192
<5>Kernel command line: initrd=/btmp/antony/ikev2/2008_01_14/UMLPOOL/initrd.uml umlroot=/btmp/antony/ikev2/2008_01_14/UMLPOOL/west/root root=/dev/ram0 rw ssl=pty eth0=daemon,10:00:00:ab:cd:ff,unix,/tmp/umlEV4Tk1.d/west/ctl,/tmp/umlEV4Tk1.d/west/data eth1=daemon,10:00:00:64:64:45,unix,/tmp/umlEV4Tk1.d/public/ctl,/tmp/umlEV4Tk1.d/public/data eth2=daemon,10:00:00:32:64:45,unix,/tmp/umlEV4Tk1.d/admin/ctl,/tmp/umlEV4Tk1.d/admin/data init=/linuxrc single
<4>PID hash table entries: 256 (order: 8, 1024 bytes)
<4>Dentry cache hash table entries: 4096 (order: 2, 16384 bytes)
<4>Inode-cache hash table entries: 2048 (order: 1, 8192 bytes)
<6>Memory: 27292k available
<7>Calibrating delay loop... 3761.76 BogoMIPS (lpj=18808832)
<4>Mount-cache hash table entries: 512
<4>Checking for host processor cmov support...Yes
<4>Checking for host processor xmm support...No
<4>Checking that host ptys support output SIGIO...Yes
<4>Checking that host ptys support SIGIO on close...No, enabling workaround
<6>checking if image is initramfs...it isn't (bad gzip magic numbers); looks like an initrd
<4>Freeing initrd memory: 1212k freed
<4>Using 2.6 host AIO
<6>NET: Registered protocol family 16
<6>NET: Registered protocol family 2
<4>IP route cache hash table entries: 256 (order: -2, 1024 bytes)
<4>TCP established hash table entries: 1024 (order: 0, 4096 bytes)
<4>TCP bind hash table entries: 512 (order: -1, 2048 bytes)
<6>TCP: Hash tables configured (established 1024 bind 512)
<6>TCP reno registered
<6>klips_info:ipsec_init: KLIPS startup, Openswan KLIPS IPsec stack version: 2.5.testing-g70d71a2f-dirty
<6>NET: Registered protocol family 15
<6>klips_info:ipsec_alg_init: KLIPS alg v=0.8.1-0 (EALG_MAX=255, AALG_MAX=251)
<6>klips_info:ipsec_alg_init: calling ipsec_alg_static_init()
<4>ipsec_aes_init(alg_type=15 alg_id=12 name=aes): ret=0
<4>ipsec_aes_init(alg_type=14 alg_id=9 name=aes_mac): ret=0
<4>ipsec_3des_init(alg_type=15 alg_id=3 name=3des): ret=0
<4>daemon_setup : Ignoring data socket specification
<6>Netdevice 0 (10:00:00:ab:cd:ff) : daemon backend (uml_switch version 3) - unix:/tmp/umlEV4Tk1.d/west/ctl
<4>daemon_setup : Ignoring data socket specification
<6>Netdevice 1 (10:00:00:64:64:45) : daemon backend (uml_switch version 3) - unix:/tmp/umlEV4Tk1.d/public/ctl
<4>daemon_setup : Ignoring data socket specification
<6>Netdevice 2 (10:00:00:32:64:45) : daemon backend (uml_switch version 3) - unix:/tmp/umlEV4Tk1.d/admin/ctl
<4>Checking host MADV_REMOVE support...OK
<4>mconsole (version 2) initialized on /home/antony/.uml/west/mconsole
<6>Host TLS support detected
<6>Detected host type: i386
<5>VFS: Disk quotas dquot_6.5.1
<4>Dquot-cache hash table entries: 1024 (order 0, 4096 bytes)
<6>Initializing Cryptographic API
<6>io scheduler noop registered
<6>io scheduler anticipatory registered (default)
<6>io scheduler deadline registered
<6>io scheduler cfq registered
<4>RAMDISK driver initialized: 16 RAM disks of 4096K size 1024 blocksize
<6>loop: loaded (max 8 devices)
<6>nbd: registered device at major 43
<6>PPP generic driver version 2.4.2
<6>SLIP: version 0.8.4-NET3.019-NEWTTY (dynamic channels, max=256).
<6>tun: Universal TUN/TAP device driver, 1.6
<6>tun: (C) 1999-2004 Max Krasnyansky <maxk@qualcomm.com>
<4>Netfilter messages via NETLINK v0.30.
<6>IPv4 over IPv4 tunneling driver
<6>GRE over IPv4 tunneling driver
<4>ip_conntrack version 2.4 (213 buckets, 1704 max) - 204 bytes per conntrack
<4>ip_tables: (C) 2000-2006 Netfilter Core Team
<4>arp_tables: (C) 2002 David S. Miller
<6>TCP bic registered
<6>TCP cubic registered
<6>TCP westwood registered
<6>TCP highspeed registered
<6>TCP hybla registered
<6>TCP htcp registered
<6>TCP vegas registered
<6>TCP scalable registered
<6>NET: Registered protocol family 1
<6>NET: Registered protocol family 17
<6>Initialized stdio console driver
<4>Console initialized on /dev/tty0
<6>Initializing software serial port version 1
<4>Failed to open 'root_fs', errno = 2
<5>RAMDISK: cramfs filesystem found at block 0
<5>RAMDISK: Loading 1212KiB [1 disk] into ram disk... |/-\|/-\|/-\|/-\|/-\|/-\|/-\|/-\|/-\|/-\|/-\|/-\|/-\|/-\|/-\|/-\|/-\|/-\|/-\done.
<4>VFS: Mounted root (cramfs filesystem) readonly.
<6>line_ioctl: tty0: ioctl KDSIGACCEPT called
<4>
<2>IPSEC EVENT: KLIPS device ipsec0 shut down.
<4>
Kernel logging (proc) stopped.
Kernel log daemon terminating.
west:~# halt -p -f
System halted.

